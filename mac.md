# macOS DFIR: –ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –¥–ª—è —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã

> **–ü—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å:** macOS 10.15 (Catalina) ‚Äî macOS 15 (Sequoia)  
> **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –¥–ª—è —Å–±–æ—Ä–∞ –∏ –∞–Ω–∞–ª–∏–∑–∞ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ —Å –∂–∏–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –∏–ª–∏ –æ–±—Ä–∞–∑–∞ –¥–∏—Å–∫–∞  
> **–í–µ—Ä—Å–∏—è:** 2.1 | –û–±–Ω–æ–≤–ª–µ–Ω–æ: 2026-02

---

## –£—Å–ª–æ–≤–Ω—ã–µ –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è

| –°–∏–º–≤–æ–ª | –ó–Ω–∞—á–µ–Ω–∏–µ |
|--------|----------|
| üî¥ | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ ‚Äî —Å–æ–±–∏—Ä–∞—Ç—å –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å |
| üü° | –í–∞–∂–Ω–æ ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π IR |
| üü¢ | –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ ‚Äî —É–≥–ª—É–±–ª—ë–Ω–Ω–æ–µ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ |
| ‚ö†Ô∏è | –¢—Ä–µ–±—É–µ—Ç root / Full Disk Access |
| ‚è±Ô∏è | –í–æ–ª–∞—Ç–∏–ª—å–Ω—ã–π ‚Äî –∏—Å—á–µ–∑–∞–µ—Ç –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ |
| üîê | –ú–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω (FileVault) |

---

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

| # | –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –ö–ª—é—á–µ–≤—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã |
|---|-----------|-------------------|
| [1](#1-persistence) | **Persistence** | LaunchDaemons/Agents, Login Items, cron, kext |
| [2](#2-process) | **Process** | –°–ø–∏—Å–æ–∫ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, —Ö—ç—à–∏, ES Framework |
| [3](#3-network) | **Network** | –°–æ–µ–¥–∏–Ω–µ–Ω–∏—è, ARP, DNS, –∫–æ–Ω—Ñ–∏–≥–∏ —Å–µ—Ç–∏ |
| [4](#4-file-system) | **File System** | FSEvents, Bodyfile, Quarantine, xattr |
| [5](#5-user-activity) | **User Activity** | Shell history, KnowledgeC, Biome, –±—Ä–∞—É–∑–µ—Ä—ã |
| [6](#6-system-logs) | **System Logs** | Unified Logs, Install Log, Crash Reports |
| [7](#7-authentication) | **Authentication** | TCC, Keychain, sudo, SSH, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ |
| [8](#8-applications) | **Applications** | –£—Å—Ç–∞–Ω–æ–≤–∫–∏, –ø–æ–¥–ø–∏—Å–∏, CUPS |
| [9](#9-cloud--sync) | **Cloud & Sync** | iCloud, Time Machine, Dropbox |
| [10](#10-security-state) | **Security State** | SIP, Gatekeeper, FileVault, XProtect |
| [11](#11-memory--volatile) | **Memory** | RAM-–¥–∞–º–ø, –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è, lsof |
| [12](#12-external-devices) | **External Devices** | USB, Bluetooth |
| [13](#13-email--communication) | **Communication** | Mail, iMessage, Slack |
| [A](#appendix-a-–ø–æ—Ä—è–¥–æ–∫-—Å–±–æ—Ä–∞) | **Appendix A** | Order of Volatility |
| [B](#appendix-b-–±—ã—Å—Ç—Ä—ã–π-ir-—Å–∫—Ä–∏–ø—Ç) | **Appendix B** | –ë—ã—Å—Ç—Ä—ã–π IR-—Å–∫—Ä–∏–ø—Ç |
| [C](#appendix-c-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã) | **Appendix C** | –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Å–±–æ—Ä–∞ –∏ –∞–Ω–∞–ª–∏–∑–∞ |
| [D](#appendix-d-—Å—Å—ã–ª–∫–∏) | **Appendix D** | –°—Å—ã–ª–∫–∏ |

---

## 1. Persistence

*–ú–µ—Ö–∞–Ω–∏–∑–º—ã –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ ‚Äî –ø–µ—Ä–≤—ã–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø—Ä–∏ –ª—é–±–æ–º IR.*

### 1.1 LaunchDaemons (—Å–∏—Å—Ç–µ–º–Ω—ã–µ) üî¥

**–ß—Ç–æ —ç—Ç–æ:** –§–æ–Ω–æ–≤—ã–µ —Å–ª—É–∂–±—ã macOS, –∑–∞–ø—É—Å–∫–∞–µ–º—ã–µ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–∏—Å—Ç–µ–º—ã —Å –ø—Ä–∞–≤–∞–º–∏ `root` –¥–æ –≤—Ö–æ–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –£–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ `launchd` (PID 1). –ö–∞–∂–¥—ã–π daemon –æ–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è plist-—Ñ–∞–π–ª–æ–º —Å –ø—É—Ç—ë–º –∫ –±–∏–Ω–∞—Ä—é, –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏ –∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º. –õ–µ–≥–∏—Ç–∏–º–Ω—ã–µ daemon'—ã Apple –ø–æ–¥–ø–∏—Å–∞–Ω—ã –∏ –∂–∏–≤—É—Ç –≤ `/System/Library/` ‚Äî –∏—Ö –º–æ–∂–Ω–æ —Å–º–æ—Ç—Ä–µ—Ç—å —Å –ø–æ–Ω–∏–∂–µ–Ω–Ω—ã–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º . –í—Å—ë –≤ `/Library/LaunchDaemons/` ‚Äî –∫–∞–Ω–¥–∏–¥–∞—Ç—ã –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É.

**–ü—É—Ç–∏:**
```
/Library/LaunchDaemons/*.plist              ‚Üê –ø—Ä–æ–≤–µ—Ä—è—Ç—å
/System/Library/LaunchDaemons/*.plist       ‚Üê –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ Apple-signed, —Ç–æ –æ—á–µ–Ω—å –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ
```

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö–∞–∫–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å –ø—Ä–∞–≤–∞–º–∏ root?
- –ï—Å—Ç—å –ª–∏ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ daemon'—ã?
- –ö–æ–≥–¥–∞ —Å–æ–∑–¥–∞–Ω/–∏–∑–º–µ–Ω—ë–Ω plist?
- –ö–∞–∫–æ–π –±–∏–Ω–∞—Ä—å –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∏ —Å –∫–∞–∫–∏–º–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –¥–µ–º–æ–Ω–æ–≤
sudo launchctl list | sort

# –ß—Ç–µ–Ω–∏–µ plist (–±–∏–Ω–∞—Ä–Ω—ã–π ‚Üí XML)
plutil -p /Library/LaunchDaemons/com.example.daemon.plist

# –ü–æ–∏—Å–∫ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö (–Ω–µ Apple)
ls /Library/LaunchDaemons/ | grep -v "^com.apple"

# –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –±–∏–Ω–∞—Ä–∏ –≤ plist (–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä—ã, —Å–µ—Ç–µ–≤—ã–µ —É—Ç–∏–ª–∏—Ç—ã)
grep -r "curl\|bash\|python\|ruby\|perl\|wget\|nc " /Library/LaunchDaemons/

# –ò–∑–≤–ª–µ—á—å –ø—É—Ç—å –∫ –±–∏–Ω–∞—Ä—é –∏–∑ –∫–∞–∂–¥–æ–≥–æ plist
for f in /Library/LaunchDaemons/*.plist; do
  echo "=== $f ==="
  plutil -extract ProgramArguments xml1 -o - "$f" 2>/dev/null
done
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** UAC ¬∑ Aftermath ¬∑ mac_apt

---

### 1.2 LaunchAgents (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ) üî¥

**–ß—Ç–æ —ç—Ç–æ:** –ê–≥–µ–Ω—Ç—ã, –∑–∞–ø—É—Å–∫–∞–µ–º—ã–µ –ø—Ä–∏ –≤—Ö–æ–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å–∏—Å—Ç–µ–º—É. –†–∞–±–æ—Ç–∞—é—Ç –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–Ω–µ root). **–°–∞–º—ã–π –ø–æ–ø—É–ª—è—Ä–Ω—ã–π –≤–µ–∫—Ç–æ—Ä persistence —É macOS-–º–∞–ª–≤–∞—Ä–∏** ‚Äî plist –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–æ–ª–æ–∂–∏—Ç—å –≤ `~/Library/LaunchAgents/` –±–µ–∑ root-–ø—Ä–∞–≤.

**–ü—É—Ç–∏:**
```
~/Library/LaunchAgents/*.plist              ‚Üê —Ç–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
/Library/LaunchAgents/*.plist               ‚Üê –≤—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
/System/Library/LaunchAgents/*.plist        ‚Üê Apple-signed
```

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö–∞–∫–∏–µ –∞–≥–µ–Ω—Ç—ã –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞ –µ—Å—Ç—å —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π?
- –ö–∞–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã –∑–∞–ø—É—Å–∫–∞–µ—Ç –∞–≥–µ–Ω—Ç (curl/bash/python = –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ)?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# –í—Å–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –∞–≥–µ–Ω—Ç—ã —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
launchctl list

# –ê–≥–µ–Ω—Ç—ã —Å —Å–µ—Ç–µ–≤—ã–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ –∏–ª–∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä–∞–º–∏
grep -grep -Eir "wget|curl|qemu|http|tcp|tor|tunnel|reverse|socks|proxy|cred|ssh|php|perl|python|\.py|\.sh|\.sql|tmp|temp|shm|splo|xplo|cve|gcc|chmod|passwd|shadow|useradd|authorized_keys|hosts|[[:digit:]]{1,3}\.[[:digit:]]{1,3}\.[[:digit:]]{1,3}\.[[:digit:]]{1,3}|github|pastebin|cdn|(:| )(443|80|22|445|3389)|nmap|scan|dump|flood|ddos|ncat|netcat|gsock|gs.sock|gssock|g.sock|a\.out|HISTFILE|preload|sh_history|whoami|^w$|\.io " \
  /Library/LaunchAgents/ ~/Library/LaunchAgents/ # –°–ø–∞—Å–∏–±–æ msuhanov –∑–∞ —Ä–µ–≥—É–ª—è—Ä–∫—É

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ –±–∏–Ω–∞—Ä—è
codesign -dvvv /path/to/binary
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** UAC ¬∑ Aftermath ¬∑ mac_apt

---

### 1.3 Login Items üü°

**–ß—Ç–æ —ç—Ç–æ:** –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ —Å–∫—Ä–∏–ø—Ç—ã, –∑–∞–ø—É—Å–∫–∞–µ–º—ã–µ –ø—Ä–∏ –≤—Ö–æ–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ System Settings ‚Üí General ‚Üí Login Items. –í macOS 13+ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `SMAppService` –∏ —Ñ–∞–π–ª—ã `.btm`.

**–ü—É—Ç–∏:**
```
# macOS 13+ (Ventura –∏ –Ω–æ–≤–µ–µ)
~/Library/Application Support/com.apple.backgroundtaskmanagementagent/backgrounditems.btm

/Library/Application Support/com.apple.backgroundtaskmanagementagent/backgrounditems.btm

# Legacy (macOS < 13)
~/Library/Preferences/com.apple.loginitems.plist
```

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
sfltool dumpbtm                                               # macOS 13+

python3 btm.py -f backgrounditems.btm                        # btm-parser (mac4n6)

plutil -p ~/Library/Preferences/com.apple.loginitems.plist   # legacy
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** Aftermath, [btm-parser](https://github.com/mac4n6/btm)

---

### 1.4 Cron Jobs üü°

**–ß—Ç–æ —ç—Ç–æ:** –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π Unix-–ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫. –í macOS –º–µ–Ω–µ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω, —á–µ–º LaunchAgents, –Ω–æ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –µ–≥–æ –∏–º–µ–Ω–Ω–æ –ø–æ—Ç–æ–º—É, —á—Ç–æ –æ–Ω —á–∞—Å—Ç–æ –æ—Å—Ç–∞—ë—Ç—Å—è –±–µ–∑ –≤–Ω–∏–º–∞–Ω–∏—è. –•—Ä–∞–Ω–∏—Ç—Å—è –≤ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–∞—Ö.

**–ü—É—Ç–∏:**
```
/private/var/at/tabs/<username>     ‚Üê –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ crontab'—ã
/etc/crontab                        ‚Üê —Å–∏—Å—Ç–µ–º–Ω—ã–π
/etc/periodic/daily|weekly|monthly/ ‚Üê –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏
```

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
crontab -l                                    # —Ç–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
sudo ls /private/var/at/tabs/                 # –≤—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (root)
sudo cat /private/var/at/tabs/<username>
ls -la /etc/periodic/daily/ /etc/periodic/weekly/ /etc/periodic/monthly/
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** UAC, aftermath

---

### 1.5 System / Kernel Extensions üî¥

**–ß—Ç–æ —ç—Ç–æ:** –ú–æ–¥—É–ª–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —è–¥—Ä–∞. Kernel Extensions (`.kext`) ‚Äî —É—Å—Ç–∞—Ä–µ–≤—à–∏–π —Ñ–æ—Ä–º–∞—Ç, —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ —è–¥—Ä–∞ —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º–∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—è–º–∏. System Extensions (macOS 10.15+) ‚Äî —Ä–∞–±–æ—Ç–∞—é—Ç –≤ user space. –ù–µ–ª–µ–≥–∏—Ç–∏–º–Ω—ã–µ kext ‚Äî –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–µ –º–µ—Å—Ç–æ —Ä—É—Ç–∫–∏—Ç–æ–≤. –î–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ unsigned kext –Ω—É–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å SIP, —á—Ç–æ —Å–∞–º–æ –ø–æ —Å–µ–±–µ —è–≤–ª—è–µ—Ç—Å—è —Å–∏–≥–Ω–∞–ª–æ–º.

**–ü—É—Ç–∏:**
```
/Library/SystemExtensions/          ‚Üê macOS 10.15+ System Extensions
/Library/Extensions/*.kext          ‚Üê legacy Kernel Extensions
/System/Library/Extensions/*.kext   ‚Üê –ü–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–µ Apple kexts
```

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
kextstat | grep -v com.apple              # —Ç–æ–ª—å–∫–æ —Å—Ç–æ—Ä–æ–Ω–Ω–∏–µ kext
systemextensionsctl list                  # System Extensions (10.15+)
codesign -dvvv /Library/Extensions/Suspicious.kext
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** Aftermath (systemRecon) ¬∑ UAC

---

### 1.6 Login/Logout Hooks üü¢

**–ß—Ç–æ —ç—Ç–æ:** –£—Å—Ç–∞—Ä–µ–≤—à–∏–π –º–µ—Ö–∞–Ω–∏–∑–º ‚Äî shell-—Å–∫—Ä–∏–ø—Ç, –≤—ã–ø–æ–ª–Ω—è–µ–º—ã–π –ø—Ä–∏ –≤—Ö–æ–¥–µ/–≤—ã—Ö–æ–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**–ü—É—Ç—å:** `/private/var/root/Library/Preferences/com.apple.loginwindow.plist`

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
sudo defaults read /private/var/root/Library/Preferences/com.apple.loginwindow.plist
# –ò—Å–∫–∞—Ç—å –∫–ª—é—á–∏: LoginHook, LogoutHook
```

---

### 1.7 Emond (Event Monitor Daemon) üü¢

**–ß—Ç–æ —ç—Ç–æ:** –î–µ–º–æ–Ω —Ä–µ–∞–∫—Ü–∏–∏ –Ω–∞ —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è (—Å—Ç–∞—Ä—Ç, –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–º–∞). –ü—Ä–∞–≤–∏–ª–∞ –≤ plist –∑–∞–ø—É—Å–∫–∞—é—Ç –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã. –í macOS Ventura+ —É—Å—Ç–∞—Ä–µ–ª, –Ω–æ —Ñ–∞–π–ª—ã –ø—Ä–∞–≤–∏–ª –º–æ–≥—É—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è.

**–ü—É—Ç—å:** `/etc/emond.d/rules/*.plist`

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
ls /etc/emond.d/rules/
plutil -p /etc/emond.d/rules/<rule>.plist
```

---

### 1.8 At Jobs üü¢

**–ß—Ç–æ —ç—Ç–æ:** –∞–Ω–∞–ª–æ–≥ `at` –≤ Linux. –†–µ–¥–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ ‚Äî –ª—é–±–∞—è –∑–∞–¥–∞—á–∞ –≤ `/private/var/at/jobs/` —è–≤–ª—è–µ—Ç—Å—è –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–º IoC.

**–ü—É—Ç—å:** `/private/var/at/jobs/`

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
atq
sudo ls /private/var/at/jobs/
```

---

## 2. Process

*–ñ–∏–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –æ –ø—Ä–æ—Ü–µ—Å—Å–∞—Ö –∏ –≤—Å—è –º–µ—Ç–∞–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, –æ—á–µ–Ω—å –≤–æ–ª–∞—Ç–∏–ª—å–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö, —Å–æ–±–∏—Ä–∞—Ç—å –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å.*

### 2.1 –°–ø–∏—Å–æ–∫ –∂–∏–≤—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ ‚è±Ô∏è üî¥

**–ß—Ç–æ —ç—Ç–æ:** –°–Ω–∞–ø—à–æ—Ç –≤—Å–µ—Ö –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤: –∏–º—è, PID, PPID, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –∫–æ–º–∞–Ω–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞, –ø—É—Ç—å –∫ –±–∏–Ω–∞—Ä—é. **–ü–µ—Ä–≤–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –ø—Ä–∏ IR –Ω–∞ –∂–∏–≤–æ–π —Å–∏—Å—Ç–µ–º–µ.**

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ï—Å—Ç—å –ª–∏ –∞–Ω–æ–º–∞–ª—å–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –∏–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å—ã –∏–∑ `/tmp`, `/var/tmp`?
- –ö–∞–∫–æ–µ –¥–µ—Ä–µ–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (parent ‚Üí child)?
- –ï—Å—Ç—å –ª–∏ –ø—Ä–æ—Ü–µ—Å—Å—ã, —Å–ª—É—à–∞—é—â–∏–µ –ø–æ—Ä—Ç—ã –∏–ª–∏ –∏–º–µ—é—â–∏–µ –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Ç–µ–≤—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å?
- –ó–∞–ø—É—â–µ–Ω—ã –ª–∏ –ø—Ä–æ—Ü–µ—Å—Å—ã —Å –ø—Ä–∞–≤–∞–º–∏ root –±–µ–∑ –≤–∏–¥–∏–º–æ–π –ø—Ä–∏—á–∏–Ω—ã?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
ps aux                                                  # –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫
ps auxf                                                 # –¥–µ—Ä–µ–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
sudo lsof -i -n -P                                      # –ø—Ä–æ—Ü–µ—Å—Å—ã —Å —Å–µ—Ç–µ–≤—ã–º–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è–º–∏

# –ü—Ä–æ—Ü–µ—Å—Å—ã –∏–∑ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
ps aux | grep -E "/tmp/|/var/tmp/|/Users/.*/Library/|/private/tmp"
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** UAC ¬∑ Aftermath

---

### 2.2 –•—ç—à–∏ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤ üî¥

**–ß—Ç–æ —ç—Ç–æ:** SHA256-—Ö—ç—à–∏ –±–∏–Ω–∞—Ä–µ–π –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Å Threat Intelligence –∏ VirusTotal. –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ö—ç—à–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –±–∏–Ω–∞—Ä—è (–Ω–∞–ø—Ä–∏–º–µ—Ä `/bin/ls`) = trojanized binary.

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ï—Å—Ç—å –ª–∏ –∏–∑–≤–µ—Å—Ç–Ω—ã–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ —Ö—ç—à–∏ –≤ —Å–∏—Å—Ç–µ–º–µ?
- –ò–∑–º–µ–Ω–µ–Ω—ã –ª–∏ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –±–∏–Ω–∞—Ä–∏ (trojanized binaries)?
- –ï—Å—Ç—å –ª–∏ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã –≤ –Ω–µ—Ç–∏–ø–∏—á–Ω—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è—Ö (–∫–ª–∞—Å—Å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è linux –≤–æ—Ç [—Ç—É—Ç](https://github.com/msuhanov/easy_triage/blob/4c9ed2daead7a40504e0b33c01e1450fbc0e9c55/easy_triage.sh#L795))?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# SHA256 —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –±–∏–Ω–∞—Ä–µ–π
find /usr/bin /usr/sbin -type f -exec shasum -a 256 {} \; > hashes_system.txt

# –ò—Å–ø–æ–ª–Ω—è–µ–º—ã–µ –≤ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö
find /tmp /var/tmp ~/Library -type f -perm +111 \
  -exec shasum -a 256 {} \; 2>/dev/null > hashes_suspicious.txt

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏
codesign -dvvv /path/to/suspicious/binary
spctl -a -vvv /path/to/suspicious/binary

# –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–µ–π –∏ –¥—Ä—É–≥–∏—Ö –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
# –ü–æ–¥–ø–∏—Å—å
find /Users /tmp /private/var/tmp /Library -type f -perm +111 2>/dev/null \
  | while read f; do
      ft=$(file -b "$f")
      if echo "$ft" | grep -qi "mach-o"; then
        result=$(codesign -v "$f" 2>&1)
        if echo "$result" | grep -qi "not signed\|invalid\|no signature"; then
          echo "UNSIGNED: $f"
        fi
      fi
    done

# –ù–µ—Ç –∫–∞—Ä–∞–Ω—Ç–∏–Ω–∞, –Ω–æ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–ª–∞–≥ –≤—ã—Å—Ç–∞–≤–ª–µ–Ω (–æ–±—Ö–æ–¥ gatekeeper)
find /Users/*/Downloads /Users/*/Desktop /tmp -type f -perm +111 2>/dev/null \
  | while read f; do
      ft=$(file -b "$f")
      if echo "$ft" | grep -qi "mach-o\|script"; then
        q=$(xattr -l "$f" 2>/dev/null | grep "quarantine")
        if [ -z "$q" ]; then
          echo "NO QUARANTINE + EXECUTABLE: $f | $ft"
        fi
      fi
    done
# –°–∫—Ä—ã—Ç—ã–µ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã
find /Users /Library /tmp -name ".*" -type f -perm +111 2>/dev/null \
  | while read f; do
      ft=$(file -b "$f")
      echo "$ft | $f"
    done \
  | grep -i "mach-o\|script\|executable"
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** UAC ¬∑ Aftermath

---

### 2.3 Endpoint Security Events –∏–ª–∏ –ó–æ–ª–æ—Ç–æ–π –ì—Ä–∞–∞–ª—å –¥—Ñ–∏—Ä—â–∏–∫–∞ ‚è±Ô∏è üî¥ ‚ö†Ô∏è 

**–ß—Ç–æ —ç—Ç–æ:** Apple Endpoint Security Framework (macOS 10.15+) ‚Äî –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π API —è–¥—Ä–∞. `eslogger` –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏: —Å–æ–∑–¥–∞–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤, –∑–∞–ø—É—Å–∫ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (`exec`), –º–∞–ø–ø–∏–Ω–≥ –ø–∞–º—è—Ç–∏ (`mmap`), –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–∞–≤. **–î–∞–Ω–Ω—ã–µ —Ç–æ–ª—å–∫–æ live ‚Äî –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Ç–µ—Ä—è—é—Ç—Å—è.**

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ß—Ç–æ —Å–æ–∑–¥–∞—ë—Ç/–∏–∑–º–µ–Ω—è–µ—Ç –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å?
- –ö–∞–∫–∏–µ –Ω–æ–≤—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è (—Ü–µ–ø–æ—á–∫–∞ –∞—Ç–∞–∫–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏)?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (—Ç—Ä–µ–±—É–µ—Ç Full Disk Access –¥–ª—è Terminal)
sudo eslogger create exec mmap | tee eslog.json

# –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –ø—Ä–æ—Ü–µ—Å—Å—É
sudo eslogger create exec | jq 'select(.process.executable.path | contains("suspicious"))'
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** Aftermath

---

## 3. Network

*–°–µ—Ç–µ–≤—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã ‚Äî —Å–æ–±–∏—Ä–∞—Ç—å —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.*

### 3.1 –ê–∫—Ç–∏–≤–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è ‚è±Ô∏è üî¥

**–ß—Ç–æ —ç—Ç–æ:** –¢–∞–±–ª–∏—Ü–∞ –≤—Å–µ—Ö —Ç–µ–∫—É—â–∏—Ö TCP/UDP —Å–æ–∫–µ—Ç–æ–≤, –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã—Ö –∫ –ø—Ä–æ—Ü–µ—Å—Å–∞–º. –§—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π –∞—Ä—Ç–µ—Ñ–∞–∫—Ç –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è C2-–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏, reverse shell, —ç–∫—Å—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö.

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö–∞–∫–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –∏–º–µ—é—Ç –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ IP?
- –ï—Å—Ç—å –ª–∏ C2 (–Ω–µ—Ç–∏–ø–∏—á–Ω—ã–µ –ø–æ—Ä—Ç—ã, –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ IP/–¥–æ–º–µ–Ω—ã)?
- –ï—Å—Ç—å –ª–∏ –Ω–æ–≤—ã–µ listening ports (–ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π backdoor)?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
sudo lsof -i -n -P                          # –≤—Å–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –∏–º–µ–Ω–∞–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
netstat -an | grep ESTABLISHED              # —Ç–æ–ª—å–∫–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ TCP
sudo lsof -iTCP -sTCP:LISTEN -n -P          # listening ports (backdoors)
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** UAC ¬∑ Aftermath

---

### 3.2 ARP-–∫—ç—à ‚è±Ô∏è üü°

**–ß—Ç–æ —ç—Ç–æ:** –¢–∞–±–ª–∏—Ü–∞ IP ‚Üí MAC –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏. –ê–Ω–æ–º–∞–ª—å–Ω—ã–µ –∑–∞–ø–∏—Å–∏ —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ ARP-—Å–ø—É—Ñ–∏–Ω–≥. –¢–∞–∫–∂–µ –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–æ—Å–µ–¥–µ–π –ø–æ —Å–µ—Ç–∏.

```bash
arp -a -n
```

---

### 3.3 –¢–∞–±–ª–∏—Ü–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ ‚è±Ô∏è üü°

**–ß—Ç–æ —ç—Ç–æ:** –ü—Ä–∞–≤–∏–ª–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ —Ç—Ä–∞—Ñ–∏–∫–∞.

```bash
netstat -rn
route -n get default
```

---

### 3.4 DNS-–∫—ç—à ‚è±Ô∏è üî¥

**–ß—Ç–æ —ç—Ç–æ:** –ö—ç—à –Ω–µ–¥–∞–≤–Ω–æ —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã—Ö –¥–æ–º–µ–Ω–Ω—ã—Ö –∏–º—ë–Ω. –ü–æ–∑–≤–æ–ª—è–µ—Ç —É–≤–∏–¥–µ—Ç—å, –∫ –∫–∞–∫–∏–º –¥–æ–º–µ–Ω–∞–º –æ–±—Ä–∞—â–∞–ª–∞—Å—å —Å–∏—Å—Ç–µ–º–∞: C2-–¥–æ–º–µ–Ω—ã, DGA (Domain Generation Algorithm). –û—á–∏—â–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ.

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ï—Å—Ç—å –ª–∏ DNS-–∑–∞–ø—Ä–æ—Å—ã –∫ –∏–∑–≤–µ—Å—Ç–Ω—ã–º C2 –∏–ª–∏ DGA-–¥–æ–º–µ–Ω–∞–º?
- –ö—É–¥–∞ –≤ –ø—Ä–∏–Ω—Ü–∏–ø–µ –±—ã–ª–∏ –æ–±—Ä–∞—â–µ–Ω–∏—è?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# macOS Monterey+
sudo dscacheutil -cachedump -entries Host

# –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ Unified Logs
log show --predicate 'subsystem == "com.apple.mDNSResponder"' --last 24h | \
  grep -i "query\|resolve"
```

---

### 3.5 –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ç–∏ –∏ hosts üü°

**–ß—Ç–æ —ç—Ç–æ:** `/etc/hosts` –∏–º–µ–µ—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –Ω–∞–¥ DNS-—Å–µ—Ä–≤–µ—Ä–æ–º. –ú–∞–ª–≤–∞—Ä—å –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –µ–≥–æ –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π AV –∏–ª–∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞. –ò–∑–º–µ–Ω–µ–Ω–∏–µ DNS-—Å–µ—Ä–≤–µ—Ä–æ–≤ = –ø–µ—Ä–µ—Ö–≤–∞—Ç DNS-—Ç—Ä–∞—Ñ–∏–∫–∞.

**–ü—É—Ç–∏:**
```
/private/etc/hosts
/private/etc/resolv.conf
/Library/Preferences/SystemConfiguration/NetworkInterfaces.plist
/Library/Preferences/SystemConfiguration/preferences.plist
```

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
cat /etc/hosts
networksetup -getdnsservers Wi-Fi
scutil --dns
ifconfig -a
```

---

### 3.6 Wi-Fi –∏—Å—Ç–æ—Ä–∏—è üü°

**–ß—Ç–æ —ç—Ç–æ:** –°–ø–∏—Å–æ–∫ —Å–µ—Ç–µ–π Wi-Fi, –∫ –∫–æ—Ç–æ—Ä—ã–º –ø–æ–¥–∫–ª—é—á–∞–ª–∞—Å—å —Å–∏—Å—Ç–µ–º–∞, —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏. –ü–æ–∑–≤–æ–ª—è–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∏ –æ—Ç—Å–ª–µ–¥–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–º —Å–µ—Ç—è–º –≤ –Ω–µ—Ä–∞–±–æ—á–µ–µ –≤—Ä–µ–º—è.

**–ü—É—Ç—å:** `/Library/Preferences/SystemConfiguration/com.apple.airport.preferences.plist`

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
plutil -p /Library/Preferences/SystemConfiguration/com.apple.airport.preferences.plist

log show --predicate 'subsystem == "com.apple.WiFiPolicy"' --last 7d    # macOS 12+
```

---

### 3.7 Firewall –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è üü°

**–ü—É—Ç—å:** `/Library/Preferences/com.apple.alf.plist`

```bash
/usr/libexec/ApplicationFirewall/socketfilterfw --getglobalstate
/usr/libexec/ApplicationFirewall/socketfilterfw --listapps
```

---

### 3.8 –ó–∞—Ö–≤–∞—Ç —Ç—Ä–∞—Ñ–∏–∫–∞ (PCAP) ‚è±Ô∏è üü° ‚ö†Ô∏è

**–ß—Ç–æ —ç—Ç–æ:** –î–∞–º–ø —Ç—Ä–∞—Ñ–∏–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏. –ü—Ä–∏–∫–æ–ª—å–Ω–æ, —á—Ç–æ –≤ macos —ç—Ç–æ –µ—Å—Ç—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.

```bash
sudo tcpdump -i en0 -w /Volumes/USB/capture_$(date +%Y%m%dT%H%M%S).pcap

# –¢–æ–ª—å–∫–æ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø–æ—Ä—Ç—ã
sudo tcpdump -i en0 -w capture.pcap 'not port 80 and not port 443'
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** Aftermath

---

## 4. File System

*–§–∞–π–ª–æ–≤—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã ‚Äî –∏—Å—Ç–æ—Ä–∏—è –≤—Å–µ–≥–æ, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–æ –Ω–∞ –¥–∏—Å–∫–µ.*

### 4.1 FSEvents Store Database üî¥ ‚ö†Ô∏è

**–ß—Ç–æ —ç—Ç–æ:** –í—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π –∂—É—Ä–Ω–∞–ª —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã, –≤–µ–¥—ë—Ç—Å—è –¥–µ–º–æ–Ω–æ–º `fseventsd`. –§–∏–∫—Å–∏—Ä—É–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ, –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ, –∏–∑–º–µ–Ω–µ–Ω–∏–µ, –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ (–∞–Ω–∞–ª–æ–≥ $J –Ω–∞ Windows). **–ö–ª—é—á–µ–≤–∞—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å: –∑–∞–ø–∏—Å–∏ –æ —Ñ–∞–π–ª–∞—Ö —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –¥–∞–∂–µ –ø–æ—Å–ª–µ –∏—Ö —É–¥–∞–ª–µ–Ω–∏—è** ‚Äî –º–æ–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ–∞–∫—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –∏ –ø—É—Ç—å —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞. –ë–∏–Ω–∞—Ä–Ω—ã–π gzip-—Ñ–æ—Ä–º–∞—Ç, —Ç—Ä–µ–±—É–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ –ø–∞—Ä—Å–µ—Ä–∞.

**–ü—É—Ç–∏:**
```
/.fseventsd/                          ‚Üê –∫–æ—Ä–Ω–µ–≤–æ–π —Ç–æ–º
/Volumes/<name>/.fseventsd/           ‚Üê –≤–Ω–µ—à–Ω–∏–µ —Ç–æ–º–∞ (USB –∏ –¥—Ä.)
/System/Volumes/Data/.fseventsd/      ‚Üê Data-—Ç–æ–º (APFS, macOS 10.15+)
```

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö–æ–≥–¥–∞ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π —Ñ–∞–π–ª –≤–ø–µ—Ä–≤—ã–µ –ø–æ—è–≤–∏–ª—Å—è –≤ —Å–∏—Å—Ç–µ–º–µ?
- –û—Ç–∫—É–¥–∞ –æ–Ω –±—ã–ª –ø–µ—Ä–µ–º–µ—â—ë–Ω?
- –ö–∞–∫–∏–µ —Ñ–∞–π–ª—ã —É–¥–∞–ª–∏–ª –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –¥–ª—è —Å–æ–∫—Ä—ã—Ç–∏—è —Å–ª–µ–¥–æ–≤?
- –ö–æ–≥–¥–∞ –ø–æ–¥–∫–ª—é—á–∞–ª–∏—Å—å/–æ—Ç–∫–ª—é—á–∞–ª–∏—Å—å –≤–Ω–µ—à–Ω–∏–µ —Ç–æ–º–∞?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# FSEventsParser (Python)
python3 FSEventsParser.py -s /.fseventsd/ -o /output/fsevents/

# Plaso
log2timeline.py --parsers fsevents --storage-file timeline.plaso /
```

> ‚ö†Ô∏è –§–∞–π–ª—ã –±–∏–Ω–∞—Ä–Ω—ã–µ, –±–µ–∑ –ø–∞—Ä—Å–µ—Ä–∞ –Ω–µ—á–∏—Ç–∞–µ–º—ã. –¢—Ä–µ–±—É–µ—Ç root.

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** UAC ¬∑ mac_apt (FSEVENTS) ¬∑ Plaso

---

### 4.2 Bodyfile (MACB Timestamps) üî¥

**–ß—Ç–æ —ç—Ç–æ:** –î–∞–º–ø –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ —Å —á–µ—Ç—ã—Ä—å–º—è –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏: **M**odified, **A**ccessed, **C**hanged (inode), **B**orn (—Å–æ–∑–¥–∞–Ω–∏–µ). –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ timeline —Ñ–∞–π–ª–æ–≤—ã—Ö —Å–æ–±—ã—Ç–∏–π. –í APFS –º–µ—Ç–∫–∞ Born –æ–±—ã—á–Ω–æ –Ω–∞–∏–±–æ–ª–µ–µ —Ç–æ—á–Ω–∞.

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö–æ–≥–¥–∞ —Å–æ–∑–¥–∞–Ω/–∏–∑–º–µ–Ω—ë–Ω/–æ—Ç–∫—Ä—ã—Ç –ª—é–±–æ–π —Ñ–∞–π–ª —Å–∏—Å—Ç–µ–º—ã?
- –ï—Å—Ç—å –ª–∏ timestomping (–ø–æ–¥–¥–µ–ª–∫–∞ –º–µ—Ç–æ–∫ ‚Äî –ø—Ä–∏–∑–Ω–∞–∫ —Å–æ–∫—Ä—ã—Ç–∏—è —Å–ª–µ–¥–æ–≤)?
- –ö–∞–∫–æ–≤–∞ —Ö—Ä–æ–Ω–æ–ª–æ–≥–∏—è —Ñ–∞–π–ª–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# –°–æ–∑–¥–∞–Ω–∏–µ bodyfile (The Sleuth Kit)
sudo fls -r -m "/" /dev/disk0s1 > bodyfile.txt

# Timeline –∏–∑ bodyfile
mactime -b bodyfile.txt -d > timeline.csv

# –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –¥–∞—Ç–µ
mactime -b bodyfile.txt -d -z UTC 2024-01-01 2024-12-31 > timeline_2024.csv
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** UAC ¬∑ Plaso (`--parsers filestat`)

---

### 4.3 Quarantine Events Database üî¥

**–ß—Ç–æ —ç—Ç–æ:** SQLite-–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∫–∞—Ä–∞–Ω—Ç–∏–Ω–∞ —Ñ–∞–π–ª–æ–≤, –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –∏–ª–∏ —á–µ—Ä–µ–∑ AirDrop. –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ-–∏—Å—Ç–æ—á–Ω–∏–∫, URL –∑–∞–≥—Ä—É–∑–∫–∏, URL —Å—Ç—Ä–∞–Ω–∏—Ü—ã (referrer) –∏ –≤—Ä–µ–º—è. **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ: –∑–∞–ø–∏—Å–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –¥–∞–∂–µ –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è —Ñ–∞–π–ª–∞.** –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ —Å–∫–∞—á–∞–ª –∏ —É–¥–∞–ª–∏–ª `malware.dmg` ‚Äî –∑–∞–ø–∏—Å—å –≤ QuarantineEventsV2 –æ—Å—Ç–∞–Ω–µ—Ç—Å—è.

**–ü—É—Ç—å:**
```
~/Library/Preferences/com.apple.LaunchServices.QuarantineEventsV2
```

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö–∞–∫–∏–µ —Ñ–∞–π–ª—ã —Å–∫–∞—á–∏–≤–∞–ª–∏—Å—å –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –∏–ª–∏ —á–µ—Ä–µ–∑ AirDrop?
- –ò–∑ –∫–∞–∫–æ–≥–æ –±—Ä–∞—É–∑–µ—Ä–∞/–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å–∫–∞—á–∞–Ω —Ñ–∞–π–ª?
- –ö–∞–∫–æ–π –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π URL –∑–∞–≥—Ä—É–∑–∫–∏ (–ø—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ C2 –∏–ª–∏ —Ñ–∏—à–∏–Ω–≥)?
- –ö–æ–≥–¥–∞ —Å–∫–∞—á–∞–Ω —Ñ–∞–π–ª (–¥–∞–∂–µ –µ—Å–ª–∏ –æ–Ω —É–∂–µ —É–¥–∞–ª—ë–Ω)?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
sqlite3 ~/Library/Preferences/com.apple.LaunchServices.QuarantineEventsV2 \
  "SELECT datetime(LSQuarantineTimeStamp + 978307200, 'unixepoch') as time,
   LSQuarantineAgentName as app,
   LSQuarantineOriginURLString as source_url,
   LSQuarantineDataURLString as file_url
   FROM LSQuarantineEvent ORDER BY LSQuarantineTimeStamp DESC;"
```

> **–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è Apple Epoch:** `timestamp + 978307200 = Unix timestamp` (—Å–µ–∫—É–Ω–¥—ã –æ—Ç—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è —Å 01.01.2001)

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** Aftermath ¬∑ UAC ¬∑ mac_apt

---

### 4.4 Spotlight Metadata üü° ‚ö†Ô∏è

**–ß—Ç–æ —ç—Ç–æ:** –ò–Ω–¥–µ–∫—Å–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–∏—Å–∫–æ–≤–æ–≥–æ –¥–≤–∏–∂–∫–∞ Spotlight. –•—Ä–∞–Ω–∏—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤, –≤–∫–ª—é—á–∞—è —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã –∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤. –ú–æ–∂–µ—Ç —Ä–∞—Å–∫—Ä—ã—Ç—å —Ñ–∞–∫—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤, —É–¥–∞–ª—ë–Ω–Ω—ã—Ö –¥–æ —Å–ª–µ–¥—É—é—â–µ–π –ø–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏.

**–ü—É—Ç–∏:**
```
/.Spotlight-V100/Store-V2/<UUID>/
/Volumes/<name>/.Spotlight-V100/
```

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
mdls /path/to/file                                          # –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª–∞
mdfind "kMDItemKind == 'Shell Script'"                      # –ø–æ–∏—Å–∫ –ø–æ —Ç–∏–ø—É
mdfind -onlyin /Users "kMDItemDisplayName == '*.py'"
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** mac_apt (SPOTLIGHT)

---

### 4.5 `.DS_Store` —Ñ–∞–π–ª—ã üü¢

**–ß—Ç–æ —ç—Ç–æ:** –°–∫—Ä—ã—Ç—ã–µ —Ñ–∞–π–ª—ã Finder –≤ –∫–∞–∂–¥–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, –∫–æ—Ç–æ—Ä—É—é –æ—Ç–∫—Ä—ã–≤–∞–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å. –•—Ä–∞–Ω—è—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–∏ –ø–∞–ø–∫–∏ –∏ —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤. –ü–æ–∑–≤–æ–ª—è—é—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å, –≤ –∫–∞–∫–∏—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è—Ö —Ä–∞–±–æ—Ç–∞–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —á–µ—Ä–µ–∑ GUI, –¥–∞–∂–µ –µ—Å–ª–∏ —Ñ–∞–π–ª—ã —É–∂–µ —É–¥–∞–ª–µ–Ω—ã.

```bash
# –ü–æ–∏—Å–∫ –≤—Å–µ—Ö DS_Store
find / -name ".DS_Store" 2>/dev/null | head -50

# –ü–∞—Ä—Å–∏–Ω–≥ (DS_Store Parser)
python3 ds_store_parser.py ~/.DS_Store
```

---

### 4.6 Temp-–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ üî¥

**–ß—Ç–æ —ç—Ç–æ:** –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–µ –º–µ—Å—Ç–æ –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–≥–æ –¥—Ä–æ–ø–∞ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û. –ú–∞–ª–≤–∞—Ä—å —á–∞—Å—Ç–æ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Å–µ–±—è –≤ `/tmp`, –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∏ –∑–∞—Ç–µ–º —É–¥–∞–ª—è–µ—Ç —Ñ–∞–π–ª (–Ω–æ –≤ FSEvents —Å–ª–µ–¥ –æ—Å—Ç–∞—ë—Ç—Å—è). –°–æ–¥–µ—Ä–∂–∏–º–æ–µ `/tmp` –æ—á–∏—â–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ.

**–ü—É—Ç–∏:**
```
/tmp/        ‚Üí /private/tmp/
/var/tmp/    ‚Üí /private/var/tmp/
/var/folders/                       ‚Üê TMPDIR –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
```

```bash
ls -lat /tmp/ /var/tmp/
find /tmp /var/tmp -mtime -1 -ls    # —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞
find /tmp /var/tmp -type f -exec shasum -a 256 {} \;
```

---

### 4.7 Extended Attributes (xattr) üü°

**–ß—Ç–æ —ç—Ç–æ:** –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã —Ñ–∞–π–ª–æ–≤. –ö–ª—é—á–µ–≤–æ–π –¥–ª—è IR: `com.apple.quarantine` —É–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ —Ñ–∞–π–ª –ø–æ–ª—É—á–µ–Ω –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞. –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∏ –º–æ–≥—É—Ç –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ —É–¥–∞–ª—è—Ç—å —ç—Ç–æ—Ç –∞—Ç—Ä–∏–±—É—Ç –¥–ª—è –æ–±—Ö–æ–¥–∞ Gatekeeper.

```bash
xattr -l /path/to/suspicious/file                       # –≤—Å–µ –∞—Ç—Ä–∏–±—É—Ç—ã

# –ü–æ–∏—Å–∫ —Ñ–∞–π–ª–æ–≤ –ë–ï–ó –∞—Ç—Ä–∏–±—É—Ç–∞ –∫–∞—Ä–∞–Ω—Ç–∏–Ω–∞ (–æ–±—Ö–æ–¥ Gatekeeper)
find ~/Downloads -name "*.app" | while read f; do
  xattr "$f" 2>/dev/null | grep -q "quarantine" || echo "NO QUARANTINE: $f"
done
```

---

## 5. User Activity

*–¶–∏—Ñ—Ä–æ–≤–æ–π —Å–ª–µ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ‚Äî —á—Ç–æ, –∫–æ–≥–¥–∞ –∏ –∫–∞–∫ –¥–æ–ª–≥–æ.*

### 5.1 Shell History üî¥

**–ß—Ç–æ —ç—Ç–æ:** –§–∞–π–ª—ã –∏—Å—Ç–æ—Ä–∏–∏ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏. –í macOS 10.15+ –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π shell ‚Äî zsh, —Ñ–∞–π–ª ‚Äî `~/.zsh_history`. –ü—Ä–∏ –≤–∫–ª—é—á—ë–Ω–Ω–æ–º `EXTENDED_HISTORY` –∫–∞–∂–¥–∞—è –∫–æ–º–∞–Ω–¥–∞ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è —Å Unix timestamp. **–í–∞–∂–Ω–æ: –∏—Å—Ç–æ—Ä–∏—è –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Å–µ—Å—Å–∏–∏ shell** ‚Äî –µ—Å–ª–∏ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ —É–±–∏–ª —Ç–µ—Ä–º–∏–Ω–∞–ª, –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã –º–æ–≥—É—Ç –Ω–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å—Å—è.

**–ü—É—Ç–∏:**
```
~/.zsh_history            ‚Üê zsh (macOS 10.15+, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
~/.bash_history           ‚Üê bash (legacy)
~/.zsh_sessions/          ‚Üê —Å–µ—Å—Å–∏–æ–Ω–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è zsh
~/.zshrc
~/.bashrc
```

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö–∞–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã –≤—ã–ø–æ–ª–Ω—è–ª –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫?
- –ï—Å—Ç—å –ª–∏ lateral movement (ssh, scp –∫ –¥—Ä—É–≥–∏–º —Ö–æ—Å—Ç–∞–º)?
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –ª–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —ç–∫—Å—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ (curl, wget, nc, base64)?
- –ë—ã–ª–∏ –ª–∏ –ø–æ–ø—ã—Ç–∫–∏ —Å–æ–∫—Ä—ã—Ç–∏—è —Å–ª–µ–¥–æ–≤ (`history -c`, `rm ~/.zsh_history`)?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# –î–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ zsh EXTENDED_HISTORY (: timestamp:elapsed;command)
awk '/^: [0-9]/{
  ts = substr($2, 1, index($2,":")-1)
  cmd = $0; sub(/^: [0-9]+:[0-9]+;/,"",cmd)
  printf "%s\t%s\n", strftime("%Y-%m-%d %H:%M:%S", ts), cmd
}' ~/.zsh_history

# –ü–æ–∏—Å–∫ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–æ–º–∞–Ω–¥
grep -Ei "wget|curl|qemu|http|tcp|tor|tunnel|reverse|socks|proxy|cred|ssh|php|perl|python|\.py|\.sh|\.sql|tmp|temp|shm|splo|xplo|cve|gcc|chmod|passwd|shadow|useradd|authorized_keys|hosts|[[:digit:]]{1,3}\.[[:digit:]]{1,3}\.[[:digit:]]{1,3}\.[[:digit:]]{1,3}|github|pastebin|cdn|(:| )(443|80|22|445|3389)|nmap|scan|dump|flood|ddos|ncat|netcat|gsock|gs.sock|gssock|g.sock|a\.out|HISTFILE|preload|sh_history|whoami|^w$|\.io" ~/.zsh_history
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** UAC ¬∑ Aftermath

---

### 5.2 KnowledgeC Database üî¥

**–ß—Ç–æ —ç—Ç–æ:** SQLite-–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–¥—Å–∏—Å—Ç–µ–º—ã CoreDuet, –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—â–µ–π –ø–∞—Ç—Ç–µ—Ä–Ω –∂–∏–∑–Ω–∏ (pattern of life) –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –•—Ä–∞–Ω–∏—Ç –∏—Å—Ç–æ—Ä–∏—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏: –∫–∞–∫–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –∏ –∫–∞–∫ –¥–æ–ª–≥–æ, –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —ç–∫—Ä–∞–Ω–∞, Bluetooth-–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è, –ø–æ—Å–µ—â—ë–Ω–Ω—ã–µ —Å–∞–π—Ç—ã, –º–µ–¥–∏–∞–≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ. –ê–Ω–∞–ª–æ–≥ Windows UserAssist+SRUM, –Ω–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±–æ–≥–∞—á–µ. –í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ –≤ Apple Epoch.

**–ü—É—Ç—å:** `~/Library/Application Support/Knowledge/knowledgeC.db`

> ‚ö†Ô∏è –° macOS 13 (Ventura) –¥–∞–Ω–Ω—ã–µ —á–∞—Å—Ç–∏—á–Ω–æ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω—ã –≤ **Biome** (protobuf-—Ñ–æ—Ä–º–∞—Ç, —Å–º. –¥–∞–ª–µ–µ).

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö–∞–∫–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –∏ –∫–∞–∫ –¥–æ–ª–≥–æ (–ø–æ–ª–Ω—ã–π timeline –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏)?
- –ö–æ–≥–¥–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –±–ª–æ–∫–∏—Ä–æ–≤–∞–ª–æ—Å—å/—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª–æ—Å—å (–∞–ª–∏–±–∏ –∏–ª–∏ –µ–≥–æ –æ–ø—Ä–æ–≤–µ—Ä–∂–µ–Ω–∏–µ)?
- –ö–∞–∫–∏–µ –±—Ä–∞—É–∑–µ—Ä–Ω—ã–µ —Å–∞–π—Ç—ã –ø–æ—Å–µ—â–∞–ª–∏—Å—å (–Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫, –¥—É–±–ª–∏—Ä—É–µ—Ç Safari History)?
- –ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–∫—Ç–∏–≤–Ω–æ —Ä–∞–±–æ—Ç–∞–ª –∑–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ–º?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash

# SQLite ‚Äî —Ç–æ–ø –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
sqlite3 ~/Library/Application\ Support/Knowledge/knowledgeC.db \
  "SELECT ZVALUESTRING as app,
   SUM(ZENDDATE - ZSTARTDATE) as total_seconds
   FROM ZOBJECT WHERE ZSTREAMNAME = '/app/inFocus'
   GROUP BY ZVALUESTRING ORDER BY total_seconds DESC LIMIT 20;"
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** UAC ¬∑ Aftermath ¬∑ mac_apt (KNOWLEDGEC) ¬∑ Velociraptor

---

### 5.3 Biome Data (macOS 13+) üü°

**–ß—Ç–æ —ç—Ç–æ:** –ù–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–∞ –∂–∏–∑–Ω–∏, –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –∑–∞–º–µ–Ω—è—é—â–∞—è KnowledgeC. –ë–∏–Ω–∞—Ä–Ω—ã–π protobuf-—Ñ–æ—Ä–º–∞—Ç. –í–∫–ª—é—á–∞–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, App Intents, Shortcuts. UAC –∏ Aftermath –Ω–µ —Å–æ–±–∏—Ä–∞—é—Ç Biome –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ ‚Äî —Ç–æ–ª—å–∫–æ —Ä—É—á–Ω–æ–π —Å–±–æ—Ä.

**–ü—É—Ç–∏:**
```
~/Library/Biome/            ‚Üê –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
/private/var/db/biome/      ‚Üê —Å–∏—Å—Ç–µ–º–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
```

```bash
# –ü–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
find ~/Library/Biome/ /private/var/db/biome/ -type f | head -30

# biomedata –ø–∞—Ä—Å–µ—Ä
python3 biomedata.py ~/Library/Biome/
```

> ‚ö†Ô∏è –ù–∏ UAC, –Ω–∏ Aftermath –Ω–µ —Å–æ–±–∏—Ä–∞—é—Ç Biome –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ ‚Äî —Ç—Ä–µ–±—É–µ—Ç—Å—è `rsync` –≤—Ä—É—á–Ω—É—é –∏–ª–∏ Velociraptor.

---

### 5.4 Apple Intelligence Artifacts (macOS 15+) üü°

**–ß—Ç–æ —ç—Ç–æ:** –ù–æ–≤—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤, –ø–æ—è–≤–∏–≤—à–∏–π—Å—è —Å macOS 15.1 (Sequoia) –∏ Apple Intelligence. –ë–∞–∑–∞ `views.db` —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–æ–±—ã—Ç–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è/–æ—Ç–∫–ª—é—á–µ–Ω–∏—è –æ—Ç Wi-Fi –∏ –¥—Ä—É–≥–æ–π –∫–æ–Ω—Ç–µ–∫—Å—Ç. –ü–∞–ø–∫–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–∞ –≤—Å–µ—Ö Mac –Ω–∞—á–∏–Ω–∞—è —Å macOS 14+, –¥–∞–∂–µ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö –±–µ–∑ Apple Silicon.

**–ü—É—Ç—å:**
```
~/Library/IntelligencePlatform/
  ‚îî‚îÄ‚îÄ Artifacts/internal/views.db      ‚Üê Wi-Fi —Å–æ–±—ã—Ç–∏—è –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç (—Ç–∞–±–ª–∏—Ü–∞ wifiContextEvents)
```

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö –∫–∞–∫–∏–º Wi-Fi —Å–µ—Ç—è–º –ø–æ–¥–∫–ª—é—á–∞–ª–æ—Å—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏)?
- –ö–æ–≥–¥–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è/–æ—Ç–∫–ª—é—á–µ–Ω–∏—è?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
sqlite3 ~/Library/IntelligencePlatform/Artifacts/internal/views.db \
  ".tables"

sqlite3 ~/Library/IntelligencePlatform/Artifacts/internal/views.db \
  "SELECT * FROM wifiContextEvents ORDER BY timestamp DESC LIMIT 50;"
```

> ‚ÑπÔ∏è –ù–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö –±–µ–∑ Apple Silicon (Intel Mac) –¥–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ–ø–æ–ª–Ω—ã–º–∏. –û—Å–Ω–æ–≤–Ω—ã–µ AI-—Ñ—É–Ω–∫—Ü–∏–∏ —Ç—Ä–µ–±—É—é—Ç M1+.

---

### 5.5 Recent Items –∏ MRU üü°

**–ß—Ç–æ —ç—Ç–æ:** –ù–µ—Å–∫–æ–ª—å–∫–æ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –Ω–µ–¥–∞–≤–Ω–æ –æ—Ç–∫—Ä—ã—Ç—ã—Ö —Ñ–∞–π–ª–∞—Ö, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö –∏ –ø–∞–ø–∫–∞—Ö. –•—Ä–∞–Ω—è—Ç—Å—è –≤ `.sfl2` —Ñ–∞–π–ª–∞—Ö (–±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç).

**–ü—É—Ç–∏:**
```
~/Library/Application Support/com.apple.sharedfilelist/
  com.apple.LSSharedFileList.RecentApplications.sfl2
  com.apple.LSSharedFileList.RecentDocuments.sfl2
  com.apple.LSSharedFileList.RecentServers.sfl2
~/Library/Preferences/com.apple.recentitems.plist
```

```bash
# Finder ‚Äî –Ω–µ–¥–∞–≤–Ω–∏–µ –ø–∞–ø–∫–∏
plutil -p ~/Library/Preferences/com.apple.finder.plist
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** mac_apt (RECENTITEMS)

---

### 5.6 Trash (–ö–æ—Ä–∑–∏–Ω–∞) üü°

**–ß—Ç–æ —ç—Ç–æ:** –£–¥–∞–ª—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã —Ñ–∏–∑–∏—á–µ—Å–∫–∏ –æ—Å—Ç–∞—é—Ç—Å—è –Ω–∞ –¥–∏—Å–∫–µ –¥–æ –æ—á–∏—Å—Ç–∫–∏ –∫–æ—Ä–∑–∏–Ω—ã. –ü–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞–π—Ç–∏ —Ñ–∞–π–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—ã—Ç–∞–ª—Å—è —É–¥–∞–ª–∏—Ç—å: –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã, –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ —Ñ–∞–π–ª—ã, –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∞—Ç–∞–∫–∏.

**–ü—É—Ç–∏:**
```
~/.Trash/
/Volumes/<name>/.Trashes/<UID>/
```

```bash
ls -lat ~/.Trash/
find ~/.Trash -type f -exec shasum -a 256 {} \;
```

---

### 5.7 –ë—Ä–∞—É–∑–µ—Ä–Ω—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã ‚Äî Safari üü°

**–ü—É—Ç—å:**
```
~/Library/Safari/History.db
~/Library/Safari/Downloads.plist
```

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
sqlite3 ~/Library/Safari/History.db \
  "SELECT datetime(hv.visit_time + 978307200, 'unixepoch') as time,
   hi.url, hv.title
   FROM history_visits hv
   JOIN history_items hi ON hv.history_item = hi.id
   ORDER BY hv.visit_time DESC LIMIT 100;"
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** Aftermath ¬∑ mac_apt (SAFARI)

---

### 5.8 –ë—Ä–∞—É–∑–µ—Ä–Ω—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã ‚Äî Chrome / Edge / Firefox üü°

**–ü—É—Ç–∏:**
```
~/Library/Application Support/Google/Chrome/Default/History
~/Library/Application Support/Microsoft Edge/Default/History
~/Library/Application Support/BraveSoftware/Brave-Browser/Default/History
~/Library/Application Support/Firefox/Profiles/*.default*/places.sqlite
```

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# Chrome (—Ñ–æ—Ä–º–∞—Ç: microseconds —Å 01.01.1601)
sqlite3 ~/Library/Application\ Support/Google/Chrome/Default/History \
  "SELECT datetime(last_visit_time/1000000 - 11644473600, 'unixepoch') as time,
   url, title, visit_count FROM urls ORDER BY last_visit_time DESC LIMIT 100;"

# Firefox
sqlite3 ~/Library/Application\ Support/Firefox/Profiles/*.default*/places.sqlite \
  "SELECT datetime(v.visit_date/1000000, 'unixepoch') as time,
   p.url, p.title FROM moz_historyvisits v
   JOIN moz_places p ON v.place_id = p.id
   ORDER BY v.visit_date DESC LIMIT 100;"
```

> **–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è Chrome timestamp:** `timestamp / 1000000 - 11644473600 = Unix timestamp`

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** mac_apt (CHROME) ¬∑ Aftermath

---

### 5.9 –ù–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –æ–±–ª–∞—á–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã üü°

**–ß—Ç–æ —ç—Ç–æ:** SQLite-–±–∞–∑–∞ –≤—Å–µ—Ö –æ–±–ª–∞—á–Ω—ã—Ö –∏ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö —É—á—ë—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π —Å–∏—Å—Ç–µ–º—ã: iCloud, Exchange, Google, LDAP. –ü–æ–∑–≤–æ–ª—è–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å, –∫ –∫–∞–∫–∏–º —Å–µ—Ä–≤–∏—Å–∞–º –∏–º–µ–ª –¥–æ—Å—Ç—É–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.

**–ü—É—Ç—å:** `~/Library/Accounts/Accounts4.sqlite`

```bash
sqlite3 ~/Library/Accounts/Accounts4.sqlite \
  "SELECT ZACCOUNTTYPEDESCRIPTION, ZUSERNAME, ZDATE
   FROM ZACCOUNT
   JOIN ZACCOUNTTYPE ON ZACCOUNT.ZACCOUNTTYPE = ZACCOUNTTYPE.Z_PK
   ORDER BY ZDATE DESC;"
```

---

## 6. System Logs

*–°–∏—Å—Ç–µ–º–Ω—ã–µ –∂—É—Ä–Ω–∞–ª—ã ‚Äî —Ö—Ä–æ–Ω–æ–ª–æ–≥–∏—è —Å–æ–±—ã—Ç–∏–π —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π.*

### 6.1 Unified Logging System üî¥ ‚ö†Ô∏è

**–ß—Ç–æ —ç—Ç–æ:** –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è macOS. –ó–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –æ—Ç –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –∏ –ø–æ–¥—Å–∏—Å—Ç–µ–º –û–°. –•—Ä–∞–Ω–∏—Ç—Å—è –≤ `.tracev3` —Ñ–∞–π–ª–∞—Ö.

**–ü—É—Ç—å:**
```
/private/var/db/diagnostics/            ‚Üê –æ—Å–Ω–æ–≤–Ω—ã–µ –ª–æ–≥–∏
/private/var/db/diagnostics/Persist/    ‚Üê –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–π –∞—Ä—Ö–∏–≤
/private/var/db/uuidtext/               ‚Üê —Ç–∞–±–ª–∏—Ü–∞ —Å–∏–º–≤–æ–ª–æ–≤
```

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ß—Ç–æ –¥–µ–ª–∞–ª–∞ —Å–∏—Å—Ç–µ–º–∞ –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏?
- –ë—ã–ª–∏ –ª–∏ –æ—à–∏–±–∫–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –ø–æ–ø—ã—Ç–∫–∏ sudo?
- –ö–∞–∫–æ–µ –ü–û —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª–æ—Å—å –∏ –∫–æ–≥–¥–∞?
- –ï—Å—Ç—å –ª–∏ –ø–æ–ø—ã—Ç–∫–∏ –æ–±—Ö–æ–¥–∞ TCC –∏–ª–∏ SIP?
- –ö–æ–≥–¥–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–∏ SSH-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# –ü–æ–ª–Ω—ã–π —ç–∫—Å–ø–æ—Ä—Ç (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è ‚Äî —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ)
sudo log collect --output /output/system_logs.logarchive

# –ü—Ä–æ–≤–∞–ª—ã sudo
log show --last 7d \
  --predicate 'eventMessage contains "sudo" AND eventMessage contains "COMMAND"'

# SSH-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
log show --last 7d --predicate 'process == "sshd"'

# TCC (–∑–∞–ø—Ä–æ—Å—ã —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π)
log show --last 7d --predicate 'subsystem == "com.apple.TCC"'

# XProtect (–≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π AV Apple)
log show --last 30d --predicate 'process contains "XProtect"'

# SIP-—Å–æ–±—ã—Ç–∏—è
log show --last 7d \
  --predicate 'eventMessage contains[c] "System Integrity Protection"'

# –ü—Ä–æ–≤–∞–ª—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
log show --last 24h \
  --predicate 'eventMessage contains "authentication" AND eventMessage contains "fail"'

# –£–¥–∞–ª—ë–Ω–Ω—ã–π —Ä–∞–±–æ—á–∏–π —Å—Ç–æ–ª / Screen Sharing
log show --last 7d --predicate 'process == "screensharingd"'
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** UAC (–ø–æ–ª–Ω—ã–π `.logarchive`) ¬∑ Aftermath (–ø—Ä–µ–¥–∏–∫–∞—Ç–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞)

---

### 6.2 Install Log üü°

**–ß—Ç–æ —ç—Ç–æ:** –ñ—É—Ä–Ω–∞–ª —É—Å—Ç–∞–Ω–æ–≤–∫–∏ PKG-–ø–∞–∫–µ—Ç–æ–≤ –∏ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π. –ü–æ–∑–≤–æ–ª—è–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–æ—á–Ω–æ–µ –≤—Ä–µ–º—è –∏–Ω—Å—Ç–∞–ª–ª—è—Ü–∏–∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ü–û.

**–ü—É—Ç—å:** `/private/var/log/install.log`

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö–æ–≥–¥–∞ –∏ –∫–∞–∫–æ–π PKG-–ø–∞–∫–µ—Ç –±—ã–ª —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ —Å–∏—Å—Ç–µ–º–µ?
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª–æ—Å—å –ª–∏ –ü–û –≤ –Ω–µ—Ç–∏–ø–∏—á–Ω–æ–µ –≤—Ä–µ–º—è (–Ω–æ—á—å—é, –≤ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)?
- –ï—Å—Ç—å –ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏–∑ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –∏–ª–∏ —Å –æ—à–∏–±–∫–∞–º–∏?
- –°–æ–≤–ø–∞–¥–∞–µ—Ç –ª–∏ –≤—Ä–µ–º—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é –∏–∑ –¥—Ä—É–≥–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
cat /private/var/log/install.log

# –£—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏ –æ—à–∏–±–∫–∏
grep -i "install\|pkg\|error\|fail" /private/var/log/install.log | tail -100

# –•—Ä–æ–Ω–æ–ª–æ–≥–∏—è: —á—Ç–æ —Å—Ç–∞–≤–∏–ª–æ—Å—å –ø–æ—Å–ª–µ–¥–Ω–∏–º
grep -i "installed\|package" /private/var/log/install.log | tail -50
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** UAC

---

### 6.3 Crash Reports üü°

**–ß—Ç–æ —ç—Ç–æ:** –û—Ç—á—ë—Ç—ã –æ –ø–∞–¥–µ–Ω–∏—è—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π (ReportCrash). –°–æ–¥–µ—Ä–∂–∞—Ç: –∏–º—è –ø—Ä–æ—Ü–µ—Å—Å–∞, –≤—Ä–µ–º—è –∫—Ä–∞—à–∞, —Ç–∏–ø –∏—Å–∫–ª—é—á–µ–Ω–∏—è, —Å—Ç–µ–∫—Ç—Ä–µ–π—Å, –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏. –ê–Ω–æ–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫—Ä–∞—à–µ–π –æ—Ç –æ–¥–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏–ª–∏ –∫—Ä–∞—à–∏ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ = –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã exploit-–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.

**–ü—É—Ç–∏:**
```
~/Library/Logs/DiagnosticReports/
/Library/Logs/DiagnosticReports/
```

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö–∞–∫–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –ø–∞–¥–∞–ª–∏ –∏ –∫–æ–≥–¥–∞ (–≤—Ä–µ–º–µ–Ω–Ω–∞ÃÅ—è –ø—Ä–∏–≤—è–∑–∫–∞ –∫ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—É)?
- –ö—Ä–∞—à–∏–ª –ª–∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–ª–∏ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å?
- –ö–∞–∫–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –±—ã–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –≤ –º–æ–º–µ–Ω—Ç –∫—Ä–∞—à–∞ (–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∏–Ω—ä–µ–∫—Ü–∏–∏)?
- –ï—Å—Ç—å –ª–∏ —Å–µ—Ä–∏–π–Ω—ã–µ –∫—Ä–∞—à–∏ –æ–¥–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ (–ø—Ä–∏–∑–Ω–∞–∫ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ —ç–∫—Å–ø–ª–æ–π—Ç–∞ –∏–ª–∏ —Å–±–æ—è –∞–≥–µ–Ω—Ç–∞)?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# –°–ø–∏—Å–æ–∫ –ø–æ –¥–∞—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
ls -lt ~/Library/Logs/DiagnosticReports/

# –ö—Ä–∞—à–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π
find ~/Library/Logs/DiagnosticReports/ -name "*.crash" -mtime -7
find /Library/Logs/DiagnosticReports/ -name "*.crash" -mtime -7

# –ü—Ä–æ—Å–º–æ—Ç—Ä –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –æ—Ç—á—ë—Ç–∞
cat ~/Library/Logs/DiagnosticReports/<process>.crash

# –ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
grep -r "Process:" ~/Library/Logs/DiagnosticReports/ | sort
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** UAC (—Å–æ–±–∏—Ä–∞–µ—Ç –æ–±–∞ –ø—É—Ç–∏)

---

### 6.4 ASL (Apple System Log) üü¢

**–ß—Ç–æ —ç—Ç–æ:** –£—Å—Ç–∞—Ä–µ–≤—à–∞—è —Å–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–≤—à–∞—è—Å—è –¥–æ macOS 10.12 (Sierra). –ù–∞ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö –∑–∞–º–µ–Ω–µ–Ω–∞ Unified Logging System. –ù–∞ —Å–∏—Å—Ç–µ–º–∞—Ö —Å –∏—Å—Ç–æ—Ä–∏–µ–π –∏–ª–∏ –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ —Å—Ç–∞—Ä—ã—Ö –æ–±—Ä–∞–∑–æ–≤ –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø–æ–ª–µ–∑–Ω—ã–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –∑–∞–ø–∏—Å–∏.

**–ü—É—Ç—å:** `/private/var/log/asl/`

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ï—Å—Ç—å –ª–∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –ª–æ–≥–∏ –Ω–∞ —Å–∏—Å—Ç–µ–º–µ, –∫–æ—Ç–æ—Ä–∞—è –æ–±–Ω–æ–≤–ª—è–ª–∞—Å—å —Å macOS 10.11 –∏ –Ω–∏–∂–µ?
- –ß—Ç–æ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–ª–æ—Å—å –¥–æ –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ Unified Logging?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä —á–µ—Ä–µ–∑ syslog
syslog -f /var/log/asl/*.asl

# –ü—Ä—è–º–æ–π —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤
ls -lt /private/var/log/asl/

# –ß—Ç–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
syslog -f /private/var/log/asl/<filename>.asl
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** UAC

---

## 7. Authentication

*–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è ‚Äî –∫—Ç–æ, —á—Ç–æ –∏ –∫–æ–≥–¥–∞ –º–æ–≥ –¥–µ–ª–∞—Ç—å.*

### 7.1 TCC Database (Transparency, Consent, Control) üî¥ ‚ö†Ô∏è

**–ß—Ç–æ —ç—Ç–æ:** SQLite-–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º—ã —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π macOS. –§–∏–∫—Å–∏—Ä—É–µ—Ç –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –Ω–∞ –¥–æ—Å—Ç—É–ø –∫ –∑–∞—â–∏—â—ë–Ω–Ω—ã–º —Ä–µ—Å—É—Ä—Å–∞–º: –º–∏–∫—Ä–æ—Ñ–æ–Ω, –∫–∞–º–µ—Ä–∞, —ç–∫—Ä–∞–Ω, Full Disk Access, –∫–æ–Ω—Ç–∞–∫—Ç—ã, –ø–æ—á—Ç–∞. –ö–∞–∂–¥–∞—è –∑–∞–ø–∏—Å—å: bundle ID –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã–π —Ä–µ—Å—É—Ä—Å, —Ä–µ—à–µ–Ω–∏–µ (allow/deny), timestamp –∏–∑–º–µ–Ω–µ–Ω–∏—è.

**–ü—É—Ç–∏:**
```
/Library/Application Support/com.apple.TCC/TCC.db       ‚Üê —Å–∏—Å—Ç–µ–º–Ω—ã–π (—Ç—Ä–µ–±—É–µ—Ç root)
~/Library/Application Support/com.apple.TCC/TCC.db      ‚Üê –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π
```

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö–∞–∫–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø–æ–ª—É—á–∏–ª–∏ Full Disk Access, –¥–æ—Å—Ç—É–ø –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É, –∫–∞–º–µ—Ä–µ, —ç–∫—Ä–∞–Ω—É?
- –ü–æ–ª—É—á–∞–ª–æ –ª–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ –ü–û –ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è?
- –ö–æ–≥–¥–∞ –±—ã–ª–∏ –≤—ã–¥–∞–Ω—ã —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è (–≤—Ä–µ–º—è –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏)?

**–ö–ª—é—á–µ–≤—ã–µ —Å–µ—Ä–≤–∏—Å—ã TCC:**

| Service | –ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç |
|---------|-------------|
| `kTCCServiceScreenCapture` | –ó–∞—Ö–≤–∞—Ç —ç–∫—Ä–∞–Ω–∞  |
| `kTCCServiceAccessibility` | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ UI  |
| `kTCCServiceSystemPolicyAllFiles` | Full Disk Access (–º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞) |
| `kTCCServiceMicrophone` | –ú–∏–∫—Ä–æ—Ñ–æ–Ω  |
| `kTCCServiceCamera` | –ö–∞–º–µ—Ä–∞ |
| `kTCCServiceAddressBook` | –ö–æ–Ω—Ç–∞–∫—Ç—ã  |

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
sudo sqlite3 /Library/Application\ Support/com.apple.TCC/TCC.db \
  "SELECT client, service,
   datetime(last_modified, 'unixepoch') as modified,
   CASE auth_value
     WHEN 0 THEN 'Denied'
     WHEN 2 THEN 'Allowed'
     WHEN 3 THEN 'Limited'
   END as status
   FROM access ORDER BY last_modified DESC;"

# –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è ‚Äî —Ç–æ–ª—å–∫–æ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
sudo sqlite3 /Library/Application\ Support/com.apple.TCC/TCC.db \
  "SELECT client, service, datetime(last_modified,'unixepoch') FROM access
   WHERE service IN (
     'kTCCServiceScreenCapture',
     'kTCCServiceAccessibility',
     'kTCCServiceSystemPolicyAllFiles',
     'kTCCServiceMicrophone',
     'kTCCServiceCamera'
   ) ORDER BY last_modified DESC;"
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** Aftermath ¬∑ UAC ¬∑ mac_apt (TCC)

---

### 7.2 Keychain üü° ‚ö†Ô∏è üîê

**–ß—Ç–æ —ç—Ç–æ:** –ó–∞—â–∏—â—ë–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –ø–∞—Ä–æ–ª–µ–π, —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –∏ –∫–ª—é—á–µ–π. –•—Ä–∞–Ω–∏—Ç Wi-Fi –ø–∞—Ä–æ–ª–∏, –ø–∞—Ä–æ–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –∏ —Å–∞–π—Ç–æ–≤, –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏ SSH/TLS, API-—Ç–æ–∫–µ–Ω—ã, VPN-—É—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ. **–î–æ—Å—Ç—É–ø –∫ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É –≤–æ–∑–º–æ–∂–µ–Ω —Ç–æ–ª—å–∫–æ –Ω–∞ –∂–∏–≤–æ–π —Å–∏—Å—Ç–µ–º–µ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –ø–∞—Ä–æ–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** ‚Äî —Å –æ–±—Ä–∞–∑–∞ –¥–∏—Å–∫–∞ –±–µ–∑ –ø–∞—Ä–æ–ª—è –Ω–µ –ø–æ–ª—É—á–∏—Ç—å.

**–ü—É—Ç–∏:**
```
~/Library/Keychains/login.keychain-db    ‚Üê –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π
/Library/Keychains/System.keychain       ‚Üê —Å–∏—Å—Ç–µ–º–Ω—ã–π
```

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö–∞–∫–∏–µ –Ω–µ–ª–µ–≥–∏—Ç–∏–º–Ω—ã–µ –∫–æ—Ä–Ω–µ–≤—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã (MITM-–∞—Ç–∞–∫–∞)?
- –ï—Å—Ç—å –ª–∏ —Å—Ç–æ—Ä–æ–Ω–Ω–∏–µ API-—Ç–æ–∫–µ–Ω—ã –∏–ª–∏ —É—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å?
- –ö–∞–∫–∏–µ —Å–µ—Ä–≤–∏—Å—ã —Ö—Ä–∞–Ω—è—Ç —Å–≤–æ–∏ —Å–µ–∫—Ä–µ—Ç—ã –≤ Keychain?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
security list-keychains
security dump-keychain ~/Library/Keychains/login.keychain-db   # –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –±–µ–∑ –ø–∞—Ä–æ–ª–µ–π

# –ù–µ–ª–µ–≥–∏—Ç–∏–º–Ω—ã–µ –∫–æ—Ä–Ω–µ–≤—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã (MITM)
security find-certificate -a /Library/Keychains/System.keychain | grep "labl"

# –í—Å–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –≤ —Å–∏—Å—Ç–µ–º–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
security find-certificate -a -p /Library/Keychains/System.keychain | \
  openssl x509 -noout -subject -issuer
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** Plaso (–ø–∞—Ä—Å–µ—Ä `mac_keychain`, –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –±–µ–∑ –ø–∞—Ä–æ–ª–µ–π)

---

### 7.3 Sudo Logs üî¥

**–ß—Ç–æ —ç—Ç–æ:** –í macOS 10.12+ —Å–æ–±—ã—Ç–∏—è sudo –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ Unified Logs, –∞ –Ω–µ –≤ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã. –§–∏–∫—Å–∏—Ä—É–µ—Ç: —É—Å–ø–µ—à–Ω—ã–µ –∏ –Ω–µ—É–¥–∞—á–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ sudo, –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã —Å –ø–æ–≤—ã—à–µ–Ω–∏–µ–º –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π.

**–ü—É—Ç—å:** Unified Logs (`/private/var/db/diagnostics/`)

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö–∞–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã –≤—ã–ø–æ–ª–Ω—è–ª–∏—Å—å —Å –ø—Ä–∞–≤–∞–º–∏ root –∏ –∫–µ–º?
- –ë—ã–ª–∏ –ª–∏ –ø–æ–ø—ã—Ç–∫–∏ –ø–æ–¥–±–æ—Ä–∞ sudo-–ø–∞—Ä–æ–ª—è?
- –ö–æ–≥–¥–∞ –≤–ø–µ—Ä–≤—ã–µ –ø–æ—è–≤–∏–ª–∏—Å—å sudo-—Å–µ—Å—Å–∏–∏ –æ—Ç –Ω–µ—Ç–∏–ø–∏—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è?
- –ö–∞–∫–∏–µ –±–∏–Ω–∞—Ä–∏ –∑–∞–ø—É—Å–∫–∞–ª–∏—Å—å —Å –ø–æ–≤—ã—à–µ–Ω–∏–µ–º –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# –í—Å–µ sudo-—Å–æ–±—ã—Ç–∏—è –∑–∞ 7 –¥–Ω–µ–π
log show --last 7d \
  --predicate 'eventMessage contains "sudo"' | \
  grep -E "COMMAND|incorrect password|authentication failure"

# –í—Å–µ sudo-—Å–µ—Å—Å–∏–∏ —Å –∫–æ–º–∞–Ω–¥–∞–º–∏
log show --last 30d --predicate 'process == "sudo"' | grep "TTY="

# –¢–æ–ª—å–∫–æ –Ω–µ—É–¥–∞—á–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏
log show --last 7d \
  --predicate 'process == "sudo" AND eventMessage contains "incorrect"'
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** UAC (logarchive) ¬∑ Aftermath (–ø—Ä–µ–¥–∏–∫–∞—Ç–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞)

---

### 7.4 SSH –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –∫–ª—é—á–∏ üî¥

**–ß—Ç–æ —ç—Ç–æ:** `authorized_keys` ‚Äî —Å–ø–∏—Å–æ–∫ –ø—É–±–ª–∏—á–Ω—ã—Ö –∫–ª—é—á–µ–π —Å –ø—Ä–∞–≤–æ–º –≤—Ö–æ–¥–∞ –ø–æ SSH –±–µ–∑ –ø–∞—Ä–æ–ª—è. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ backdoor-–∫–ª—é—á–∞ –≤ `authorized_keys` ‚Äî –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –º–µ—Ö–∞–Ω–∏–∑–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞ –ø–æ—Å–ª–µ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏.** `known_hosts` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫ –∫–∞–∫–∏–º —Ö–æ—Å—Ç–∞–º —Å–∏—Å—Ç–µ–º–∞ –ø–æ–¥–∫–ª—é—á–∞–ª–∞—Å—å –ø–æ SSH.

**–ü—É—Ç–∏:**
```
~/.ssh/authorized_keys    ‚Üê ALERT: –ª—é–±–æ–π –ø–æ—Å—Ç–æ—Ä–æ–Ω–Ω–∏–π –∫–ª—é—á = –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π backdoor
~/.ssh/known_hosts         ‚Üê –∏—Å—Ç–æ—Ä–∏—è SSH-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π (lateral movement)
~/.ssh/config              ‚Üê –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è SSH-–∫–ª–∏–µ–Ω—Ç–∞
~/.ssh/id_*                ‚Üê –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏
/etc/ssh/sshd_config       ‚Üê –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è SSH-—Å–µ—Ä–≤–µ—Ä–∞
```

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ï—Å—Ç—å –ª–∏ –ø–æ—Å—Ç–æ—Ä–æ–Ω–Ω–∏–µ –∫–ª—é—á–∏ –≤ `authorized_keys` (backdoor)?
- –ö –∫–∞–∫–∏–º —Ö–æ—Å—Ç–∞–º –ø–æ–¥–∫–ª—é—á–∞–ª–∞—Å—å —Å–∏—Å—Ç–µ–º–∞ –ø–æ SSH (lateral movement)?
- –í–∫–ª—é—á—ë–Ω –ª–∏ SSH-—Å–µ—Ä–≤–µ—Ä –∏ –∫–∞–∫–æ–≤—ã –µ–≥–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏?
- –ï—Å—Ç—å –ª–∏ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–∏–≤—ã –≤ `sshd_config` (PermitRootLogin, –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–æ—Ä—Ç)?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
sudo systemsetup -getremotelogin                    # —Å—Ç–∞—Ç—É—Å SSH-—Å–µ—Ä–≤–µ—Ä–∞
cat ~/.ssh/authorized_keys
cat ~/.ssh/known_hosts

# –ù–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ sshd
grep -v "^#\|^$" /etc/ssh/sshd_config

# SSH —á–µ—Ä–µ–∑ Unified Logs
log show --last 7d --predicate 'process == "sshd"'

# –ù–∞–π—Ç–∏ authorized_keys –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
find /Users -name "authorized_keys" 2>/dev/null
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** UAC

---

### 7.5 –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–∏—Å—Ç–µ–º—ã üü°

**–ß—Ç–æ —ç—Ç–æ:** –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ª–æ–∫–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π macOS. –ü–æ–∑–≤–æ–ª—è–µ—Ç –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å —Å–∫—Ä—ã—Ç—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (UID < 500) –∏–ª–∏ –Ω–µ–ª–µ–≥–∏—Ç–∏–º–Ω–æ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã.

**–ü—É—Ç—å:** Directory Services (dscl) / `/var/db/dslocal/nodes/Default/users/`

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ï—Å—Ç—å –ª–∏ —Å–∫—Ä—ã—Ç—ã–µ –∏–ª–∏ –Ω–µ–ª–µ–≥–∏—Ç–∏–º–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤ —Å–∏—Å—Ç–µ–º–µ?
- –ö—Ç–æ –æ–±–ª–∞–¥–∞–µ—Ç –ø—Ä–∞–≤–∞–º–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (sudo-–≥—Ä—É–ø–ø–∞)?
- –ï—Å—Ç—å –ª–∏ –∞–∫–∫–∞—É–Ω—Ç—ã —Å –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º shell-–¥–æ—Å—Ç—É–ø–æ–º?
- –ö–æ–≥–¥–∞ —Å–æ–∑–¥–∞–Ω –∫–∞–∂–¥—ã–π –∞–∫–∫–∞—É–Ω—Ç (–ø—Ä–∏–∑–Ω–∞–∫ backdoor-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
dscl . -list /Users UniqueID | sort -k2 -n          # –≤—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å UID
dscl . -list /Users UniqueID | awk '$2 >= 500'      # —Ç–æ–ª—å–∫–æ —Ä–µ–∞–ª—å–Ω—ã–µ (UID ‚â• 500)
dscl . -read /Groups/admin GroupMembership           # –∫—Ç–æ –∏–º–µ–µ—Ç sudo
dscl . -list /Users IsHidden | grep -v "^_\|Nobody" # —Å–∫—Ä—ã—Ç—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã
dscl . -list /Users UserShell | grep -v "nologin\|false"  # —Å shell-–¥–æ—Å—Ç—É–ø–æ–º

# –ö–æ–≥–¥–∞ —Å–æ–∑–¥–∞–Ω –∞–∫–∫–∞—É–Ω—Ç
dscl . -read /Users/<username> accountPolicyData | \
  python3 -c "import sys,plistlib; d=plistlib.loads(sys.stdin.buffer.read()); \
  print(d.get('creationTime','?'))"
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** UAC ¬∑ Aftermath (systemRecon)

---

### 7.6 –ò—Å—Ç–æ—Ä–∏—è –≤—Ö–æ–¥–æ–≤ üü°

**–ß—Ç–æ —ç—Ç–æ:** –ñ—É—Ä–Ω–∞–ª –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö –≤—Ö–æ–¥–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Å–∏—Å—Ç–µ–º—É. –ò—Å—Ç–æ—á–Ω–∏–∫–∏: `utmpx`-–±–∞–∑–∞ (–∫–æ–º–∞–Ω–¥–∞ `last`) –∏ Unified Logs —á–µ—Ä–µ–∑ `loginwindow`. –ü–æ–∑–≤–æ–ª—è–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ö—Ä–æ–Ω–æ–ª–æ–≥–∏—é —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –∏ —Å–µ—Ç–µ–≤—ã—Ö –≤—Ö–æ–¥–æ–≤.

**–ü—É—Ç—å:** `/var/log/wtmp` ¬∑ Unified Logs

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö—Ç–æ –∏ –∫–æ–≥–¥–∞ –≤—Ö–æ–¥–∏–ª –≤ —Å–∏—Å—Ç–µ–º—É?
- –ë—ã–ª–∏ –ª–∏ –≤—Ö–æ–¥—ã –≤ –Ω–µ—Ç–∏–ø–∏—á–Ω–æ–µ –≤—Ä–µ–º—è –∏–ª–∏ —Å –Ω–µ—Ç–∏–ø–∏—á–Ω—ã—Ö —Ö–æ—Å—Ç–æ–≤?
- –°–æ–≤–ø–∞–¥–∞—é—Ç –ª–∏ –≤—Ä–µ–º–µ–Ω–Ω—ãÃÅ–µ –º–µ—Ç–∫–∏ –≤—Ö–æ–¥–æ–≤ —Å –Ω–∞—á–∞–ª–æ–º –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏?
- –ë—ã–ª–∏ –ª–∏ –≤—Ö–æ–¥—ã —á–µ—Ä–µ–∑ Screen Sharing –∏–ª–∏ Remote Desktop?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
last | head -30                      # –ø–æ—Å–ª–µ–¥–Ω–∏–µ –≤—Ö–æ–¥—ã
last <username>                      # –≤—Ö–æ–¥—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
lastb 2>/dev/null                    # –Ω–µ—É–¥–∞—á–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –≤—Ö–æ–¥–∞ (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ)

# Unified Logs ‚Äî loginwindow
log show --last 30d \
  --predicate 'process == "loginwindow" OR subsystem == "com.apple.loginwindow"'

# Screen Sharing / Remote Desktop
log show --last 7d --predicate 'process == "screensharingd"'
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** UAC ¬∑ Aftermath

---

## 8. Applications

*–ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è ‚Äî —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ, —á—Ç–æ –ø–æ–¥–ø–∏—Å–∞–Ω–æ, —á—Ç–æ –ø–µ—á–∞—Ç–∞–ª–æ—Å—å.*

### 8.1 –ò—Å—Ç–æ—Ä–∏—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ü–û üü°

**–ß—Ç–æ —ç—Ç–æ:** Plist —Å —Ö—Ä–æ–Ω–æ–ª–æ–≥–∏–µ–π –≤—Å–µ—Ö —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö PKG-–ø–∞–∫–µ—Ç–æ–≤ –∏ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π. –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –Ω–∞–¥—ë–∂–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ —Ç–æ—á–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –∏–Ω—Å—Ç–∞–ª–ª—è—Ü–∏–∏ PKG.

**–ü—É—Ç–∏:**
```
/Library/Receipts/InstallHistory.plist
/private/var/db/receipts/
```

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö–æ–≥–¥–∞ –∏ –∫–∞–∫–æ–µ –ü–û –±—ã–ª–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ —á–µ—Ä–µ–∑ PKG?
- –ï—Å—Ç—å –ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤ –Ω–µ—Ç–∏–ø–∏—á–Ω–æ–µ –≤—Ä–µ–º—è –∏–ª–∏ –æ—Ç –Ω–µ—Ç–∏–ø–∏—á–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞?
- –°–æ–≤–ø–∞–¥–∞–µ—Ç –ª–∏ –≤—Ä–µ–º—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å –º–æ–º–µ–Ω—Ç–æ–º –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏?
- –ö–∞–∫–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è–ª–∏—Å—å (–∏ –∫–æ–≥–¥–∞ –ø–µ—Ä–µ—Å—Ç–∞–ª–∏ –ø—Ä–∏–º–µ–Ω—è—Ç—å—Å—è)?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
plutil -p /Library/Receipts/InstallHistory.plist

# –ü–æ—Å–ª–µ–¥–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
plutil -p /Library/Receipts/InstallHistory.plist | \
  grep -E "displayName|displayVersion|date|packageIdentifiers" | tail -40

pkgutil --pkgs                                      # –≤—Å–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ PKG
pkgutil --pkg-info com.suspicious.package           # –¥–µ—Ç–∞–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–∞–∫–µ—Ç–∞

# –í—Å–µ receipts –≤ db
ls /private/var/db/receipts/
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** UAC ¬∑ mac_apt

---

### 8.2 Code Signing –∏ Gatekeeper üü°

**–ß—Ç–æ —ç—Ç–æ:** Gatekeeper –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ü–∏—Ñ—Ä–æ–≤—É—é –ø–æ–¥–ø–∏—Å—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å –æ—Ç–æ–∑–≤–∞–Ω–Ω—ã–º —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–º –∏–ª–∏ –±–µ–∑ –ø–æ–¥–ø–∏—Å–∏ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è. –ó–∞–ø–∏—Å–∏ –æ–± –æ—Ü–µ–Ω–∫–∞—Ö —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ SQLite (`/var/db/SystemPolicy`).

**–ü—É—Ç—å:** `/var/db/SystemPolicy` ¬∑ `/var/db/SystemPolicy-prefs.plist`

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ó–∞–ø—É—Å–∫–∞–ª–∏—Å—å –ª–∏ –Ω–µ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–µ –∏–ª–∏ —Å –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–π –ø–æ–¥–ø–∏—Å—å—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è?
- –û—Ç–æ–∑–≤–∞–Ω –ª–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —É –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è?
- –ü—Ä–æ—à–ª–æ –ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–æ—Ç–∞—Ä–∏–∑–∞—Ü–∏—é Apple?
- –ö–∞–∫–∏–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è Gatekeeper —Å—É—â–µ—Å—Ç–≤—É—é—Ç –≤ —Å–∏—Å—Ç–µ–º–µ?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
spctl --status                                      # —Å—Ç–∞—Ç—É—Å Gatekeeper
spctl --list                                        # –∏—Å–∫–ª—é—á–µ–Ω–∏—è Gatekeeper
codesign -dvvv /Applications/SuspiciousApp.app      # –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏
spctl -a -vvv /Applications/SuspiciousApp.app       # –æ—Ü–µ–Ω–∫–∞ Gatekeeper
spctl --assess --verbose=4 --type exec /path/to/app # –Ω–æ—Ç–∞—Ä–∏–∑–∞—Ü–∏—è

# –ù–∞–π—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –±–µ–∑ –ø–æ–¥–ø–∏—Å–∏
find /Applications -name "*.app" -maxdepth 2 | while read app; do
  codesign -v "$app" 2>&1 | grep -l "not signed" && echo "$app"
done
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** Aftermath ¬∑ mac_apt

---

### 8.3 CUPS (–ñ—É—Ä–Ω–∞–ª –ø–µ—á–∞—Ç–∏) üü¢

**–ß—Ç–æ —ç—Ç–æ:** CUPS (Common Unix Printing System) ‚Äî —Å–∏—Å—Ç–µ–º–∞ –ø–µ—á–∞—Ç–∏ macOS. –í–µ–¥—ë—Ç –∂—É—Ä–Ω–∞–ª –≤—Å–µ—Ö –∑–∞–¥–∞–Ω–∏–π: –∏–º—è —Ñ–∞–π–ª–∞, –ø—Ä–∏–Ω—Ç–µ—Ä, –≤—Ä–µ–º—è, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å. –ö—Ä–∏—Ç–∏—á–µ–Ω –ø—Ä–∏ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è—Ö –∏–Ω—Å–∞–π–¥–µ—Ä—Å–∫–∏—Ö —É–≥—Ä–æ–∑ –∏ —É—Ç–µ—á–µ–∫ –¥–∞–Ω–Ω—ã—Ö.

**–ü—É—Ç–∏:**
```
/private/var/log/cups/access_log
/private/var/log/cups/page_log
```

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö–∞–∫–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –ø–µ—á–∞—Ç–∞–ª–∏—Å—å –∏ –∫–æ–≥–¥–∞?
- –ö—Ç–æ –æ—Ç–ø—Ä–∞–≤–ª—è–ª –∑–∞–¥–∞–Ω–∏—è –Ω–∞ –ø–µ—á–∞—Ç—å?
- –ï—Å—Ç—å –ª–∏ –º–∞—Å—Å–æ–≤–∞—è –ø–µ—á–∞—Ç—å –≤ –Ω–µ—Ç–∏–ø–∏—á–Ω–æ–µ –≤—Ä–µ–º—è (–ø—Ä–∏–∑–Ω–∞–∫ –∏–Ω—Å–∞–π–¥–µ—Ä—Å–∫–æ–π —É—Ç–µ—á–∫–∏)?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
cat /private/var/log/cups/page_log
cat /private/var/log/cups/access_log | grep -i "print"

# –ó–∞–¥–∞–Ω–∏—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π
grep "$(date -v-7d '+%d/%b')" /private/var/log/cups/page_log
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** UAC

---

## 9. Cloud & Sync

### 9.1 Time Machine üü°

**–ß—Ç–æ —ç—Ç–æ:** –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è. –î–ª—è IR: –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã **–¥–æ** –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏, –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —É–¥–∞–ª—ë–Ω–Ω—ã–µ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–æ–º —Ñ–∞–π–ª—ã. –õ–æ–∫–∞–ª—å–Ω—ã–µ APFS-—Å–Ω–∞–ø—à–æ—Ç—ã –¥–æ—Å—Ç—É–ø–Ω—ã –±–µ–∑ –≤–Ω–µ—à–Ω–µ–≥–æ –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—è –ø—Ä—è–º–æ –Ω–∞ –¥–∏—Å–∫–µ.

**–ü—É—Ç—å:** `/Volumes/Backups.backupdb/` (–≤–Ω–µ—à–Ω–∏–π) ¬∑ APFS-—Å–Ω–∞–ø—à–æ—Ç—ã –Ω–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–º —Ç–æ–º–µ

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö–∞–∫ –≤—ã–≥–ª—è–¥–µ–ª–∞ —Å–∏—Å—Ç–µ–º–∞ –¥–æ –º–æ–º–µ–Ω—Ç–∞ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏?
- –ö–∞–∫–∏–µ —Ñ–∞–π–ª—ã –±—ã–ª–∏ —É–¥–∞–ª–µ–Ω—ã –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–æ–º (–º–æ–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ –±—ç–∫–∞–ø–∞)?
- –ö–æ–≥–¥–∞ –ø–µ—Ä–µ—Å—Ç–∞–ª–∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è –±—ç–∫–∞–ø—ã (–≤–æ–∑–º–æ–∂–Ω–æ–µ –≤—Ä–µ–º—è –æ—Ç–∫–ª—é—á–µ–Ω–∏—è)?
- –ï—Å—Ç—å –ª–∏ —Å–Ω–∞–ø—à–æ—Ç—ã, –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—é—â–∏–µ –º–æ–º–µ–Ω—Ç –∞—Ç–∞–∫–∏?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
tmutil listlocalsnapshots /              # –ª–æ–∫–∞–ª—å–Ω—ã–µ APFS-—Å–Ω–∞–ø—à–æ—Ç—ã
tmutil listbackups                       # –∏—Å—Ç–æ—Ä–∏—è —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π

# –ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–Ω–∞–ø—à–æ—Ç–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
tmutil localsnapshot /                   # —Å–æ–∑–¥–∞—Ç—å —Å–Ω–∞–ø—à–æ—Ç —Å–µ–π—á–∞—Å (live)
mount_apfs -s com.apple.TimeMachine.<snapshot> /dev/disk1s1 /mnt/snapshot

# –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å —Ç–µ–∫—É—â–∏–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º
tmutil compare / /Volumes/Backups.backupdb/<hostname>/<date>/
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** UAC (–º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –±—ç–∫–∞–ø–æ–≤)

---

### 9.2 iCloud Drive üü°

**–ß—Ç–æ —ç—Ç–æ:** –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–±–ª–∞—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ. –§–∞–π–ª—ã –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–∫–∞—á–∞–Ω—ã (–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞) ‚Äî –Ω–∞ –¥–∏—Å–∫–µ —Ç–æ–ª—å–∫–æ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ-–∑–∞–≥–ª—É—à–∫–∏ (`.icloud`). –ü—Ä–∏ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏ —ç–∫—Å—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –≤–∞–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —É—à–ª–æ –≤ –æ–±–ª–∞–∫–æ.

**–ü—É—Ç—å:** `~/Library/Mobile Documents/`

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö–∞–∫–∏–µ —Ñ–∞–π–ª—ã –±—ã–ª–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Å iCloud (–ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è —ç–∫—Å—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è)?
- –ï—Å—Ç—å –ª–∏ —Ñ–∞–π–ª—ã, –≤—ã–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –≤ –æ–±–ª–∞–∫–æ, –Ω–æ —É–∂–µ —É–¥–∞–ª—ë–Ω–Ω—ã–µ –ª–æ–∫–∞–ª—å–Ω–æ?
- –ö–∞–∫–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç iCloud Drive –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
ls -la ~/Library/Mobile\ Documents/

# –§–∞–π–ª—ã-–∑–∞–≥–ª—É—à–∫–∏ (–≤—ã–≥—Ä—É–∂–µ–Ω—ã –≤ –æ–±–ª–∞–∫–æ, –ª–æ–∫–∞–ª—å–Ω–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç)
find ~/Library/Mobile\ Documents/ -name "*.icloud" | head -20

# –ù–µ–¥–∞–≤–Ω–æ –∏–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (–ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è —ç–∫—Å—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è)
find ~/Library/Mobile\ Documents/ -mtime -7 -type f | head -50
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** UAC (–º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏)

---

### 9.3 Dropbox / Google Drive / OneDrive üü¢

**–ß—Ç–æ —ç—Ç–æ:** –°—Ç–æ—Ä–æ–Ω–Ω–∏–µ –æ–±–ª–∞—á–Ω—ã–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞. –ö–∞–∂–¥—ã–π –∫–ª–∏–µ–Ω—Ç –≤–µ–¥—ë—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –ª–æ–∫–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏. –ü—Ä–∏ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏ —ç–∫—Å—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —á—Ç–æ –∏ –∫–æ–≥–¥–∞ –±—ã–ª–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ –≤ –æ–±–ª–∞–∫–æ.

**–ü—É—Ç–∏:**
```
~/Library/Application Support/Dropbox/
~/Library/Application Support/Google/DriveFS/
~/Library/Logs/Google/Drive/
~/Library/Containers/com.microsoft.OneDrive-mac/
```

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö–∞–∫–∏–µ —Ñ–∞–π–ª—ã –∑–∞–≥—Ä—É–∂–∞–ª–∏—Å—å –≤ –æ–±–ª–∞–∫–æ –∏ –∫–æ–≥–¥–∞?
- –ë—ã–ª–∏ –ª–∏ –º–∞—Å—Å–æ–≤—ã–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –≤ –Ω–µ—Ç–∏–ø–∏—á–Ω–æ–µ –≤—Ä–µ–º—è?
- –ü–æ–¥–∫–ª—é—á–µ–Ω—ã –ª–∏ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ –∏–ª–∏ –ª–∏—á–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# Dropbox ‚Äî –ª–æ–≥–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
find ~/Library/Application\ Support/Dropbox/ -name "*.log" | \
  xargs grep -i "upload\|sync" 2>/dev/null

# Google Drive ‚Äî –ª–æ–≥–∏
find ~/Library/Logs/Google/Drive/ -name "*.log" | \
  xargs grep -i "upload\|sync" 2>/dev/null | tail -100

# OneDrive ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
find ~/Library/Containers/com.microsoft.OneDrive-mac/ -name "*.log" 2>/dev/null
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** UAC (–º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π)

---

## 10. Security State

*–°–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞—â–∏—Ç–Ω—ã—Ö –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤ ‚Äî —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç –æ—Ü–µ–Ω–∫–∏ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏.*

### 10.1 System Integrity Protection (SIP) üî¥

**–ß—Ç–æ —ç—Ç–æ:** –ú–µ—Ö–∞–Ω–∏–∑–º –∑–∞—â–∏—Ç—ã —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –¥–∞–∂–µ –æ—Ç root. –ó–∞—â–∏—â–∞–µ—Ç `/System`, `/usr`, `/bin`, `/sbin`, —Å–∏—Å—Ç–µ–º–Ω—ã–µ LaunchDaemons. **–û—Ç–∫–ª—é—á—ë–Ω–Ω—ã–π SIP ‚Äî –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä:** –æ—Ç–∫–ª—é—á–∏—Ç—å –µ–≥–æ –º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ Recovery Mode —Å —Ñ–∏–∑–∏—á–µ—Å–∫–∏–º –¥–æ—Å—Ç—É–ø–æ–º.

**–ü—É—Ç—å:** –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è NVRAM (–Ω–µ —Ñ–∞–π–ª –Ω–∞ –¥–∏—Å–∫–µ)

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –í–∫–ª—é—á—ë–Ω –ª–∏ SIP (–æ–∂–∏–¥–∞–µ—Ç—Å—è: enabled)?
- –ï—Å—Ç—å –ª–∏ —á–∞—Å—Ç–∏—á–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è SIP (macOS 11+) ‚Äî —á—Ç–æ –∏–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω–æ?
- –ë—ã–ª–∏ –ª–∏ –≤–Ω–µ—Å–µ–Ω—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∑–∞—â–∏—â—ë–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
csrutil status
csrutil status --verbose    # macOS 11+ ‚Äî –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ñ–ª–∞–≥–æ–≤
# –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: "System Integrity Protection status: enabled."
# CRITICAL ALERT: –ª—é–±–æ–µ –¥—Ä—É–≥–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ç—Ä–µ–±—É–µ—Ç –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
sudo /usr/libexec/repair_packages --verify --standard-pkgs /
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** Aftermath (systemRecon)

---

### 10.2 Gatekeeper –∏ XProtect üî¥

**–ß—Ç–æ —ç—Ç–æ:** **Gatekeeper** ‚Äî –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–¥–ø–∏—Å–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ. **XProtect** ‚Äî –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π AV Apple –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–∏–≥–Ω–∞—Ç—É—Ä, –æ–±–Ω–æ–≤–ª—è–µ–º—ã–π —á–µ—Ä–µ–∑ Apple Updates –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (–Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç macOS).

**–ü—É—Ç—å:**
```
/Library/Apple/System/Library/CoreServices/XProtect.bundle/Contents/Resources   ‚Üê XProtect yara —Å–∏–≥–Ω–∞—Ç—É—Ä—ã
/var/db/SystemPolicy                                           ‚Üê Gatekeeper –±–∞–∑–∞
```

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –í–∫–ª—é—á—ë–Ω –ª–∏ Gatekeeper (–º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç–∫–ª—é—á—ë–Ω –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–æ–º –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –Ω–µ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω–æ–≥–æ –ü–û)?
- –ö–∞–∫–∏–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è Gatekeeper —Å—É—â–µ—Å—Ç–≤—É—é—Ç –≤ —Å–∏—Å—Ç–µ–º–µ?
- –ö–æ–≥–¥–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–∑ –æ–±–Ω–æ–≤–ª—è–ª—Å—è XProtect (—É—Å—Ç–∞—Ä–µ–≤—à–∏–π XProtect = –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ —Å–∏–≥–Ω–∞—Ç—É—Ä—ã)?
- –°—Ä–∞–±–∞—Ç—ã–≤–∞–ª –ª–∏ XProtect –∏–ª–∏ MRT –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
spctl --status                          # Gatekeeper (–æ–∂–∏–¥–∞–µ—Ç—Å—è "assessments enabled")
spctl --list                            # –∏—Å–∫–ª—é—á–µ–Ω–∏—è Gatekeeper

# XProtect –≤–µ—Ä—Å–∏—è –∏ –¥–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
defaults read /Library/Apple/System/Library/CoreServices/XProtect.bundle/\
Contents/Resources/XProtect.meta.plist

# –õ–æ–≥ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π XProtect –∏ MRT
log show --last 30d \
  --predicate 'process contains "XProtect" OR process contains "MRT"'
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** Aftermath (systemRecon)

---

### 10.3 FileVault —Å—Ç–∞—Ç—É—Å üü°

**–ß—Ç–æ —ç—Ç–æ:** –ü–æ–ª–Ω–æ–¥–∏—Å–∫–æ–≤–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ APFS (AES-XTS 128-bit). –ü—Ä–∏ –≤–∫–ª—é—á—ë–Ω–Ω–æ–º FileVault –±–µ–∑ –ø–∞—Ä–æ–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ –∫–ª—é—á–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –∞–Ω–∞–ª–∏–∑ –æ–±—Ä–∞–∑–∞ –¥–∏—Å–∫–∞ –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω.

**–ü—É—Ç—å:** –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è APFS (`/var/db/FileVault/`)

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –í–∫–ª—é—á–µ–Ω–æ –ª–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ (–∏ –º–æ–∂–Ω–æ –ª–∏ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∏—Å–∫ –æ—Ñ–ª–∞–π–Ω)?
- –ö—Ç–æ —è–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –¥–ª—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏?
- –ï—Å—Ç—å –ª–∏ –∫–ª—é—á –∏–Ω—Å—Ç–∏—Ç—É—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è (MDM)?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
fdesetup status                         # —Å—Ç–∞—Ç—É—Å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
diskutil apfs listVolumeGroups          # —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ç–æ–º–æ–≤ APFS
fdesetup list                           # –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ –∫–ª—é—á–∏
fdesetup isactive                       # –ø—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (0 = –∞–∫—Ç–∏–≤–Ω–æ)
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** Aftermath (systemRecon)

---

### 10.4 Secure Boot / T2 / Apple Silicon üü°

**–ß—Ç–æ —ç—Ç–æ:** –ù–∞ Mac —Å T2 (Intel 2018+) –∏–ª–∏ Apple Silicon —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã–π Secure Boot. **–ò–∑–º–µ–Ω—ë–Ω–Ω—ã–π Security Policy (Reduced/Permissive)** ‚Äî –ø—Ä–∏–∑–Ω–∞–∫ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∑–∞–≥—Ä—É–∑—á–∏–∫–∞ –∏–ª–∏ –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ–≥–æ –æ—Å–ª–∞–±–ª–µ–Ω–∏—è –∑–∞—â–∏—Ç—ã –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –Ω–µ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã—Ö —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π.

**–ü—É—Ç—å:** NVRAM / T2/ANE chip (–Ω–µ —Ñ–∞–π–ª –Ω–∞ –¥–∏—Å–∫–µ)

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö–∞–∫–æ–π —É—Ä–æ–≤–µ–Ω—å Security Policy —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (Full / Reduced / Permissive)?
- –í–∫–ª—é—á–µ–Ω–∞ –ª–∏ –∑–∞–≥—Ä—É–∑–∫–∞ —Å –≤–Ω–µ—à–Ω–∏—Ö –Ω–æ—Å–∏—Ç–µ–ª–µ–π (—Ä–∏—Å–∫ cold boot –∞—Ç–∞–∫)?
- –°–æ–≤–º–µ—Å—Ç–∏–º–æ –ª–∏ –∂–µ–ª–µ–∑–æ —Å Secure Boot (T2 –∏–ª–∏ Apple Silicon)?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
bputil -d                                               # Apple Silicon / T2 ‚Äî Security Policy
system_profiler SPHardwareDataType | grep "Chip\|Model" # —Ç–∏–ø —á–∏–ø–∞

# –°—Ç–∞—Ç—É—Å –∑–∞–≥—Ä—É–∑—á–∏–∫–∞ (—Ç–æ–ª—å–∫–æ —Å –∞–∫—Ç–∏–≤–Ω–æ–π —Å–µ—Å—Å–∏–µ–π –∏ –ø—Ä–∞–≤–∞–º–∏)
nvram -p | grep -i "security\|boot"
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** Aftermath (systemRecon)

---

## 11. Memory & Volatile

### 11.1 RAM-–¥–∞–º–ø ‚è±Ô∏è üü° ‚ö†Ô∏è

**–ß—Ç–æ —ç—Ç–æ:** –°–Ω–∞–ø—à–æ—Ç –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏. –°–æ–¥–µ—Ä–∂–∏—Ç –∑–∞–ø—É—â–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã, –∫–ª—é—á–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è, —Å–µ—Ç–µ–≤—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã, fileless malware, injected shellcode. –ù–∞ macOS —Å –≤–∫–ª—é—á—ë–Ω–Ω—ã–º SIP –ø–æ–ª—É—á–∏—Ç—å –ø–æ–ª–Ω—ã–π –¥–∞–º–ø RAM –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —Å–ª–æ–∂–Ω–µ–µ, —á–µ–º –Ω–∞ Linux/Windows.

**–ü—É—Ç—å:** —Ç–æ–ª—å–∫–æ live ‚Äî —Å–Ω–∏–º–∞–µ—Ç—Å—è —Å —Ä–∞–±–æ—Ç–∞—é—â–µ–π —Å–∏—Å—Ç–µ–º—ã

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ï—Å—Ç—å –ª–∏ –≤ –ø–∞–º—è—Ç–∏ fileless malware –∏–ª–∏ –∏–Ω–∂–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —à–µ–ª–ª–∫–æ–¥?
- –ö–∞–∫–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç (–≤–∫–ª—é—á–∞—è —Å–∫—Ä—ã—Ç—ã–µ –æ—Ç ps/top —á–µ—Ä–µ–∑ DKOM)?
- –ö–∞–∫–∏–µ —Å–µ—Ç–µ–≤—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –±—ã–ª–∏ –∞–∫—Ç–∏–≤–Ω—ã?
- –ï—Å—Ç—å –ª–∏ –∫–ª—é—á–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∏–ª–∏ credentials –≤ –ø–∞–º—è—Ç–∏?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# osxpmem (—Ç—Ä–µ–±—É–µ—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–Ω–æ–≥–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —è–¥—Ä–∞)
sudo osxpmem memory.aff4

# Volatility 3 –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–º–ø–∞
python3 vol.py -f memory.raw mac.pslist              # —Å–ø–∏—Å–æ–∫ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
python3 vol.py -f memory.raw mac.netstat             # —Å–µ—Ç–µ–≤—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
python3 vol.py -f memory.raw mac.malfind             # –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–≥–∏–æ–Ω—ã –ø–∞–º—è—Ç–∏
python3 vol.py -f memory.raw mac.bash                # bash history –∏–∑ –ø–∞–º—è—Ç–∏
```

> ‚ö†Ô∏è SIP –±–ª–æ–∫–∏—Ä—É–µ—Ç –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –º–µ—Ç–æ–¥–æ–≤ –ø–æ–ª—É—á–µ–Ω–∏—è RAM-–¥–∞–º–ø–∞. –ö–æ–º–º–µ—Ä—á–µ—Å–∫–∞—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: MacQuisition (Cellebrite).

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** osxpmem ¬∑ MacQuisition (Cellebrite) ¬∑ Volatility 3 (–∞–Ω–∞–ª–∏–∑)

---

### 11.2 –û—Ç–∫—Ä—ã—Ç—ã–µ —Ñ–∞–π–ª–æ–≤—ã–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã ‚è±Ô∏è üî¥

**–ß—Ç–æ —ç—Ç–æ:** –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –æ—Ç–∫—Ä—ã—Ç—ã—Ö —Ñ–∞–π–ª–æ–≤, —Å–æ–∫–µ—Ç–æ–≤, pipe'–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞. –û–¥–∏–Ω –∏–∑ –Ω–∞–∏–±–æ–ª–µ–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –Ω–∞ –∂–∏–≤–æ–π —Å–∏—Å—Ç–µ–º–µ.

**–ü—É—Ç—å:** —Ç–æ–ª—å–∫–æ live (`lsof` –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ kernel)

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö–∞–∫–∏–µ —Ñ–∞–π–ª—ã –æ—Ç–∫—Ä—ã—Ç—ã —É –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞?
- –ï—Å—Ç—å –ª–∏ –ø—Ä–æ—Ü–µ—Å—Å—ã —Å –æ—Ç–∫—Ä—ã—Ç—ã–º–∏ —É–¥–∞–ª—ë–Ω–Ω—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏ (fileless persistence)?
- –ö–∞–∫–∏–µ —Å–µ—Ç–µ–≤—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω—ã –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å (–∏ –∫–∞–∫–æ–π –ø—Ä–æ—Ü–µ—Å—Å –∏—Ö –¥–µ—Ä–∂–∏—Ç)?
- –ö—Ç–æ –¥–µ—Ä–∂–∏—Ç –æ—Ç–∫—Ä—ã—Ç—ã–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ñ–∞–π–ª –∏–ª–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
sudo lsof -n > lsof_full.txt
sudo lsof -i -n -P                   # —Ç–æ–ª—å–∫–æ —Å–µ—Ç–µ–≤—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
sudo lsof -p <PID>                   # —Ñ–∞–π–ª—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
lsof /path/to/file                   # –∫—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ–∞–π–ª

# –£–¥–∞–ª—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤—Å—ë –µ—â—ë –æ—Ç–∫—Ä—ã—Ç—ã (fileless –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä)
sudo lsof -n | grep "(deleted)"
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** UAC ¬∑ Aftermath

---

### 11.3 –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è ‚è±Ô∏è üü°

**–ß—Ç–æ —ç—Ç–æ:** –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤. 

**–ü—É—Ç—å:** —Ç–æ–ª—å–∫–æ live (—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –∏–∑ kernel —á–µ—Ä–µ–∑ `ps`)

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ï—Å—Ç—å –ª–∏ —É –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –Ω–µ—Ç–∏–ø–∏—á–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (C2-–∞–¥—Ä–µ—Å, –∫–ª—é—á–∏, –ø—É—Ç–∏)?
- –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –ª–∏ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (`DYLD_INSERT_LIBRARIES`, `PATH`, `LD_PRELOAD`)?
- –ö–∞–∫–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ —É–Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–æ –æ—Ç —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
printenv
env

# –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ (–ø–æ PID)
ps ewwp <PID>

# –ù–∞–π—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å—ã —Å DYLD_INSERT_LIBRARIES (–∏–Ω—ä–µ–∫—Ü–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫)
ps ewwx | grep "DYLD_INSERT_LIBRARIES"
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** Aftermath

---

## 12. External Devices

### 12.1 USB –∏ –≤–Ω–µ—à–Ω–∏–µ —Ç–æ–º–∞ üü°

**–ß—Ç–æ —ç—Ç–æ:** –ò—Å—Ç–æ—Ä–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è USB-—É—Å—Ç—Ä–æ–π—Å—Ç–≤. –í macOS –Ω–µ—Ç —Ä–µ–µ—Å—Ç—Ä–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –∫–∞–∫ –≤ Windows, –Ω–æ —Å–æ–±—ã—Ç–∏—è —Ñ–∏–∫—Å–∏—Ä—É—é—Ç—Å—è –≤ Unified Logs –∏ FSEvents. –ö–∞–∂–¥—ã–π –ø–æ–¥–∫–ª—é—á—ë–Ω–Ω—ã–π —Ç–æ–º —Å–æ–∑–¥–∞—ë—Ç —Å–≤–æ–π `.fseventsd`.

**–ü—É—Ç—å:** Unified Logs ¬∑ `/private/var/db/SystemConfiguration/com.apple.network.identification.plist`

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö–∞–∫–∏–µ USB-—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –ø–æ–¥–∫–ª—é—á–∞–ª–∏—Å—å –∫ —Å–∏—Å—Ç–µ–º–µ –∏ –∫–æ–≥–¥–∞?
- –ö–∞–∫–∏–µ –≤–Ω–µ—à–Ω–∏–µ —Ç–æ–º–∞ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–ª–∏—Å—å (—ç–∫—Å—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ USB)?
- –ï—Å—Ç—å –ª–∏ –∏—Å—Ç–æ—Ä–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è HID-—É—Å—Ç—Ä–æ–π—Å—Ç–≤ (rubber ducky, keystroke injectors)?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# –ò—Å—Ç–æ—Ä–∏—è —á–µ—Ä–µ–∑ Unified Logs (DiskArbitration ‚Äî —Å–æ–±—ã—Ç–∏—è –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
log show --last 30d \
  --predicate 'subsystem == "com.apple.DiskArbitration"' | \
  grep -i "appear\|disappear\|mount\|unmount"

# –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
diskutil list
system_profiler SPUSBDataType

# –í—Å–µ USB-—Å–æ–±—ã—Ç–∏—è –≤–∫–ª—é—á–∞—è HID
log show --last 30d \
  --predicate 'subsystem == "com.apple.iokit.IOUSBDevice"' | head -50
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** UAC ¬∑ Velociraptor

---

### 12.2 Bluetooth üü¢

**–ß—Ç–æ —ç—Ç–æ:** –ò—Å—Ç–æ—Ä–∏—è —Å–æ–ø—Ä—è–∂—ë–Ω–Ω—ã—Ö –∏ –ø–æ–¥–∫–ª—é—á–∞–≤—à–∏—Ö—Å—è Bluetooth-—É—Å—Ç—Ä–æ–π—Å—Ç–≤. –ü–æ–∑–≤–æ–ª—è–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å, –∫–∞–∫–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –±—ã–ª–∏ –≤ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π –±–ª–∏–∑–æ—Å—Ç–∏ –æ—Ç Mac –≤ –º–æ–º–µ–Ω—Ç –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞.

**–ü—É—Ç—å:** `/Library/Preferences/com.apple.Bluetooth.plist`

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö–∞–∫–∏–µ Bluetooth-—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Å–æ–ø—Ä—è–≥–∞–ª–∏—Å—å —Å —Å–∏—Å—Ç–µ–º–æ–π?
- –ö–æ–≥–¥–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–∑ –ø–æ–¥–∫–ª—é—á–∞–ª–æ—Å—å –∫–∞–∂–¥–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ?
- –ï—Å—Ç—å –ª–∏ –Ω–µ–∑–Ω–∞–∫–æ–º—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –≤ –∏—Å—Ç–æ—Ä–∏–∏ (—Ñ–∏–∑–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ –ø–æ—Å—Ç–æ—Ä–æ–Ω–Ω–µ–≥–æ)?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
plutil -p /Library/Preferences/com.apple.Bluetooth.plist

# Unified Logs ‚Äî —Å–æ–±—ã—Ç–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è/—Å–æ–ø—Ä—è–∂–µ–Ω–∏—è
log show --last 7d \
  --predicate 'subsystem contains "bluetooth"' | grep -i "connect\|pair\|device"
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** UAC ¬∑ Velociraptor

---

## 13. Email & Communication

### 13.1 Apple Mail üü°

**–ß—Ç–æ —ç—Ç–æ:** –•—Ä–∞–Ω–∏—Ç –ø–∏—Å—å–º–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ `.emlx` (–æ–¥–∏–Ω —Ñ–∞–π–ª = –æ–¥–Ω–æ –ø–∏—Å—å–º–æ). –ö—Ä–∏—Ç–∏—á–µ–Ω –ø—Ä–∏ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è—Ö —Å–ø–∏—Ä-—Ñ–∏—à–∏–Ω–≥–∞ –∏ —É—Ç–µ—á–µ–∫ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ –ø–æ—á—Ç—É.

**–ü—É—Ç–∏:**
```
~/Library/Mail/V10/           ‚Üê macOS Sonoma
~/Library/Mail/V9/            ‚Üê macOS Ventura
```

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ü–æ–ª—É—á–∞–ª –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ñ–∏—à–∏–Ω–≥–æ–≤—ã–µ –ø–∏—Å—å–º–∞ —Å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–º–∏ –≤–ª–æ–∂–µ–Ω–∏—è–º–∏?
- –û—Ç–ø—Ä–∞–≤–ª—è–ª–∏—Å—å –ª–∏ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ –ø–æ—á—Ç–µ (—É—Ç–µ—á–∫–∞)?
- –ö–∞–∫–∏–µ –≤–ª–æ–∂–µ–Ω–∏—è –æ—Ç–∫—Ä—ã–≤–∞–ª–∏—Å—å –∏ –æ—Ç–∫—É–¥–∞?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# –ü–∏—Å—å–º–∞ —Å –≤–ª–æ–∂–µ–Ω–∏—è–º–∏
find ~/Library/Mail/ -name "*.emlx" | xargs grep -l "attachment" 2>/dev/null

# –ü–æ–∏—Å–∫ –ø–æ –∫–ª—é—á–µ–≤–æ–º—É —Å–ª–æ–≤—É –≤ —Ç–µ–ª–µ –ø–∏—Å—å–º–∞
find ~/Library/Mail/ -name "*.emlx" | xargs grep -li "password\|invoice\|urgent" 2>/dev/null

# –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π (—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —è—â–∏–∫–æ–≤)
find ~/Library/Mail/ -type d -maxdepth 4
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** mac_apt (IMAIL)

---

### 13.2 Messages (iMessage / SMS) üü°

**–ß—Ç–æ —ç—Ç–æ:** –ò—Å—Ç–æ—Ä–∏—è iMessage –∏ SMS –≤ SQLite.

**–ü—É—Ç—å:** `~/Library/Messages/chat.db`

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ü–æ–ª—É—á–∞–ª –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–º–∏—à–∏–Ω–≥-—Å–æ–æ–±—â–µ–Ω–∏—è –∏–ª–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ —Å—Å—ã–ª–∫–∏?
- –ï—Å—Ç—å –ª–∏ –ø–µ—Ä–µ–ø–∏—Å–∫–∞, —Å–≤—è–∑–∞–Ω–Ω–∞—è —Å –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–º?
- –ö–∞–∫–∏–µ —Ñ–∞–π–ª—ã –ø–µ—Ä–µ–¥–∞–≤–∞–ª–∏—Å—å —á–µ—Ä–µ–∑ iMessage?
- –° –∫–∞–∫–∏–º–∏ –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏ –æ–±—â–∞–ª—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ –ø–µ—Ä–∏–æ–¥ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
sqlite3 ~/Library/Messages/chat.db \
  "SELECT datetime(date/1000000000 + 978307200, 'unixepoch') as time,
   is_from_me, text
   FROM message ORDER BY date DESC LIMIT 100;"

# –°–æ–æ–±—â–µ–Ω–∏—è —Å URL (–ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —Ñ–∏—à–∏–Ω–≥–æ–≤—ã–µ —Å—Å—ã–ª–∫–∏)
sqlite3 ~/Library/Messages/chat.db \
  "SELECT datetime(date/1000000000 + 978307200, 'unixepoch') as time,
   text FROM message WHERE text LIKE '%http%' ORDER BY date DESC;"

# –í–ª–æ–∂–µ–Ω–∏—è
sqlite3 ~/Library/Messages/chat.db \
  "SELECT filename, created_date, mime_type FROM attachment ORDER BY created_date DESC LIMIT 50;"
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** mac_apt (IMESSAGE)


---

## –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ 1: –ü–æ—Ä—è–¥–æ–∫ —Å–±–æ—Ä–∞

*–°–æ–±–∏—Ä–∞–π –æ—Ç –Ω–∞–∏–±–æ–ª–µ–µ –≤–æ–ª–∞—Ç–∏–ª—å–Ω—ã—Ö –∫ –Ω–∞–∏–º–µ–Ω–µ–µ*.

| –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –ê—Ä—Ç–µ—Ñ–∞–∫—Ç | –ü—Ä–∏—á–∏–Ω–∞ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ |
|:---------:|----------|-----------------------|
| 1 | –ñ–∏–≤—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã, —Å–µ—Ç–µ–≤—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è | –ò—Å—á–µ–∑–∞—é—Ç –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ |
| 2 | DNS-–∫—ç—à, ARP-—Ç–∞–±–ª–∏—Ü–∞ | –°–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ |
| 3 | RAM-–¥–∞–º–ø | –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ç–µ—Ä—è–µ—Ç—Å—è –ø—Ä–∏ –≤—ã–∫–ª—é—á–µ–Ω–∏–∏ |
| 4 | ES Framework live events (eslogger) | –¢–æ–ª—å–∫–æ live, —Ä–µ—Ç—Ä–æ—Å–ø–µ–∫—Ç–∏–≤–∞ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–∞ |
| 5 | Unified Logs | TTL 1‚Äì4 –Ω–µ–¥–µ–ª–∏, —Å—Ç–∞—Ä—ã–µ –≤—ã—Ç–µ—Å–Ω—è—é—Ç—Å—è –Ω–æ–≤—ã–º–∏ |
| 6 | FSEvents | –†–æ—Ç–∏—Ä—É—é—Ç—Å—è –ø—Ä–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–∏ –¥–∏—Å–∫–∞ |
| 7 | KnowledgeC / Biome | ~30 –¥–Ω–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ |
| 8 | Shell history | –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –∏–∑ shell |
| 9 | –ë—Ä–∞—É–∑–µ—Ä–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è | –ú–æ–∂–µ—Ç –±—ã—Ç—å –æ—á–∏—â–µ–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º |
| 10 | LaunchDaemons/Agents | –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã, –Ω–æ –º–µ–Ω—è—é—Ç—Å—è |
| 11 | Bodyfile / MACB Timestamps | –ò–∑–º–µ–Ω—è—é—Ç—Å—è –ø—Ä–∏ –¥–æ—Å—Ç—É–ø–µ –∫ —Ñ–∞–π–ª–∞–º |
| 12 | Quarantine DB | –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–∞, –Ω–µ –æ—á–∏—â–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ |
| 13 | TCC DB | –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–∞ |
| 14 | Crash Reports | –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã –¥–æ —Ä–æ—Ç–∞—Ü–∏–∏ |
| 15 | Install History, Keychain metadata | –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ –º–µ–Ω—è—é—Ç—Å—è |

---

## –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ 2: –ë—ã—Å—Ç—Ä—ã–π IR-—Å–∫—Ä–∏–ø—Ç

*–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø–µ—Ä–≤–∏—á–Ω–æ–≥–æ —Å–±–æ—Ä–∞. –ó–∞–ø—É—Å–∫–∞—Ç—å —Å –ø—Ä–∞–≤–∞–º–∏ root —Å USB-–Ω–∞–∫–æ–ø–∏—Ç–µ–ª—è.*

```bash
#!/bin/bash
# macOS Minimal IR Collection Script
# –ó–∞–ø—É—Å–∫–∞—Ç—å: sudo bash ir_collect.sh

OUTPUT="/Volumes/IR_USB/$(hostname)_$(date +%Y%m%d_%H%M%S)"
mkdir -p "$OUTPUT"

echo "[*] 1. Volatile: processes & network..."
ps aux > "$OUTPUT/processes.txt"
sudo lsof -i -n -P > "$OUTPUT/network_connections.txt"
netstat -an > "$OUTPUT/netstat.txt"
arp -a -n > "$OUTPUT/arp.txt"
sudo lsof -n > "$OUTPUT/lsof_full.txt"

echo "[*] 2. Security state..."
csrutil status > "$OUTPUT/sip_status.txt"
csrutil status --verbose >> "$OUTPUT/sip_status.txt" 2>/dev/null
spctl --status > "$OUTPUT/gatekeeper_status.txt"
fdesetup status > "$OUTPUT/filevault_status.txt"
systemextensionsctl list > "$OUTPUT/system_extensions.txt"
kextstat | grep -v com.apple > "$OUTPUT/third_party_kexts.txt"

echo "[*] 3. Persistence..."
sudo launchctl list > "$OUTPUT/launchctl_list.txt"
ls -la /Library/LaunchDaemons/ > "$OUTPUT/LaunchDaemons_list.txt"
ls -la /Library/LaunchAgents/ > "$OUTPUT/LaunchAgents_system.txt"
ls -la ~/Library/LaunchAgents/ > "$OUTPUT/LaunchAgents_user.txt"
sudo cp -r /Library/LaunchDaemons/ "$OUTPUT/LaunchDaemons_files/" 2>/dev/null
sudo cp -r ~/Library/LaunchAgents/ "$OUTPUT/LaunchAgents_user_files/" 2>/dev/null
crontab -l > "$OUTPUT/crontab.txt" 2>/dev/null
sfltool dumpbtm > "$OUTPUT/loginitems_btm.txt" 2>/dev/null

echo "[*] 4. User activity..."
cp ~/.zsh_history "$OUTPUT/zsh_history.txt" 2>/dev/null
cp ~/.bash_history "$OUTPUT/bash_history.txt" 2>/dev/null
cp -r ~/.zsh_sessions/ "$OUTPUT/zsh_sessions/" 2>/dev/null

echo "[*] 5. Authentication..."
dscl . -list /Users UniqueID > "$OUTPUT/users.txt"
dscl . -read /Groups/admin GroupMembership >> "$OUTPUT/users.txt"
cat ~/.ssh/authorized_keys > "$OUTPUT/authorized_keys.txt" 2>/dev/null
cat ~/.ssh/known_hosts > "$OUTPUT/known_hosts.txt" 2>/dev/null
sudo systemsetup -getremotelogin >> "$OUTPUT/sip_status.txt"

echo "[*] 6. Network config..."
ifconfig -a > "$OUTPUT/ifconfig.txt"
cat /etc/hosts > "$OUTPUT/hosts.txt"
scutil --dns > "$OUTPUT/dns.txt"

echo "[*] 7. System info..."
system_profiler SPSoftwareDataType SPHardwareDataType > "$OUTPUT/system_info.txt"
system_profiler SPUSBDataType > "$OUTPUT/usb_devices.txt"
diskutil list > "$OUTPUT/diskutil.txt"
tmutil listlocalsnapshots / > "$OUTPUT/apfs_snapshots.txt"

echo "[*] 8. Unified Logs (last 7 days)..."
sudo log collect --last 7d --output "$OUTPUT/system_logs.logarchive"

echo "[*] 9. TCC Database..."
sudo cp "/Library/Application Support/com.apple.TCC/TCC.db" \
  "$OUTPUT/TCC_system.db" 2>/dev/null
cp ~/Library/Application\ Support/com.apple.TCC/TCC.db \
  "$OUTPUT/TCC_user.db" 2>/dev/null

echo "[*] 10. Hashes: suspicious locations..."
find /tmp /var/tmp -type f -exec shasum -a 256 {} \; > "$OUTPUT/tmp_hashes.txt"
find ~/Library/LaunchAgents /Library/LaunchDaemons -name "*.plist" \
  -exec shasum -a 256 {} \; >> "$OUTPUT/tmp_hashes.txt"

echo "[+] Done. Output: $OUTPUT"
echo "[+] Size: $(du -sh "$OUTPUT" | awk '{print $1}')"
```

---

## –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ 3: –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –¢–∏–ø | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ |
|------------|-----|-----------|-------------|
| [**UAC**](https://github.com/tclahr/uac) | –°–±–æ—Ä—â–∏–∫ | –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Å–±–æ—Ä—â–∏–∫, –ª—é–±–æ–π Unix | –ë–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π, YAML-–ø—Ä–æ—Ñ–∏–ª–∏, S3/Azure |
| [**Aftermath**](https://github.com/jamf/aftermath) | –°–±–æ—Ä—â–∏–∫ + –∞–Ω–∞–ª–∏–∑ | –¢–æ–ª—å–∫–æ macOS 12+ | ES Framework, storyline, MDM-–¥–µ–ø–ª–æ–π |
| [**mac_apt**](https://github.com/ydkhatri/mac_apt) | –ü–∞—Ä—Å–µ—Ä | –ê–Ω–∞–ª–∏–∑ –æ–±—Ä–∞–∑–æ–≤ –∏ UAC-–∫–æ–ª–ª–µ–∫—Ü–∏–π | Safari, Chrome, KnowledgeC, TCC, Quarantine |
| [**APOLLO**](https://github.com/mac4n6/APOLLO) | –ü–∞—Ä—Å–µ—Ä | KnowledgeC.db ‚Üí timeline | Pattern of life, Sarah Edwards |
| [**Plaso**](https://plaso.readthedocs.io) | –°—É–ø–µ—Ätimeline | –°—É–ø–µ—Ätimeline –∏–∑ –≤—Å–µ—Ö –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ | `--parsers macosx`, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Timesketch |
| [**FSEventsParser**](https://github.com/dlcowen/FSEventsParser) | –ü–∞—Ä—Å–µ—Ä | `.fseventsd` ‚Üí CSV/JSON | –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É–¥–∞–ª—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã |
| [**Velociraptor**](https://velociraptor.app) | –ê–≥–µ–Ω—Ç + —Å–±–æ—Ä—â–∏–∫ | –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—ã–π —Å–±–æ—Ä –Ω–∞ —Ñ–ª–æ—Ç–µ | VQL-–∑–∞–ø—Ä–æ—Å—ã, web UI |
| [**The Sleuth Kit**](https://sleuthkit.org) | –ê–Ω–∞–ª–∏–∑ –§–° | Bodyfile, file system timeline | `fls`, `mactime` ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç –æ—Ç—Ä–∞—Å–ª–∏ |
| [**Volatility 3**](https://volatilityfoundation.org) | –ê–Ω–∞–ª–∏–∑ –ø–∞–º—è—Ç–∏ | RAM-–¥–∞–º–ø macOS | –ü–ª–∞–≥–∏–Ω—ã mac.pslist, mac.netstat, mac.malfind |
| [**Timeline Explorer**](https://ericzimmerman.github.io) | –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è | –ê–Ω–∞–ª–∏–∑ CSV –æ—Ç Plaso | Eric Zimmerman, —Ü–≤–µ—Ç–æ–≤–∞—è –∫–æ–¥–∏—Ä–æ–≤–∫–∞ |
| [**Timesketch**](https://timesketch.org) | –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è | –ö–æ–º–∞–Ω–¥–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ç–∞–π–º–ª–∞–π–Ω–∞ | Web UI, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Plaso |

---

## –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ 4: –°—Å—ã–ª–∫–∏

- [mac4n6.com ‚Äî Sarah Edwards](https://www.mac4n6.com) ‚Äî APOLLO, KnowledgeC, Unified Logs (–û—á–µ–Ω—å –∫–ª–∞—Å—Å–Ω—ã–π –±–ª–æ–≥)
- [SANS FOR518: Mac and iOS Forensic Analysis](https://www.sans.org/cyber-security-courses/mac-and-ios-forensic-analysis-and-incident-response/)
- [Jamf Aftermath](https://github.com/jamf/aftermath)
- [UAC ‚Äî tclahr](https://github.com/tclahr/uac)
- [mac_apt ‚Äî ydkhatri](https://github.com/ydkhatri/mac_apt)
- [FSEventsParser ‚Äî dlcowen](https://github.com/dlcowen/FSEventsParser)
- [ForensicArtifacts macOS definitions](https://github.com/ForensicArtifacts/artifacts)
- [Howard Oakley ‚Äî Eclectic Light](https://eclecticlight.co) ‚Äî APFS, Biome, Apple Silicon
- [Yogesh Khatri's forensic blog](https://www.swiftforensics.com) ‚Äî Apple Intelligence artifacts, KnowledgeC deep dives
- [SUMURI macOS 15 Sequoia for Examiners](https://sumuri.com/macos-15-sequoia-what-forensic-examiners-need-to-know/)
- [AboutDFIR macOS](https://aboutdfir.com/toolsandartifacts/macos/)

---

# –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ 5: –ü–æ–∫—Ä—ã—Ç–∏–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ –ø–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º

–°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫–∏–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã —Å–æ–±–∏—Ä–∞—é—Ç —Ç—Ä–∏ –æ—Å–Ω–æ–≤–Ω—ã—Ö macOS IR-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞:
**UAC** , **Aftermath** –∏ **Velociraptor**.

**–û–±–æ–∑–Ω–∞—á–µ–Ω–∏—è:**
- ‚úÖ ‚Äî —Å–æ–±–∏—Ä–∞–µ—Ç / –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç
- ‚ö†Ô∏è ‚Äî —á–∞—Å—Ç–∏—á–Ω–æ (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏–ª–∏ —Ç–æ–ª—å–∫–æ live-—Å–∏—Å—Ç–µ–º–∞)
- ‚ùå ‚Äî –Ω–µ —Å–æ–±–∏—Ä–∞–µ—Ç

---

## 1. Persistence

| –ê—Ä—Ç–µ—Ñ–∞–∫—Ç | UAC | Aftermath | Velociraptor | –ü—Ä–∏–º–µ—á–∞–Ω–∏—è |
|---|:---:|:---:|:---:|---|
| 1.1 LaunchDaemons | ‚úÖ | ‚úÖ | ‚úÖ | VR: `MacOS.Detection.Autoruns` |
| 1.2 LaunchAgents | ‚úÖ | ‚úÖ | ‚úÖ | VR: `MacOS.Detection.Autoruns` |
| 1.3 Login Items (BTM) | ‚úÖ | ‚ö†Ô∏è | ‚úÖ | Aftermath: —Ç–æ–ª—å–∫–æ live (`sfltool`). VR: `MacOS.Detection.Autoruns` |
| 1.4 Cron Jobs | ‚úÖ | ‚úÖ | ‚úÖ | VR: `MacOS.Detection.Autoruns` (cronTabGlob) |
| 1.5 Kernel / System Extensions | ‚úÖ | ‚úÖ | ‚úÖ | VR: `MacOS.Detection.Autoruns` + `System.Info` |
| 1.6 Login/Logout Hooks | ‚ùå | ‚ùå | ‚úÖ | VR: `MacOS.Detection.Autoruns` |
| 1.7 Emond | ‚ùå | ‚úÖ | ‚ùå | –†–µ–¥–∫–∏–π –∞—Ä—Ç–µ—Ñ–∞–∫—Ç; UAC –Ω–µ —Å–æ–±–∏—Ä–∞–µ—Ç |
| 1.8 At Jobs | ‚ùå | ‚ùå | ‚ùå | –ù–∏ –æ–¥–∏–Ω –Ω–µ —Å–æ–±–∏—Ä–∞–µ—Ç |

---

## 2. Process

| –ê—Ä—Ç–µ—Ñ–∞–∫—Ç | UAC | Aftermath | Velociraptor | –ü—Ä–∏–º–µ—á–∞–Ω–∏—è |
|---|:---:|:---:|:---:|---|
| 2.1 –°–ø–∏—Å–æ–∫ –∂–∏–≤—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ | ‚úÖ | ‚úÖ | ‚úÖ | Aftermath: TrueTree (–¥–µ—Ä–µ–≤–æ). VR: `MacOS.System.Processes` |
| 2.2 –•—ç—à–∏ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤ | ‚úÖ | ‚úÖ | ‚úÖ | VR: `MacOS.Search.FileFinder` + hash |
| 2.3 Endpoint Security Events | ‚ùå | ‚úÖ | ‚ö†Ô∏è | Aftermath: eslogger (create/exec/mmap). VR: —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ ES-—Å–æ–±—ã—Ç–∏—è |

---

## 3. Network

| –ê—Ä—Ç–µ—Ñ–∞–∫—Ç | UAC | Aftermath | Velociraptor | –ü—Ä–∏–º–µ—á–∞–Ω–∏—è |
|---|:---:|:---:|:---:|---|
| 3.1 –ê–∫—Ç–∏–≤–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è | ‚úÖ | ‚úÖ | ‚úÖ | VR: `MacOS.Network.Netstat` |
| 3.2 ARP-–∫—ç—à | ‚úÖ | ‚ùå | ‚ùå | –¢–æ–ª—å–∫–æ UAC `live_response/network` |
| 3.3 –¢–∞–±–ª–∏—Ü–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ | ‚úÖ | ‚ùå | ‚ùå | –¢–æ–ª—å–∫–æ UAC |
| 3.4 DNS-–∫—ç—à | ‚úÖ | ‚ùå | ‚ùå | –¢–æ–ª—å–∫–æ UAC |
| 3.5 –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ç–∏ / hosts | ‚úÖ | ‚úÖ | ‚úÖ | VR: `MacOS.Network.Netstat` + `System.Info` |
| 3.6 Wi-Fi –∏—Å—Ç–æ—Ä–∏—è | ‚úÖ | ‚ùå | ‚úÖ | Aftermath –Ω–µ —Å–æ–±–∏—Ä–∞–µ—Ç. VR: `MacOS.Network.RecentWifiNetworks` |
| 3.7 Firewall –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è | ‚úÖ | ‚ùå | ‚ùå | –¢–æ–ª—å–∫–æ UAC |
| 3.8 –ó–∞—Ö–≤–∞—Ç —Ç—Ä–∞—Ñ–∏–∫–∞ (PCAP) | ‚ùå | ‚úÖ | ‚ùå | Aftermath: tcpdump –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Å–±–æ—Ä—É. VR –Ω–µ –ø–∏—à–µ—Ç pcap |
| 3.x –°–µ—Ç–µ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π | ‚ùå | ‚ùå | ‚úÖ | VR: `MacOS.Applications.NetworkUsage` (netusage.sqlite) |

---

## 4. File System

| –ê—Ä—Ç–µ—Ñ–∞–∫—Ç | UAC | Aftermath | Velociraptor | –ü—Ä–∏–º–µ—á–∞–Ω–∏—è |
|---|:---:|:---:|:---:|---|
| 4.1 FSEvents (`.fseventsd`) | ‚úÖ | ‚ùå | ‚úÖ | **Aftermath –Ω–µ —Å–æ–±–∏—Ä–∞–µ—Ç!** VR: `MacOS.Forensics.FSEvents` |
| 4.2 Bodyfile (MACB timestamps) | ‚úÖ | ‚ùå | ‚ö†Ô∏è | VR: `MacOS.Search.FileFinder` (timestamps, –Ω–µ bodyfile) |
| 4.3 Quarantine Events DB | ‚úÖ | ‚úÖ | ‚úÖ | VR: `MacOS.Applications.QuarantineEvents` |
| 4.4 Spotlight Metadata | ‚ùå | ‚ùå | ‚ùå | –ù–∏ –æ–¥–∏–Ω –Ω–µ –ø–∞—Ä—Å–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ |
| 4.5 Extended Attributes (xattr) | ‚úÖ | ‚ùå | ‚ö†Ô∏è | VR: –º–æ–∂–Ω–æ —á–µ—Ä–µ–∑ `FileFinder` + xattr |

---

## 5. User Activity

| –ê—Ä—Ç–µ—Ñ–∞–∫—Ç | UAC | Aftermath | Velociraptor | –ü—Ä–∏–º–µ—á–∞–Ω–∏—è |
|---|:---:|:---:|:---:|---|
| 5.1 Shell History | ‚úÖ | ‚úÖ | ‚úÖ | VR: `MacOS.Detection.Autoruns` –≤–∫–ª—é—á–∞–µ—Ç shell profiles |
| 5.2 KnowledgeC Database | ‚úÖ | ‚úÖ | ‚úÖ | VR: `MacOS.Applications.KnowledgeC` |
| 5.3 Biome Data (macOS 13+) | ‚ùå | ‚ùå | ‚ùå | –ù–∏ –æ–¥–∏–Ω –Ω–µ —Å–æ–±–∏—Ä–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ |
| 5.4 Apple Intelligence (macOS 15+) | ‚ùå | ‚ùå | ‚ùå | –ù–æ–≤—ã–π –∞—Ä—Ç–µ—Ñ–∞–∫—Ç, –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –ø–æ–∫–∞ –Ω–µ—Ç |
| 5.5 Recent Items / MRU | ‚úÖ | ‚ùå | ‚ùå | –¢–æ–ª—å–∫–æ UAC |
| 5.6 Trash (–ö–æ—Ä–∑–∏–Ω–∞) | ‚ùå | ‚ùå | ‚ùå | –ù–∏ –æ–¥–∏–Ω |
| 5.7 Safari | ‚úÖ | ‚úÖ | ‚úÖ | VR: `MacOS.Applications.Safari` |
| 5.8 Chrome / Edge / Firefox | ‚úÖ | ‚úÖ | ‚úÖ | VR: `MacOS.Applications.Chrome` –∏ –¥—Ä. |

---

## 6. System Logs

| –ê—Ä—Ç–µ—Ñ–∞–∫—Ç | UAC | Aftermath | Velociraptor | –ü—Ä–∏–º–µ—á–∞–Ω–∏—è |
|---|:---:|:---:|:---:|---|
| 6.1 Unified Logs (`.logarchive`) | ‚úÖ | ‚ö†Ô∏è | ‚úÖ | UAC: –ø–æ–ª–Ω—ã–π –∞—Ä—Ö–∏–≤. Aftermath: —Ç–æ–ª—å–∫–æ –ø—Ä–µ–¥–∏–∫–∞—Ç–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞. VR: `MacOS.UnifiedLogHunter` |
| 6.2 Install Log | ‚úÖ | ‚ùå | ‚ùå | –¢–æ–ª—å–∫–æ UAC |
| 6.3 Crash Reports | ‚úÖ | ‚ùå | ‚ùå | –¢–æ–ª—å–∫–æ UAC |
| 6.4 ASL (Apple System Log) | ‚úÖ | ‚ùå | ‚ùå | –¢–æ–ª—å–∫–æ UAC |

---

## 7. Authentication

| –ê—Ä—Ç–µ—Ñ–∞–∫—Ç | UAC | Aftermath | Velociraptor | –ü—Ä–∏–º–µ—á–∞–Ω–∏—è |
|---|:---:|:---:|:---:|---|
| 7.1 TCC Database | ‚úÖ | ‚úÖ | ‚úÖ | VR: `MacOS.System.TCC` |
| 7.2 Keychain (–º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ) | ‚úÖ | ‚ùå | ‚ùå | –¢–æ–ª—å–∫–æ UAC; –ø–∞—Ä–æ–ª–∏ –Ω–µ –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è |
| 7.3 Sudo Logs | ‚úÖ | ‚ùå | ‚úÖ | VR: —á–µ—Ä–µ–∑ Unified Logs –ø—Ä–µ–¥–∏–∫–∞—Ç |
| 7.4 SSH –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è / –∫–ª—é—á–∏ | ‚úÖ | ‚ùå | ‚úÖ | VR: `MacOS.Search.FileFinder` |
| 7.5 –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–∏—Å—Ç–µ–º—ã | ‚úÖ | ‚úÖ | ‚úÖ | VR: `MacOS.Users` |
| 7.6 –ò—Å—Ç–æ—Ä–∏—è –≤—Ö–æ–¥–æ–≤ | ‚úÖ | ‚ùå | ‚úÖ | VR: —á–µ—Ä–µ–∑ Unified Logs |

---

## 8. Applications

| –ê—Ä—Ç–µ—Ñ–∞–∫—Ç | UAC | Aftermath | Velociraptor | –ü—Ä–∏–º–µ—á–∞–Ω–∏—è |
|---|:---:|:---:|:---:|---|
| 8.1 –ò—Å—Ç–æ—Ä–∏—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ü–û | ‚úÖ | ‚úÖ | ‚úÖ | VR: `MacOS.System.Info` + InstallHistory |
| 8.2 Code Signing / Gatekeeper | ‚úÖ | ‚úÖ | ‚úÖ | VR: `MacOS.Detection.Autoruns` –≤–∫–ª—é—á–∞–µ—Ç codesign |
| 8.3 CUPS (–∂—É—Ä–Ω–∞–ª –ø–µ—á–∞—Ç–∏) | ‚ùå | ‚ùå | ‚ùå | –ù–∏ –æ–¥–∏–Ω |

---

## 9. Cloud & Sync

| –ê—Ä—Ç–µ—Ñ–∞–∫—Ç | UAC | Aftermath | Velociraptor | –ü—Ä–∏–º–µ—á–∞–Ω–∏—è |
|---|:---:|:---:|:---:|---|
| 9.1 Time Machine | ‚ùå | ‚ùå | ‚ùå | –ù–∏–∫—Ç–æ –Ω–µ –ø–∞—Ä—Å–∏—Ç |
| 9.2 iCloud Drive | ‚ùå | ‚ùå | ‚ùå | ‚Äî |
| 9.3 Dropbox / GDrive / OneDrive | ‚ùå | ‚ùå | ‚ùå | ‚Äî |

---

## 10. Security State

| –ê—Ä—Ç–µ—Ñ–∞–∫—Ç | UAC | Aftermath | Velociraptor | –ü—Ä–∏–º–µ—á–∞–Ω–∏—è |
|---|:---:|:---:|:---:|---|
| 10.1 SIP —Å—Ç–∞—Ç—É—Å | ‚úÖ | ‚úÖ | ‚úÖ | VR: `MacOS.System.Info` |
| 10.2 Gatekeeper / XProtect | ‚úÖ | ‚úÖ | ‚úÖ | VR: `MacOS.Detection.Autoruns` |
| 10.3 FileVault —Å—Ç–∞—Ç—É—Å | ‚úÖ | ‚úÖ | ‚úÖ | VR: `MacOS.System.Info` |
| 10.4 Secure Boot / T2 / Apple Silicon | ‚úÖ | ‚ùå | ‚úÖ | VR: `System.Info` |

---

## 11. Memory & Volatile

| –ê—Ä—Ç–µ—Ñ–∞–∫—Ç | UAC | Aftermath | Velociraptor | –ü—Ä–∏–º–µ—á–∞–Ω–∏—è |
|---|:---:|:---:|:---:|---|
| 11.1 RAM-–¥–∞–º–ø | ‚ùå | ‚ùå | ‚ùå | –¢—Ä–µ–±—É–µ—Ç —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ |
| 11.2 –û—Ç–∫—Ä—ã—Ç—ã–µ —Ñ–∞–π–ª–æ–≤—ã–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã | ‚úÖ | ‚ùå | ‚úÖ | VR: `MacOS.System.Processes` (lsof-like) |
| 11.3 –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è | ‚úÖ | ‚úÖ | ‚ùå | UAC + Aftermath (env vars) |

---

## 12. External Devices

| –ê—Ä—Ç–µ—Ñ–∞–∫—Ç | UAC | Aftermath | Velociraptor | –ü—Ä–∏–º–µ—á–∞–Ω–∏—è |
|---|:---:|:---:|:---:|---|
| 12.1 USB / –≤–Ω–µ—à–Ω–∏–µ —Ç–æ–º–∞ | ‚úÖ | ‚ùå | ‚úÖ | VR: —á–µ—Ä–µ–∑ Unified Logs / `System.Info` |
| 12.2 Bluetooth | ‚úÖ | ‚ùå | ‚úÖ | VR: `MacOS.Network.Bluetooth` |

---

## 13. Communication

| –ê—Ä—Ç–µ—Ñ–∞–∫—Ç | UAC | Aftermath | Velociraptor | –ü—Ä–∏–º–µ—á–∞–Ω–∏—è |
|---|:---:|:---:|:---:|---|
| 13.1 Apple Mail | ‚ùå | ‚ùå | ‚ùå | –ù–∏ –æ–¥–∏–Ω |
| 13.2 Messages / iMessage | ‚ùå | ‚ùå | ‚ùå | –ù–∏ –æ–¥–∏–Ω |

---

## –°–≤–æ–¥–∫–∞ –ø–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º

| | UAC | Aftermath | Velociraptor |
|---|---|---|---|
| **–¢–∏–ø** | Bash-—Å–±–æ—Ä—â–∏–∫ | Swift IR framework | –ê–≥–µ–Ω—Ç–Ω—ã–π DFIR-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫ |
| **–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞** | Linux, macOS, \*BSD | macOS 12+ only | Windows, Linux, macOS |
| **–†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã** | Live + –æ—Ñ–ª–∞–π–Ω-–∞–Ω–∞–ª–∏–∑ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ | Live (MDM / CLI) | –ê–≥–µ–Ω—Ç (live) + offline collector |
| **–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã** | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –æ—Ö–≤–∞—Ç –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤, —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ñ–ª–∞–π–Ω, —á–∏—Ç–∞–µ—Ç—Å—è mac_apt | TrueTree, eslogger (ES Framework), PCAP, BTM | VQL-–≥–∏–±–∫–æ—Å—Ç—å, Autoruns, FSEvents-–ø–∞—Ä—Å–∏–Ω–≥, –æ—Ö–≤–∞—Ç —Å–µ—Ç–∏ |
| **–°–ª–µ–ø—ã–µ –ø—è—Ç–Ω–∞** | –ù–µ—Ç ES Framework, –Ω–µ—Ç PCAP | –ù–µ—Ç FSEvents, –Ω–µ—Ç ARP/DNS/Routing, –Ω–µ—Ç Wi-Fi –∏—Å—Ç–æ—Ä–∏–∏ | –ù–µ—Ç PCAP, –Ω–µ—Ç Keychain, –Ω–µ—Ç –ø–æ–ª–Ω–æ–≥–æ Bodyfile |
| **–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã** | Keychain –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ, Bodyfile, ASL, Crash Reports, Recent Items | eslogger (ES events), TrueTree, PCAP, Emond | Login/Logout Hooks, NetworkUsage, Bluetooth, FSEvents-–ø–∞—Ä—Å–∏–Ω–≥ |
| **–î–µ–ø–ª–æ–π** | –°–∫—Ä–∏–ø—Ç –±–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π | Pkg / MDM | –ê–≥–µ–Ω—Ç / offline collector |