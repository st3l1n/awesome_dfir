# macOS DFIR: –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ –¥–ª—è —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤

> **–í–µ—Ä—Å–∏—è:** 2.0 | **–ü—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å:** macOS 10.15 (Catalina) ‚Äî macOS 15 (Sequoia)  
> **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –±–∞–∑–∞ –∑–Ω–∞–Ω–∏–π –∫–æ–º–∞–Ω–¥—ã IR. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∏ —Å–±–æ—Ä–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ —Å –∂–∏–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –∏–ª–∏ —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –æ–±—Ä–∞–∑–∞.

---

## –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|----------|
| [1. Persistence](#1-persistence--–º–µ—Ö–∞–Ω–∏–∑–º—ã-–∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏—è) | –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫, LaunchDaemons/Agents, Login Items |
| [2. Process](#2-process--–ø—Ä–æ—Ü–µ—Å—Å—ã) | –ñ–∏–≤—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã, –¥–µ—Ä–µ–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, —Ö—ç—à–∏ |
| [3. Network](#3-network--—Å–µ—Ç–µ–≤—ã–µ-–∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã) | –°–æ–µ–¥–∏–Ω–µ–Ω–∏—è, ARP, DNS, –∫–æ–Ω—Ñ–∏–≥–∏ |
| [4. File System](#4-file-system--—Ñ–∞–π–ª–æ–≤–∞—è-—Å–∏—Å—Ç–µ–º–∞) | FSEvents, Bodyfile, Quarantine, Spotlight |
| [5. User Activity](#5-user-activity--–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è) | Shell history, KnowledgeC, –±—Ä–∞—É–∑–µ—Ä—ã, MRU |
| [6. System Logs](#6-system-logs--—Å–∏—Å—Ç–µ–º–Ω—ã–µ-–ª–æ–≥–∏) | Unified Logs, ASL, syslog |
| [7. Authentication](#7-authentication--–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è) | –õ–æ–≥–∏–Ω—ã, sudo, SSH, TCC, Keychain |
| [8. Applications](#8-applications--–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è) | –£—Å—Ç–∞–Ω–æ–≤–∫–∞, crash reports, CUPS |
| [9. Cloud & Sync](#9-cloud--sync) | iCloud, Time Machine, Dropbox |
| [10. Security State](#10-security-state--—Å–æ—Å—Ç–æ—è–Ω–∏–µ-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏) | SIP, Gatekeeper, FileVault, XProtect |
| [11. Memory & Volatile](#11-memory--volatile-data) | RAM, live-–¥–∞–Ω–Ω—ã–µ |
| [12. External Devices](#12-external-devices) | USB, –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–º–æ–≤ |
| [13. Email & Communication](#13-email--communication) | Mail.app, Slack, Messages |

---

## –û–±–æ–∑–Ω–∞—á–µ–Ω–∏—è

| –°–∏–º–≤–æ–ª | –ó–Ω–∞—á–µ–Ω–∏–µ |
|--------|----------|
| üî¥ | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ ‚Äî —Å–æ–±–∏—Ä–∞—Ç—å –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å |
| üü° | –í–∞–∂–Ω–æ ‚Äî —Å–æ–±–∏—Ä–∞—Ç—å –≤ —Ä–∞–º–∫–∞—Ö —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ IR |
| üü¢ | –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ ‚Äî –ø—Ä–∏ —É–≥–ª—É–±–ª—ë–Ω–Ω–æ–º —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏ |
| ‚ö†Ô∏è | –¢—Ä–µ–±—É–µ—Ç root / Full Disk Access |
| ‚è±Ô∏è | –í–æ–ª–∞—Ç–∏–ª—å–Ω—ã–π –∞—Ä—Ç–µ—Ñ–∞–∫—Ç ‚Äî –∏—Å—á–µ–∑–∞–µ—Ç –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ |
| üîê | –ú–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω (FileVault) |

---

## 1. Persistence ‚Äî –º–µ—Ö–∞–Ω–∏–∑–º—ã –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏—è

### 1.1 LaunchDaemons (—Å–∏—Å—Ç–µ–º–Ω—ã–µ)
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥

**–ß—Ç–æ —ç—Ç–æ:** –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ñ–æ–Ω–æ–≤—ã–µ —Å–ª—É–∂–±—ã macOS, –∑–∞–ø—É—Å–∫–∞–µ–º—ã–µ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–∏—Å—Ç–µ–º—ã —Å –ø—Ä–∞–≤–∞–º–∏ `root` –¥–æ –≤—Ö–æ–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –£–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ `launchd` ‚Äî –≥–ª–∞–≤–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å-–º–µ–Ω–µ–¥–∂–µ—Ä macOS (PID 1). –ö–∞–∂–¥—ã–π daemon –æ–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è plist-—Ñ–∞–π–ª–æ–º, —Å–æ–¥–µ—Ä–∂–∞—â–∏–º –ø—É—Ç—å –∫ –±–∏–Ω–∞—Ä—é, –∞—Ä–≥—É–º–µ–Ω—Ç—ã, —É—Å–ª–æ–≤–∏—è –∑–∞–ø—É—Å–∫–∞ –∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ. –õ–µ–≥–∏—Ç–∏–º–Ω—ã–µ daemon'—ã Apple –ø–æ–¥–ø–∏—Å–∞–Ω—ã –∏ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã –≤ `/System/Library/LaunchDaemons/` ‚Äî –∏—Ö –º–æ–∂–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏ –ø–µ—Ä–≤–∏—á–Ω–æ–º –∞–Ω–∞–ª–∏–∑–µ. –í—Å—ë –≤ `/Library/LaunchDaemons/` ‚Äî –∫–∞–Ω–¥–∏–¥–∞—Ç—ã –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É.

**–ü—É—Ç—å:**
```
/Library/LaunchDaemons/*.plist
/System/Library/LaunchDaemons/*.plist   # Apple-signed, –æ–±—ã—á–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å
```

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö–∞–∫–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–∏—Å—Ç–µ–º—ã —Å –ø—Ä–∞–≤–∞–º–∏ root?
- –ï—Å—Ç—å –ª–∏ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ daemon'—ã, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–º –ü–û?
- –ö–æ–≥–¥–∞ –±—ã–ª —Å–æ–∑–¥–∞–Ω/–∏–∑–º–µ–Ω—ë–Ω plist-—Ñ–∞–π–ª (–≤—Ä–µ–º–µ–Ω–Ω–∞ÃÅ—è –º–µ—Ç–∫–∞ = –≤–æ–∑–º–æ–∂–Ω–æ–µ –≤—Ä–µ–º—è –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏)?
- –ö–∞–∫–æ–π –±–∏–Ω–∞—Ä—å –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∏ —Å –∫–∞–∫–∏–º–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏?

**–ü–∞—Ä—Å–∏–Ω–≥ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ —á–∏—Ç–∞–µ–º–æ–≥–æ –≤—ã–≤–æ–¥–∞:**
```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö LaunchDaemons
sudo launchctl list | sort

# –ß—Ç–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ plist (–±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç ‚Üí XML)
plutil -p /Library/LaunchDaemons/com.example.daemon.plist

# –ü–∞–∫–µ—Ç–Ω–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤—Å–µ—Ö plist –≤ XML
find /Library/LaunchDaemons -name "*.plist" -exec plutil -convert xml1 {} \;

# –ü–æ–∏—Å–∫ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö (–Ω–µ Apple) daemon'–æ–≤
ls /Library/LaunchDaemons/ | grep -v "^com.apple"

# –ò–∑–≤–ª–µ—á—å –ø—É—Ç—å –∫ –±–∏–Ω–∞—Ä—é –∏–∑ –∫–∞–∂–¥–æ–≥–æ plist
for f in /Library/LaunchDaemons/*.plist; do
  echo "=== $f ==="; plutil -extract ProgramArguments xml1 -o - "$f" 2>/dev/null; done
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Å–±–æ—Ä–∞:**
| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –ö–æ–º–∞–Ω–¥–∞ |
|------------|---------|
| UAC | `./uac -p full /output` (live_response/system/) |
| Aftermath | `sudo aftermath -o /output` |
| –í—Ä—É—á–Ω—É—é | `cp -r /Library/LaunchDaemons/ /output/` |

---

### 1.2 LaunchAgents (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –∏ —Å–∏—Å—Ç–µ–º–Ω—ã–µ)
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥

**–ß—Ç–æ —ç—Ç–æ:** –ê–≥–µ–Ω—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ —É—Ä–æ–≤–Ω—è, –∑–∞–ø—É—Å–∫–∞–µ–º—ã–µ –ø—Ä–∏ –≤—Ö–æ–¥–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å–∏—Å—Ç–µ–º—É. –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç LaunchDaemons, —Ä–∞–±–æ—Ç–∞—é—Ç –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–Ω–µ root). –ù–∞–∏–±–æ–ª–µ–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–π –≤–µ–∫—Ç–æ—Ä persistence —É macOS-–º–∞–ª–≤–∞—Ä–∏: —Ñ–∞–π–ª plist –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–æ–ª–æ–∂–∏—Ç—å –≤ `~/Library/LaunchAgents/` –±–µ–∑ root-–ø—Ä–∞–≤. –°–æ–¥–µ—Ä–∂–∞—Ç –ø—É—Ç—å –∫ –ø—Ä–æ–≥—Ä–∞–º–º–µ, –∏–Ω—Ç–µ—Ä–≤–∞–ª –∑–∞–ø—É—Å–∫–∞, –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è.

**–ü—É—Ç—å:**
```
~/Library/LaunchAgents/*.plist          # —Ç–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
/Library/LaunchAgents/*.plist           # –≤—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
/System/Library/LaunchAgents/*.plist    # Apple-signed
```

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö–∞–∫–∏–µ –∞–≥–µ–Ω—Ç—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –ø—Ä–∏ –≤—Ö–æ–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è?
- –ï—Å—Ç—å –ª–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ LaunchAgents, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏–µ persistence –±–µ–∑ root-–ø—Ä–∞–≤?
- –ö–∞–∫–æ–π –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–ø—É—Å–∫–∞–µ—Ç –∞–≥–µ–Ω—Ç –∏ —Å –∫–∞–∫–∏–º–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏ (curl/bash/python = –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ)?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
launchctl list

# –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –∞–≥–µ–Ω—Ç–∞
plutil -p ~/Library/LaunchAgents/com.suspicious.agent.plist

# –ü–æ–∏—Å–∫ –∞–≥–µ–Ω—Ç–æ–≤ —Å —Å–µ—Ç–µ–≤—ã–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ –∏–ª–∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä–∞–º–∏
grep -r "curl\|bash\|python\|ruby\|perl\|wget\|nc " \
  /Library/LaunchAgents/ ~/Library/LaunchAgents/

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ –±–∏–Ω–∞—Ä—è
codesign -dvvv $(defaults read ~/Library/LaunchAgents/com.example.plist \
  ProgramArguments 2>/dev/null | awk 'NR==2{print $1}')
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Å–±–æ—Ä–∞:**
| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –ö–æ–º–∞–Ω–¥–∞ |
|------------|---------|
| UAC | `./uac -p full /output` |
| Aftermath | `sudo aftermath -o /output` (–º–æ–¥—É–ª—å persistence) |
| –í—Ä—É—á–Ω—É—é | `find / -name "*.plist" -path "*/LaunchAgents/*" 2>/dev/null` |

---

### 1.3 Login Items
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü°

**–ß—Ç–æ —ç—Ç–æ:** –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ —Å–∫—Ä–∏–ø—Ç—ã, –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –Ω–∞ –∑–∞–ø—É—Å–∫ –ø—Ä–∏ –≤—Ö–æ–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å–∏—Å—Ç–µ–º—É —á–µ—Ä–µ–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º macOS. –£–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ System Settings ‚Üí General ‚Üí Login Items. –í macOS 13+ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ `SMAppService` –∏ —Ñ–∞–π–ª—ã `.btm`. –î–æ macOS 13 ‚Äî plist –≤ `Preferences`. –ú–µ–Ω–µ–µ —Å–∫—Ä—ã—Ç–Ω—ã–π –º–µ—Ç–æ–¥ persistence, —á–µ–º LaunchAgents, –Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–º –ü–û —Å UX-–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–µ–π (RAT, stalkerware).

**–ü—É—Ç—å:**
```
~/Library/Application Support/com.apple.backgroundtaskmanagementagent/backgrounditems.btm   # macOS 13+
/Library/Application Support/com.apple.backgroundtaskmanagementagent/backgrounditems.btm
~/Library/Preferences/com.apple.loginitems.plist   # legacy macOS < 13
```

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö–∞–∫–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –Ω–∞ –∑–∞–ø—É—Å–∫ –ø—Ä–∏ –≤—Ö–æ–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è?
- –î–æ–±–∞–≤–ª—è–ª–æ –ª–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ –ü–û —Å–µ–±—è –≤ Login Items –¥–ª—è –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# macOS 13+ —á–µ—Ä–µ–∑ sfltool
sfltool dumpbtm

# Legacy (macOS < 13)
plutil -p ~/Library/Preferences/com.apple.loginitems.plist
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Å–±–æ—Ä–∞:**
| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –ö–æ–º–∞–Ω–¥–∞ |
|------------|---------|
| Aftermath | –í–∫–ª—é—á–µ–Ω–æ –≤ –º–æ–¥—É–ª—å persistence |
| –í—Ä—É—á–Ω—É—é | `sfltool dumpbtm > loginitems.txt` |

---

### 1.4 Cron Jobs
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü°

**–ß—Ç–æ —ç—Ç–æ:** –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π Unix-–ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á. –í macOS –º–µ–Ω–µ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω, —á–µ–º LaunchAgents/Daemons, –Ω–æ –∞–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞–º–∏ –∏–º–µ–Ω–Ω–æ –ø–æ—Ç–æ–º—É, —á—Ç–æ —á–∞—Å—Ç–æ –æ—Å—Ç–∞—ë—Ç—Å—è –±–µ–∑ –≤–Ω–∏–º–∞–Ω–∏—è –ø—Ä–∏ IR. Cron –∑–∞–¥–∞—á–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–∞—Ö —Å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–æ–º `–º–∏–Ω—É—Ç–∞ —á–∞—Å –¥–µ–Ω—å –º–µ—Å—è—Ü –¥–µ–Ω—å_–Ω–µ–¥–µ–ª–∏ –∫–æ–º–∞–Ω–¥–∞`. –°–∏—Å—Ç–µ–º–Ω—ã–π crontab ‚Äî `/etc/crontab`, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ ‚Äî `/private/var/at/tabs/<username>`.

**–ü—É—Ç—å:**
```
/private/var/at/tabs/             # –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ crontabs
/etc/crontab                      # —Å–∏—Å—Ç–µ–º–Ω—ã–π crontab
/etc/periodic/daily|weekly|monthly/
```

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ï—Å—Ç—å –ª–∏ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏, –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–æ–º?
- –ö–∞–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é, –∫–æ–≥–¥–∞ –∏ –æ—Ç –∫–∞–∫–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# –¢–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
crontab -l

# –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (root)
sudo ls /private/var/at/tabs/
sudo cat /private/var/at/tabs/<username>

# –°–∏—Å—Ç–µ–º–Ω—ã–µ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏
ls -la /etc/periodic/daily/ /etc/periodic/weekly/ /etc/periodic/monthly/
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Å–±–æ—Ä–∞:**
| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –ö–æ–º–∞–Ω–¥–∞ |
|------------|---------|
| UAC | –í–∫–ª—é—á–µ–Ω–æ –≤ `live_response/system/` |
| –í—Ä—É—á–Ω—É—é | `crontab -l > cron_user.txt` |

---

### 1.5 System Extensions / Kernel Extensions
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥

**–ß—Ç–æ —ç—Ç–æ:** –ú–æ–¥—É–ª–∏, —Ä–∞—Å—à–∏—Ä—è—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —è–¥—Ä–∞ macOS. Kernel Extensions (`.kext`) ‚Äî —É—Å—Ç–∞—Ä–µ–≤—à–∏–π –º–µ—Ö–∞–Ω–∏–∑–º, —Ä–∞–±–æ—Ç–∞—é—â–∏–π –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ —è–¥—Ä–∞ —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º–∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—è–º–∏. System Extensions (macOS 10.15+) ‚Äî –±–æ–ª–µ–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –∑–∞–º–µ–Ω–∏—Ç–µ–ª—å, —Ä–∞–±–æ—Ç–∞—é—â–∏–π –≤ user space. –ù–µ–ª–µ–≥–∏—Ç–∏–º–Ω—ã–µ kext ‚Äî –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–µ –º–µ—Å—Ç–æ –¥–ª—è —Ä—É—Ç–∫–∏—Ç–æ–≤. –î–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ unsigned kext —Ç—Ä–µ–±—É–µ—Ç—Å—è –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ SIP, —á—Ç–æ —Å–∞–º–æ –ø–æ —Å–µ–±–µ —è–≤–ª—è–µ—Ç—Å—è —Å–∏–≥–Ω–∞–ª–æ–º –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏.

**–ü—É—Ç—å:**
```
/Library/SystemExtensions/         # macOS 10.15+ System Extensions
/Library/Extensions/*.kext         # legacy Kernel Extensions
/System/Library/Extensions/*.kext  # Apple kexts (–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å)
```

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ï—Å—Ç—å –ª–∏ –Ω–µ–ª–µ–≥–∏—Ç–∏–º–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —è–¥—Ä–∞ (—Ä—É—Ç–∫–∏—Ç—ã, –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ –¥—Ä–∞–π–≤–µ—Ä—ã)?
- –ö–∞–∫–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –ø–æ–ª—É—á–∏–ª–∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ç–∏, USB, —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ?
- –ö–æ–≥–¥–∞ –±—ã–ª–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# –°–ø–∏—Å–æ–∫ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö kexts (—Ç–æ–ª—å–∫–æ —Å—Ç–æ—Ä–æ–Ω–Ω–∏–µ)
kextstat | grep -v com.apple

# System Extensions (macOS 10.15+)
systemextensionsctl list

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ kext
codesign -dvvv /Library/Extensions/Suspicious.kext
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Å–±–æ—Ä–∞:**
| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –ö–æ–º–∞–Ω–¥–∞ |
|------------|---------|
| Aftermath | –í–∫–ª—é—á–µ–Ω–æ (–º–æ–¥—É–ª—å systemRecon) |
| UAC | `live_response/system/` |
| –í—Ä—É—á–Ω—É—é | `kextstat > kextstat.txt; systemextensionsctl list > sysext.txt` |

---

### 1.6 Login/Logout Hooks
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢

**–ß—Ç–æ —ç—Ç–æ:** –£—Å—Ç–∞—Ä–µ–≤—à–∏–π –º–µ—Ö–∞–Ω–∏–∑–º macOS, –ø–æ–∑–≤–æ–ª—è—é—â–∏–π –∑–∞–ø—É—Å–∫–∞—Ç—å shell-—Å–∫—Ä–∏–ø—Ç –ø—Ä–∏ –≤—Ö–æ–¥–µ –∏–ª–∏ –≤—ã—Ö–æ–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ —Å–∏—Å—Ç–µ–º—ã. –ü—Ä–æ–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ plist —á–µ—Ä–µ–∑ `defaults write`. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Ä–µ–¥–∫–∏—Ö —Å–ª—É—á–∞—è—Ö APT-–∞—Ç–∞–∫ –Ω–∞ macOS –¥–ª—è persistence —Å –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ–º –ø—Ä–∏ –∫–∞–∂–¥–æ–º –ª–æ–≥–∏–Ω–µ.

**–ü—É—Ç—å:**
```
/private/var/root/Library/Preferences/com.apple.loginwindow.plist
```

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
sudo defaults read /private/var/root/Library/Preferences/com.apple.loginwindow.plist
# –ò—Å–∫–∞—Ç—å –∫–ª—é—á–∏: LoginHook, LogoutHook
```

---

### 1.7 Emond (Event Monitor Daemon)
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢

**–ß—Ç–æ —ç—Ç–æ:** –°–∏—Å—Ç–µ–º–Ω—ã–π –¥–µ–º–æ–Ω –¥–ª—è —Ä–µ–∞–∫—Ü–∏–∏ –Ω–∞ —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è (—Å—Ç–∞—Ä—Ç —Å–∏—Å—Ç–µ–º—ã, –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–º–∞, –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–∞). –ü—Ä–∞–≤–∏–ª–∞ –æ–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ plist-—Ñ–∞–π–ª–∞—Ö –∏ –º–æ–≥—É—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –ø—Ä–∏ –Ω–∞—Å—Ç—É–ø–ª–µ–Ω–∏–∏ —Å–æ–±—ã—Ç–∏—è. –ò–∑–≤–µ—Å—Ç–µ–Ω –∫–∞–∫ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤–µ–∫—Ç–æ—Ä persistence: –º–∞–ª–≤–∞—Ä—å —Å–æ–∑–¥–∞—ë—Ç –ø—Ä–∞–≤–∏–ª–æ, –∫–æ—Ç–æ—Ä–æ–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–∏ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Å–æ–±—ã—Ç–∏—è—Ö. –í macOS Ventura+ Emond —É—Å—Ç–∞—Ä–µ–ª, –Ω–æ —Ñ–∞–π–ª—ã –ø—Ä–∞–≤–∏–ª –º–æ–≥—É—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è.

**–ü—É—Ç—å:**
```
/etc/emond.d/rules/*.plist
/private/var/db/emondClients/
```

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
ls /etc/emond.d/rules/
plutil -p /etc/emond.d/rules/<rule>.plist
```

---

### 1.8 At Jobs
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢

**–ß—Ç–æ —ç—Ç–æ:** –ú–µ—Ö–∞–Ω–∏–∑–º –æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω–æ–≥–æ –æ—Ç–ª–æ–∂–µ–Ω–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á (–∞–Ω–∞–ª–æ–≥ `at` –≤ Linux). –í macOS —Ä–µ–¥–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏, –ø–æ—ç—Ç–æ–º—É –ª—é–±–∞—è –∑–∞–¥–∞—á–∞ –≤ `/private/var/at/jobs/` ‚Äî –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏.

**–ü—É—Ç—å:**
```
/private/var/at/jobs/
```

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
atq           # —Å–ø–∏—Å–æ–∫ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–¥–∞—á
sudo ls /private/var/at/jobs/
```

---

## 2. Process ‚Äî –ø—Ä–æ—Ü–µ—Å—Å—ã

### 2.1 –°–ø–∏—Å–æ–∫ –∂–∏–≤—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ ‚è±Ô∏è
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥

**–ß—Ç–æ —ç—Ç–æ:** –°–Ω–∞–ø—à–æ—Ç –≤—Å–µ—Ö –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –≤ –º–æ–º–µ–Ω—Ç —Å–±–æ—Ä–∞. –í–∫–ª—é—á–∞–µ—Ç –∏–º—è –ø—Ä–æ—Ü–µ—Å—Å–∞, PID, PPID (—Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å), –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CPU/RAM, –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É —Å –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏ –∏ –ø—É—Ç—å –∫ –±–∏–Ω–∞—Ä—é. –ü–µ—Ä–≤—ã–π —à–∞–≥ –ª—é–±–æ–≥–æ IR –Ω–∞ –∂–∏–≤–æ–π —Å–∏—Å—Ç–µ–º–µ ‚Äî –∫—Ä–∏—Ç–∏—á–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–æ –ª—é–±—ã—Ö –¥—Ä—É–≥–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π. –ü—Ä–æ—Ü–µ—Å—Å—ã –±–µ–∑ –±–∏–Ω–∞—Ä—è –Ω–∞ –¥–∏—Å–∫–µ (`deleted` –≤ `/proc`) ‚Äî –ø—Ä–∏–∑–Ω–∞–∫ fileless malware.

**–ò—Å—Ç–æ—á–Ω–∏–∫:** –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π (–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–º—è—Ç—å)

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö–∞–∫–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –∑–∞–ø—É—â–µ–Ω—ã –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å? –ï—Å—Ç—å –ª–∏ –∞–Ω–æ–º–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞?
- –ï—Å—Ç—å –ª–∏ –ø—Ä–æ—Ü–µ—Å—Å—ã –±–µ–∑ –±–∏–Ω–∞—Ä—è –Ω–∞ –¥–∏—Å–∫–µ (fileless malware, –∏–Ω—ä–µ–∫—Ü–∏—è –∫–æ–¥–∞)?
- –ö–∞–∫–æ–µ –¥–µ—Ä–µ–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (parent ‚Üí child)? –ê–Ω–æ–º–∞–ª—å–Ω–∞—è —Ü–µ–ø–æ—á–∫–∞ ‚Äî –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∞—Ç–∞–∫–∏.
- –ö–∞–∫–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã —Å–ª—É—à–∞—é—Ç —Å–µ—Ç–µ–≤—ã–µ –ø–æ—Ä—Ç—ã –∏–ª–∏ –∏–º–µ—é—Ç –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è?
- –ï—Å—Ç—å –ª–∏ –ø—Ä–æ—Ü–µ—Å—Å—ã, –∑–∞–ø—É—â–µ–Ω–Ω—ã–µ –æ—Ç root –±–µ–∑ –≤–∏–¥–∏–º–æ–π –ø—Ä–∏—á–∏–Ω—ã?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Å –¥–µ—Ç–∞–ª—è–º–∏
ps aux

# –î–µ—Ä–µ–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (parent-child)
ps auxf
pstree -a

# –ü—Ä–æ—Ü–µ—Å—Å—ã —Å —Å–µ—Ç–µ–≤—ã–º–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è–º–∏
sudo lsof -i -n -P

# –ê–Ω–æ–º–∞–ª—å–Ω—ã–µ: –ø—Ä–æ—Ü–µ—Å—Å—ã –∏–∑ –Ω–µ—Ç–∏–ø–∏—á–Ω—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
ps aux | grep -E "/tmp/|/var/tmp/|/Users/.*/Library/|/private/tmp"

# –•—ç—à–∏ –±–∏–Ω–∞—Ä–µ–π –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
ps -eo pid,comm= | while read pid comm; do
  exe=$(ls -la /proc/$pid/exe 2>/dev/null | awk '{print $NF}')
  [ -f "$exe" ] && printf "%s\t%s\t%s\n" "$pid" "$comm" "$(shasum -a 256 "$exe" | awk '{print $1}')"
done
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Å–±–æ—Ä–∞:**
| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –ö–æ–º–∞–Ω–¥–∞ |
|------------|---------|
| UAC | `live_response/process/` (ps, lsof, top, pstree) |
| Aftermath | TrueTree + eslogger (–≤–∫–ª—é—á–µ–Ω–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) |
| –í—Ä—É—á–Ω—É—é | `ps aux > processes.txt && sudo lsof -n > lsof.txt` |

---

### 2.2 –•—ç—à–∏ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥

**–ß—Ç–æ —ç—Ç–æ:** –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ —Ö—ç—à–∏ (MD5/SHA1/SHA256) –≤—Å–µ—Ö –∏—Å–ø–æ–ª–Ω—è–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤ –Ω–∞ –¥–∏—Å–∫–µ. –ü–æ–∑–≤–æ–ª—è—é—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å —Ñ–∞–π–ª–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –µ–≥–æ –∏–º–µ–Ω–∏ –∏ —Å—Ä–∞–≤–Ω–∏—Ç—å —Å –∏–∑–≤–µ—Å—Ç–Ω—ã–º–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–º–∏ —Ö—ç—à–∞–º–∏ (Threat Intelligence, VirusTotal) –∏–ª–∏ —Å —ç—Ç–∞–ª–æ–Ω–Ω—ã–º–∏ —Ö—ç—à–∞–º–∏ —á–∏—Å—Ç–æ–π —Å–∏—Å—Ç–µ–º—ã. –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ö—ç—à–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –±–∏–Ω–∞—Ä—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `/bin/ls`) = trojanized binary.

**–ü—É—Ç—å:**
```
/usr/bin/, /usr/sbin/, /Applications/
/Library/, ~/Library/
/tmp/, /var/tmp/    # –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Å—Ç–∞
```

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –°–æ–≤–ø–∞–¥–∞—é—Ç –ª–∏ —Ö—ç—à–∏ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –±–∏–Ω–∞—Ä–µ–π —Å —ç—Ç–∞–ª–æ–Ω–Ω—ã–º–∏ (trojanized binaries)?
- –ï—Å—Ç—å –ª–∏ –∏–∑–≤–µ—Å—Ç–Ω—ã–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ —Ö—ç—à–∏ (—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å Threat Intelligence / VirusTotal)?
- –ö–∞–∫–∏–µ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã –≤ –Ω–µ—Ç–∏–ø–∏—á–Ω—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è—Ö (/tmp, /Users)?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# SHA256 —Ö—ç—à–∏ –≤—Å–µ—Ö –∏—Å–ø–æ–ª–Ω—è–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤ –≤ /usr
find /usr/bin /usr/sbin -type f -exec shasum -a 256 {} \; > hashes_system.txt

# –í—Å–µ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–µ –≤ –Ω–µ—Ç–∏–ø–∏—á–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö
find /tmp /var/tmp ~/Library -type f -perm +111 \
  -exec shasum -a 256 {} \; 2>/dev/null > hashes_suspicious_locations.txt

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ –∫–æ–¥–∞
codesign -dvvv /path/to/suspicious/binary

# –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è Apple-–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
codesign --verify --verbose=4 /usr/bin/suspicious
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Å–±–æ—Ä–∞:**
| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –ö–æ–º–∞–Ω–¥–∞ |
|------------|---------|
| UAC | `hash_executables/hash_executables.yaml` |
| Aftermath | –í–∫–ª—é—á–µ–Ω–æ (—á–µ—Ä–µ–∑ ES framework) |

---

### 2.3 Endpoint Security Events (live) ‚è±Ô∏è
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ ‚ö†Ô∏è

**–ß—Ç–æ —ç—Ç–æ:** Apple Endpoint Security Framework (macOS 10.15+) ‚Äî –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π API —è–¥—Ä–∞ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏. `eslogger` ‚Äî CLI-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —ç—Ç–∏–º API. –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è: —Å–æ–∑–¥–∞–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ (`create`), –∑–∞–ø—É—Å–∫ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (`exec`), –º–∞–ø–ø–∏–Ω–≥ –ø–∞–º—è—Ç–∏ (`mmap`), –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (`mount`), –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–∞–≤ (`setuid`) –∏ –¥—Ä—É–≥–∏–µ. –î–∞–Ω–Ω—ã–µ –¥–æ—Å—Ç—É–ø–Ω—ã **—Ç–æ–ª—å–∫–æ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏** ‚Äî –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Ç–µ—Ä—è—é—Ç—Å—è.

**–ò—Å—Ç–æ—á–Ω–∏–∫:** Apple Endpoint Security Framework (—Ç–æ–ª—å–∫–æ live)

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö–∞–∫–∏–µ —Ñ–∞–π–ª—ã —Å–æ–∑–¥–∞—ë—Ç/–∏–∑–º–µ–Ω—è–µ—Ç –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å?
- –ö–∞–∫–∏–µ –Ω–æ–≤—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è (exec events) ‚Äî —Ü–µ–ø–æ—á–∫–∞ –∞—Ç–∞–∫–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏?
- –ï—Å—Ç—å –ª–∏ mmap-–≤—ã–∑–æ–≤—ã —Å –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏ (shellcode injection)?
- –ö–∞–∫–∏–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (setuid) –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ create/exec/mmap (—Ç—Ä–µ–±—É–µ—Ç Full Disk Access –¥–ª—è Terminal)
sudo eslogger create exec mmap | tee eslog.json

# –° –∑–∞–ø–∏—Å—å—é –≤ —Ñ–∞–π–ª
sudo eslogger create exec mmap write setuid > /Volumes/USB/eslog_$(date +%Y%m%dT%H%M%S).json

# –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –ø—Ä–æ—Ü–µ—Å—Å—É
sudo eslogger create exec | jq 'select(.process.executable.path | contains("suspicious"))'
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Å–±–æ—Ä–∞:**
| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –ö–æ–º–∞–Ω–¥–∞ |
|------------|---------|
| Aftermath | –í–∫–ª—é—á–µ–Ω–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (create, exec, mmap) |
| –í—Ä—É—á–Ω—É—é | `sudo eslogger <event_types>` |

---

## 3. Network ‚Äî —Å–µ—Ç–µ–≤—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã

### 3.1 –ê–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Ç–µ–≤—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è ‚è±Ô∏è
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥

**–ß—Ç–æ —ç—Ç–æ:** –¢–∞–±–ª–∏—Ü–∞ –≤—Å–µ—Ö —Ç–µ–∫—É—â–∏—Ö —Å–µ—Ç–µ–≤—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π —Å–∏—Å—Ç–µ–º—ã: TCP/UDP —Å–æ–∫–µ—Ç—ã, –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–µ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –ø—Ä–æ—Ü–µ—Å—Å–∞–º. –§—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π –∞—Ä—Ç–µ—Ñ–∞–∫—Ç –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è C2-–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏, reverse shell, data exfiltration. –°–æ–±–∏—Ä–∞–µ—Ç—Å—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ ‚Äî —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Ä–∞–∑—Ä—ã–≤–∞—é—Ç—Å—è –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.

**–ò—Å—Ç–æ—á–Ω–∏–∫:** –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö–∞–∫–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –∏–º–µ—é—Ç –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ IP?
- –ï—Å—Ç—å –ª–∏ C2-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (–Ω–µ—Ç–∏–ø–∏—á–Ω—ã–µ –ø–æ—Ä—Ç—ã, –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ IP/–¥–æ–º–µ–Ω—ã)?
- –ï—Å—Ç—å –ª–∏ reverse shell (—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –≤–æ –≤–Ω–µ—à–Ω–∏–π –º–∏—Ä —Å –Ω–µ—Ç–∏–ø–∏—á–Ω—ã–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º)?
- –ù–∞ –∫–∞–∫–∏—Ö –ø–æ—Ä—Ç–∞—Ö —Å–ª—É—à–∞–µ—Ç —Å–∏—Å—Ç–µ–º–∞ (–Ω–æ–≤—ã–µ listening ports = –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π backdoor)?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# –í—Å–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –∏–º–µ–Ω–∞–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
sudo lsof -i -n -P

# –¢–æ–ª—å–∫–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ TCP
netstat -an | grep ESTABLISHED

# Listening ports (backdoors)
sudo lsof -iTCP -sTCP:LISTEN -n -P

# –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤—ã–≤–æ–¥: –ø—Ä–æ—Ü–µ—Å—Å + —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
sudo lsof -i -n -P | awk 'NR==1 || /ESTABLISHED|LISTEN/' | \
  awk '{printf "%-20s %-10s %-50s\n", $1, $2, $9}'
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Å–±–æ—Ä–∞:**
| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –ö–æ–º–∞–Ω–¥–∞ |
|------------|---------|
| UAC | `live_response/network/` |
| Aftermath | –í–∫–ª—é—á–µ–Ω–æ + PCAP —á–µ—Ä–µ–∑ tcpdump |
| –í—Ä—É—á–Ω—É—é | `sudo lsof -i -n > network_connections.txt` |

---

### 3.2 ARP-–∫—ç—à ‚è±Ô∏è
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü°

**–ß—Ç–æ —ç—Ç–æ:** –¢–∞–±–ª–∏—Ü–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è IP-–∞–¥—Ä–µ—Å–æ–≤ MAC-–∞–¥—Ä–µ—Å–∞–º –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏. –ü–æ–∑–≤–æ–ª—è–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å, —Å –∫–∞–∫–∏–º–∏ —Ö–æ—Å—Ç–∞–º–∏ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏ –Ω–µ–¥–∞–≤–Ω–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞–ª–∞ —Å–∏—Å—Ç–µ–º–∞. –ê–Ω–æ–º–∞–ª—å–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –º–æ–≥—É—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ ARP-—Å–ø—É—Ñ–∏–Ω–≥.

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
arp -a -n
```

---

### 3.3 –¢–∞–±–ª–∏—Ü–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ ‚è±Ô∏è
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü°

**–ß—Ç–æ —ç—Ç–æ:** –ü—Ä–∞–≤–∏–ª–∞, –ø–æ –∫–æ—Ç–æ—Ä—ã–º —Å–∏—Å—Ç–µ–º–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, —á–µ—Ä–µ–∑ –∫–∞–∫–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏ —à–ª—é–∑ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Ç—Ä–∞—Ñ–∏–∫. –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã –º–æ–≥—É—Ç –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—Ç—å —Ç—Ä–∞—Ñ–∏–∫ —á–µ—Ä–µ–∑ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞ (MITM –Ω–∞ —É—Ä–æ–≤–Ω–µ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏).

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
netstat -rn
route -n get default   # default gateway
```

---

### 3.4 DNS-–∫—ç—à ‚è±Ô∏è
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü°

**–ß—Ç–æ —ç—Ç–æ:** –ö—ç—à DNS-–æ—Ç–≤–µ—Ç–æ–≤, —Ö—Ä–∞–Ω—è—â–∏–π –Ω–µ–¥–∞–≤–Ω–æ —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–µ –¥–æ–º–µ–Ω–Ω—ã–µ –∏–º–µ–Ω–∞. –ü–æ–∑–≤–æ–ª—è–µ—Ç —É–≤–∏–¥–µ—Ç—å, –∫ –∫–∞–∫–∏–º –¥–æ–º–µ–Ω–∞–º –æ–±—Ä–∞—â–∞–ª–∞—Å—å —Å–∏—Å—Ç–µ–º–∞ ‚Äî –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ C2-–¥–æ–º–µ–Ω—ã, DGA (Domain Generation Algorithm) –¥–æ–º–µ–Ω—ã –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û. –û—á–∏—â–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ.

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö–∞–∫–∏–µ –¥–æ–º–µ–Ω—ã —Ä–µ–∑–æ–ª–≤–∏–ª–∞ —Å–∏—Å—Ç–µ–º–∞ –≤ –ø–æ—Å–ª–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è?
- –ï—Å—Ç—å –ª–∏ DNS-–∑–∞–ø—Ä–æ—Å—ã –∫ –∏–∑–≤–µ—Å—Ç–Ω—ã–º C2, DGA-–¥–æ–º–µ–Ω–∞–º –∏–ª–∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–º TLD?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# macOS Monterey+
sudo dscacheutil -cachedump -entries Host

# –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ DNS-–∑–∞–ø–∏—Å–∏ –∏–∑ Unified Logs
log show --predicate 'subsystem == "com.apple.mDNSResponder"' --last 24h | \
  grep -i "query\|resolve"
```

---

### 3.5 –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ç–µ–≤—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ –∏ hosts
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü°

**–ß—Ç–æ —ç—Ç–æ:** –§–∞–π–ª `/etc/hosts` ‚Äî –ª–æ–∫–∞–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ DNS-—Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∏–º—ë–Ω, –∫–æ—Ç–æ—Ä–∞—è –∏–º–µ–µ—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –Ω–∞–¥ DNS-—Å–µ—Ä–≤–µ—Ä–æ–º. –í—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ –ü–û –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –µ–≥–æ –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–æ–≤, –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞. –§–∞–π–ª—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ DNS-—Å–µ—Ä–≤–µ—Ä–æ–≤ —Ö—Ä–∞–Ω—è—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ–º, –∫–∞–∫–∏–µ DNS-—Å–µ—Ä–≤–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–∏—Å—Ç–µ–º–∞ (–∏–∑–º–µ–Ω–µ–Ω–∏–µ = –ø–µ—Ä–µ—Ö–≤–∞—Ç DNS-—Ç—Ä–∞—Ñ–∏–∫–∞).

**–ü—É—Ç—å:**
```
/private/etc/hosts
/private/etc/resolv.conf
/Library/Preferences/SystemConfiguration/NetworkInterfaces.plist
/Library/Preferences/SystemConfiguration/preferences.plist
```

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ò–∑–º–µ–Ω—ë–Ω –ª–∏ `/etc/hosts` (–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ AV-—Å–µ—Ä–≤–µ—Ä–æ–≤, —Ä–µ–¥–∏—Ä–µ–∫—Ç —Ç—Ä–∞—Ñ–∏–∫–∞)?
- –ò–∑–º–µ–Ω–µ–Ω—ã –ª–∏ DNS-—Å–µ—Ä–≤–µ—Ä—ã –Ω–∞ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏—á–µ—Å–∫–∏–µ?
- –ö–∞–∫–æ–π MAC-–∞–¥—Ä–µ—Å –∏ IP-–∞–¥—Ä–µ—Å –∏–º–µ—é—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
cat /etc/hosts
networksetup -getdnsservers Wi-Fi
scutil --dns
ifconfig -a
```

---

### 3.6 Wi-Fi –∏—Å—Ç–æ—Ä–∏—è
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü°

**–ß—Ç–æ —ç—Ç–æ:** –°–ø–∏—Å–æ–∫ —Å–µ—Ç–µ–π Wi-Fi, –∫ –∫–æ—Ç–æ—Ä—ã–º –∫–æ–≥–¥–∞-–ª–∏–±–æ –ø–æ–¥–∫–ª—é—á–∞–ª–∞—Å—å —Å–∏—Å—Ç–µ–º–∞, —Å –≤—Ä–µ–º–µ–Ω–Ω—ãÃÅ–º–∏ –º–µ—Ç–∫–∞–º–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π. –ü–æ–∑–≤–æ–ª—è–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –≤ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ –ø–µ—Ä–∏–æ–¥—ã –∏ –æ—Ç—Å–ª–µ–¥–∏—Ç—å –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–º —Å–µ—Ç—è–º –≤ –Ω–µ—Ä–∞–±–æ—á–µ–µ –≤—Ä–µ–º—è.

**–ü—É—Ç—å:**
```
/Library/Preferences/SystemConfiguration/com.apple.airport.preferences.plist
```

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
plutil -p /Library/Preferences/SystemConfiguration/com.apple.airport.preferences.plist

# –ß–µ—Ä–µ–∑ Unified Logs (macOS 12+)
log show --predicate 'subsystem == "com.apple.WiFiPolicy"' --last 7d
```

---

### 3.7 Firewall –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü°

**–ß—Ç–æ —ç—Ç–æ:** –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ Application Layer Firewall (ALF) macOS. –•—Ä–∞–Ω–∏—Ç —Å—Ç–∞—Ç—É—Å firewall (–≤–∫–ª—é—á—ë–Ω/–≤—ã–∫–ª—é—á—ë–Ω) –∏ —Å–ø–∏—Å–æ–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π —Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è–º–∏. –û—Ç–∫–ª—é—á—ë–Ω–Ω—ã–π firewall –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –∏–ª–∏ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ ‚Äî –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –ø—Ä–∏–∑–Ω–∞–∫ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏ –∏–ª–∏ —Ö–∞–ª–∞—Ç–Ω–æ—Å—Ç–∏.

**–ü—É—Ç—å:**
```
/Library/Preferences/com.apple.alf.plist
```

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
/usr/libexec/ApplicationFirewall/socketfilterfw --getglobalstate
/usr/libexec/ApplicationFirewall/socketfilterfw --listapps
plutil -p /Library/Preferences/com.apple.alf.plist
```

---

### 3.8 –°–µ—Ç–µ–≤–æ–π –∑–∞—Ö–≤–∞—Ç —Ç—Ä–∞—Ñ–∏–∫–∞ (PCAP) ‚è±Ô∏è
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° ‚ö†Ô∏è

**–ß—Ç–æ —ç—Ç–æ:** –î–∞–º–ø —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏. –ü–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞—Ö–≤–∞—Ç–∏—Ç—å C2-–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—é, –ø–µ—Ä–µ–¥–∞—á—É –¥–∞–Ω–Ω—ã—Ö –∏ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –≤ –º–æ–º–µ–Ω—Ç –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞. –î–∞–Ω–Ω—ã–µ –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –≤ –º–æ–º–µ–Ω—Ç –∑–∞—Ö–≤–∞—Ç–∞ ‚Äî —Ä–µ—Ç—Ä–æ—Å–ø–µ–∫—Ç–∏–≤–Ω–æ —Ç—Ä–∞—Ñ–∏–∫ –Ω–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å (–µ—Å–ª–∏ –Ω–µ—Ç SIEM/NDR).

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# –ó–∞—Ö–≤–∞—Ç –≤—Å–µ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞
sudo tcpdump -i en0 -w /Volumes/USB/capture_$(date +%Y%m%dT%H%M%S).pcap

# –¢–æ–ª—å–∫–æ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø–æ—Ä—Ç—ã (–∏—Å–∫–ª—é—á–∞—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤–µ–±)
sudo tcpdump -i en0 -w capture.pcap 'not port 80 and not port 443'

# –ê–Ω–∞–ª–∏–∑ pcap (–Ω–∞ —Ä–∞–±–æ—á–µ–π —Å—Ç–∞–Ω—Ü–∏–∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞)
tcpdump -r capture.pcap -n | head -100
tshark -r capture.pcap -T fields -e ip.src -e ip.dst -e tcp.dstport
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Å–±–æ—Ä–∞:**
| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –ö–æ–º–∞–Ω–¥–∞ |
|------------|---------|
| Aftermath | –í–∫–ª—é—á–µ–Ω–æ (tcpdump –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Å–±–æ—Ä—É) |
| –í—Ä—É—á–Ω—É—é | `sudo tcpdump -i en0 -w capture.pcap` |

---

## 4. File System ‚Äî —Ñ–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞

### 4.1 FSEvents Store Database
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ ‚ö†Ô∏è

**–ß—Ç–æ —ç—Ç–æ:** –í—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π –∂—É—Ä–Ω–∞–ª —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã macOS. –í–µ–¥—ë—Ç—Å—è –¥–µ–º–æ–Ω–æ–º `fseventsd` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç–æ–º–∞. –§–∏–∫—Å–∏—Ä—É–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ, –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ, –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—é, –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–º–æ–≤. –ö–ª—é—á–µ–≤–∞—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å: **–∑–∞–ø–∏—Å–∏ –æ —Ñ–∞–π–ª–∞—Ö —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –¥–∞–∂–µ –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è —Å–∞–º–∏—Ö —Ñ–∞–π–ª–æ–≤** ‚Äî —ç—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ–∞–∫—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –∏ –ø—É—Ç—å —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞. –ë–∏–Ω–∞—Ä–Ω—ã–π gzip-—Ñ–æ—Ä–º–∞—Ç, —Ç—Ä–µ–±—É–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ –ø–∞—Ä—Å–µ—Ä–∞.

**–ü—É—Ç—å:**
```
/.fseventsd/                          # –∫–æ—Ä–Ω–µ–≤–æ–π —Ç–æ–º
/Volumes/<name>/.fseventsd/           # –≤–Ω–µ—à–Ω–∏–µ —Ç–æ–º–∞ (USB –∏ –¥—Ä.)
/System/Volumes/Data/.fseventsd/      # Data-—Ç–æ–º (APFS, macOS 10.15+)
```

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö–∞–∫–∏–µ —Ñ–∞–π–ª—ã —Å–æ–∑–¥–∞–≤–∞–ª–∏—Å—å, –∏–∑–º–µ–Ω—è–ª–∏—Å—å, –ø–µ—Ä–µ–º–µ—â–∞–ª–∏—Å—å –∏–ª–∏ —É–¥–∞–ª—è–ª–∏—Å—å?
- –ö–æ–≥–¥–∞ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π —Ñ–∞–π–ª –≤–ø–µ—Ä–≤—ã–µ –ø–æ—è–≤–∏–ª—Å—è –≤ —Å–∏—Å—Ç–µ–º–µ?
- –û—Ç–∫—É–¥–∞ –±—ã–ª –ø–µ—Ä–µ–º–µ—â—ë–Ω –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π —Ñ–∞–π–ª?
- –ö–∞–∫–∏–µ —Ñ–∞–π–ª—ã –±—ã–ª–∏ —É–¥–∞–ª–µ–Ω—ã –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–æ–º –¥–ª—è —Å–æ–∫—Ä—ã—Ç–∏—è —Å–ª–µ–¥–æ–≤?
- –ö–æ–≥–¥–∞ –ø–æ–¥–∫–ª—é—á–∞–ª–∏—Å—å/–æ—Ç–∫–ª—é—á–∞–ª–∏—Å—å –≤–Ω–µ—à–Ω–∏–µ —Ç–æ–º–∞?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# FSEventsParser (Python, https://github.com/dlcowen/FSEventsParser)
python3 FSEventsParser.py -s /.fseventsd/ -o /output/fsevents/

# FSEventsParser-rs (Rust, –±—ã—Å—Ç—Ä–µ–µ, https://github.com/Houwenda/FSEventsParser-rs)
./FSEventsParser-rs -s /.fseventsd/ -o /output/fsevents.csv

# mac_apt –ø–ª–∞–≥–∏–Ω
python3 mac_apt.py -i /image.dmg FSEVENTS

# Plaso –ø–∞—Ä—Å–µ—Ä
log2timeline.py --parsers fsevents --storage-file timeline.plaso /
```

> ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç root. –§–∞–π–ª—ã –±–∏–Ω–∞—Ä–Ω—ã–µ, –±–µ–∑ –ø–∞—Ä—Å–µ—Ä–∞ –Ω–µ—á–∏—Ç–∞–µ–º—ã.

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Å–±–æ—Ä–∞:**
| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –ö–æ–º–∞–Ω–¥–∞ |
|------------|---------|
| UAC | –í–∫–ª—é—á–µ–Ω–æ –≤ `full` –ø—Ä–æ—Ñ–∏–ª—å (`files/logs/macos.yaml`) |
| –í—Ä—É—á–Ω—É—é | `sudo cp -r /.fseventsd/ /output/fseventsd/` |

---

### 4.2 Bodyfile (MACB Timestamps)
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥

**–ß—Ç–æ —ç—Ç–æ:** –î–∞–º–ø –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π —á–µ—Ç—ã—Ä–µ –≤—Ä–µ–º–µ–Ω–Ω—ãÃÅ–µ –º–µ—Ç–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞: **M**odified (–ø–æ—Å–ª–µ–¥–Ω–µ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ), **A**ccessed (–ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–æ—Å—Ç—É–ø), **C**hanged (–∏–∑–º–µ–Ω–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö/inode), **B**orn (–¥–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è). –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ timeline —Ñ–∞–π–ª–æ–≤—ã—Ö —Å–æ–±—ã—Ç–∏–π. –í APFS –≤—Ä–µ–º–µ–Ω–Ω–∞ÃÅ—è –º–µ—Ç–∫–∞ Born —á–∞—Å—Ç–æ —è–≤–ª—è–µ—Ç—Å—è —Å–∞–º–æ–π —Ç–æ—á–Ω–æ–π (–≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç HFS+).

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö–æ–≥–¥–∞ –±—ã–ª —Å–æ–∑–¥–∞–Ω/–∏–∑–º–µ–Ω—ë–Ω/–¥–æ—Å—Ç—É–ø–µ–Ω –ª—é–±–æ–π —Ñ–∞–π–ª —Å–∏—Å—Ç–µ–º—ã?
- –ï—Å—Ç—å –ª–∏ —Ñ–∞–π–ª—ã —Å –∞–Ω–æ–º–∞–ª—å–Ω—ã–º–∏ –≤—Ä–µ–º–µ–Ω–Ω—ãÃÅ–º–∏ –º–µ—Ç–∫–∞–º–∏ (timestomping ‚Äî –ø—Ä–∏–∑–Ω–∞–∫ —Å–æ–∫—Ä—ã—Ç–∏—è —Å–ª–µ–¥–æ–≤)?
- –ö–∞–∫–æ–≤–∞ —Ö—Ä–æ–Ω–æ–ª–æ–≥–∏—è —Ñ–∞–π–ª–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞?
- –ö–æ–≥–¥–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π —Ñ–∞–π–ª –ø–æ—è–≤–∏–ª—Å—è –Ω–∞ —Å–∏—Å—Ç–µ–º–µ?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# –°–æ–∑–¥–∞–Ω–∏–µ bodyfile —á–µ—Ä–µ–∑ The Sleuth Kit
sudo fls -r -m "/" /dev/disk0s1 > bodyfile.txt

# –°–æ–∑–¥–∞–Ω–∏–µ timeline –∏–∑ bodyfile
mactime -b bodyfile.txt -d > timeline.csv

# –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –¥–∞—Ç–µ
mactime -b bodyfile.txt -d -z UTC \
  -p /tmp/passwd 2020-01-01 2020-12-31 > timeline_2020.csv
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Å–±–æ—Ä–∞:**
| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –ö–æ–º–∞–Ω–¥–∞ |
|------------|---------|
| UAC | `bodyfile/bodyfile.yaml` (–≤–∫–ª—é—á–µ–Ω–æ –≤ ir_triage –∏ full) |
| Plaso | `log2timeline.py --parsers filestat` |

---

### 4.3 Quarantine Events Database
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥

**–ß—Ç–æ —ç—Ç–æ:** SQLite-–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—É—é macOS –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤, –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –∏–ª–∏ —á–µ—Ä–µ–∑ AirDrop (–∞—Ç—Ä–∏–±—É—Ç –∫–∞—Ä–∞–Ω—Ç–∏–Ω–∞). –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ —Å–∫–∞—á–∞–ª–æ —Ñ–∞–π–ª, URL –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∏ URL —Å—Ç—Ä–∞–Ω–∏—Ü—ã (referrer), –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏. **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ: –∑–∞–ø–∏—Å–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –¥–∞–∂–µ –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è —Ñ–∞–π–ª–∞**. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ —Å–∫–∞—á–∞–ª –∏ —É–¥–∞–ª–∏–ª malware.dmg ‚Äî –∑–∞–ø–∏—Å—å –≤ QuarantineEventsV2 –æ—Å—Ç–∞–Ω–µ—Ç—Å—è.

**–ü—É—Ç—å:**
```
~/Library/Preferences/com.apple.LaunchServices.QuarantineEventsV2
```

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö–∞–∫–∏–µ —Ñ–∞–π–ª—ã —Å–∫–∞—á–∏–≤–∞–ª–∏—Å—å –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –∏–ª–∏ —á–µ—Ä–µ–∑ AirDrop?
- –ò–∑ –∫–∞–∫–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è/–±—Ä–∞—É–∑–µ—Ä–∞ –±—ã–ª —Å–∫–∞—á–∞–Ω —Ñ–∞–π–ª (Safari, Chrome, –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä)?
- –ö–∞–∫–æ–π –±—ã–ª –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π URL –∑–∞–≥—Ä—É–∑–∫–∏ (–ø—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ C2 –∏–ª–∏ —Ñ–∏—à–∏–Ω–≥–æ–≤—ã–π —Å–∞–π—Ç)?
- –ö–æ–≥–¥–∞ –±—ã–ª —Å–∫–∞—á–∞–Ω —Ñ–∞–π–ª (–¥–∞–∂–µ –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è —Ñ–∞–π–ª–∞ –∑–∞–ø–∏—Å—å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è)?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# SQLite –ø—Ä—è–º–æ–π –∑–∞–ø—Ä–æ—Å
sqlite3 ~/Library/Preferences/com.apple.LaunchServices.QuarantineEventsV2 \
  "SELECT datetime(LSQuarantineTimeStamp + 978307200, 'unixepoch') as time,
   LSQuarantineAgentName as app,
   LSQuarantineOriginURLString as source_url,
   LSQuarantineDataURLString as file_url
   FROM LSQuarantineEvent ORDER BY LSQuarantineTimeStamp DESC;"

# mac_apt –ø–ª–∞–≥–∏–Ω
python3 mac_apt.py -i /path/to/collection QUARANTINE
```

> **–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è timestamp:** Apple Epoch = —Å–µ–∫—É–Ω–¥—ã —Å 01.01.2001 ‚Üí `timestamp + 978307200 = Unix timestamp`

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Å–±–æ—Ä–∞:**
| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –ö–æ–º–∞–Ω–¥–∞ |
|------------|---------|
| Aftermath | –í–∫–ª—é—á–µ–Ω–æ (–º–æ–¥—É–ª—å databases) |
| UAC | –§–∞–π–ª –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è –≤ `full` –ø—Ä–æ—Ñ–∏–ª–µ |
| mac_apt | –ü–ª–∞–≥–∏–Ω QUARANTINE |

---

### 4.4 Spotlight Metadata
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° ‚ö†Ô∏è

**–ß—Ç–æ —ç—Ç–æ:** –ò–Ω–¥–µ–∫—Å–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–∏—Å–∫–æ–≤–æ–≥–æ –¥–≤–∏–∂–∫–∞ Spotlight. –ò–Ω–¥–µ–∫—Å–∏—Ä—É–µ—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ –Ω–∞ –¥–∏—Å–∫–µ, –≤–∫–ª—é—á–∞—è —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã (xattr), —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, EXIF —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ñ–∞–π–ª–∞—Ö –¥–∞–∂–µ –ø–æ—Å–ª–µ –∏—Ö —É–¥–∞–ª–µ–Ω–∏—è –¥–æ —Å–ª–µ–¥—É—é—â–µ–π –ø–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏. –ú–æ–∂–µ—Ç —Ä–∞—Å–∫—Ä—ã—Ç—å —Ñ–∞–∫—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –±–æ–ª—å—à–µ –Ω–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –Ω–∞ –¥–∏—Å–∫–µ.

**–ü—É—Ç—å:**
```
/.Spotlight-V100/Store-V2/<UUID>/
/Volumes/<name>/.Spotlight-V100/
```

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö–∞–∫–∏–µ —Ñ–∞–π–ª—ã –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–ª–∞ —Å–∏—Å—Ç–µ–º–∞ (–≤–∫–ª—é—á–∞—è —É–¥–∞–ª—ë–Ω–Ω—ã–µ –¥–æ –ø–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏)?
- –ö–∞–∫–∏–µ –ø–æ–∏—Å–∫–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã –≤—ã–ø–æ–ª–Ω—è–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —á–µ—Ä–µ–∑ Spotlight?
- –ö–∞–∫–∏–µ –≤–Ω–µ—à–Ω–∏–µ —Ç–æ–º–∞ –ø–æ–¥–∫–ª—é—á–∞–ª–∏—Å—å (Spotlight –∏–Ω–¥–µ–∫—Å–∏—Ä—É–µ—Ç –∏—Ö —Ç–æ–∂–µ)?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# –ü–æ–∏—Å–∫ —á–µ—Ä–µ–∑ mdls (metadata –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ñ–∞–π–ª–∞)
mdls /path/to/file

# –ü–æ–∏—Å–∫ –ø–æ —Ç–∏–ø—É
mdfind "kMDItemKind == 'Shell Script'"
mdfind -onlyin /Users "kMDItemDisplayName == '*.py'"

# mac_apt –ø–ª–∞–≥–∏–Ω
python3 mac_apt.py -i /path/to/collection SPOTLIGHT
```

---

### 4.5 `.DS_Store` —Ñ–∞–π–ª—ã
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢

**–ß—Ç–æ —ç—Ç–æ:** –°–∫—Ä—ã—Ç—ã–µ —Ñ–∞–π–ª—ã, —Å–æ–∑–¥–∞–≤–∞–µ–º—ã–µ Finder –≤ –∫–∞–∂–¥–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, –∫–æ—Ç–æ—Ä—É—é –æ—Ç–∫—Ä—ã–≤–∞–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å. –•—Ä–∞–Ω—è—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–∏ –ø–∞–ø–∫–∏: –ø–æ–∑–∏—Ü–∏–∏ –∏–∫–æ–Ω–æ–∫, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–∏–¥–∞, —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤. –ü–æ–∑–≤–æ–ª—è—é—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å, –≤ –∫–∞–∫–∏—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è—Ö —Ä–∞–±–æ—Ç–∞–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —á–µ—Ä–µ–∑ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, –¥–∞–∂–µ –µ—Å–ª–∏ —Ñ–∞–π–ª—ã —É–∂–µ —É–¥–∞–ª–µ–Ω—ã.

**–ü—É—Ç—å:**
```
~/**/.DS_Store   (–≤ –∫–∞–∂–¥–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, –æ—Ç–∫—Ä—ã—Ç–æ–π –≤ Finder)
```

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# DS_Store Parser (https://github.com/nicowillis/DS_Store-Parser)
python3 ds_store_parser.py ~/.DS_Store

# –ü–æ–∏—Å–∫ –≤—Å–µ—Ö DS_Store —Ñ–∞–π–ª–æ–≤
find / -name ".DS_Store" 2>/dev/null | head -50
```

---

### 4.6 DocumentRevisions / AutoSave
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢

**–ß—Ç–æ —ç—Ç–æ:** –°–∏—Å—Ç–µ–º–∞ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ macOS. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏. –•—Ä–∞–Ω–∏—Ç—Å—è –≤ —Å–∫—Ä—ã—Ç–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –≤ –∫–æ—Ä–Ω–µ —Ç–æ–º–∞. –ü–æ–∑–≤–æ–ª—è–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –¥–æ –µ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–æ–º –∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º.

**–ü—É—Ç—å:**
```
/.DocumentRevisions-V100/
```

---

### 4.7 Temp-–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥

**–ß—Ç–æ —ç—Ç–æ:** –í—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Å–∏—Å—Ç–µ–º–æ–π –∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤. –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–µ –º–µ—Å—Ç–æ –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–≥–æ –¥—Ä–æ–ø–∞ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û: –º–∞–ª–≤–∞—Ä—å —á–∞—Å—Ç–æ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Å–µ–±—è –≤ `/tmp`, –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∏ –∑–∞—Ç–µ–º —É–¥–∞–ª—è–µ—Ç —Ñ–∞–π–ª (–Ω–æ –≤ FSEvents —Å–ª–µ–¥ –æ—Å—Ç–∞—ë—Ç—Å—è). –°–æ–¥–µ—Ä–∂–∏–º–æ–µ `/tmp` –æ—á–∏—â–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ.

**–ü—É—Ç—å:**
```
/tmp/ ‚Üí /private/tmp/
/var/tmp/ ‚Üí /private/var/tmp/
/var/folders/   # TMPDIR —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)
```

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ï—Å—Ç—å –ª–∏ –¥—Ä–æ–ø—ã –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ü–û –≤–æ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è—Ö –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å?
- –ö–∞–∫–∏–µ —Ñ–∞–π–ª—ã —Å–æ–∑–¥–∞–≤–∞–ª–∏—Å—å –≤ /tmp –≤ –ø–æ—Å–ª–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è (–ø–µ—Ä–µ–∫—Ä—ë—Å—Ç–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å FSEvents)?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
ls -lat /tmp/ /var/tmp/
find /tmp /var/tmp -mtime -1 -ls    # —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞
find /tmp /var/tmp -type f -exec shasum -a 256 {} \;
```

---

### 4.8 Extended Attributes (xattr)
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü°

**–ß—Ç–æ —ç—Ç–æ:** –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã —Ñ–∞–π–ª–æ–≤ ‚Äî –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ, —Ö—Ä–∞–Ω–∏–º—ã–µ –≤–Ω–µ –æ—Å–Ω–æ–≤–Ω–æ–π –∑–∞–ø–∏—Å–∏ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã. –ö–ª—é—á–µ–≤–æ–π –∞—Ç—Ä–∏–±—É—Ç –¥–ª—è IR: `com.apple.quarantine` —É–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ —Ñ–∞–π–ª –ø–æ–ª—É—á–µ–Ω –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ (–∏ —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è –≤ QuarantineEventsV2). `com.apple.metadata:_kMDItemUserTags` ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ç–µ–≥–∏. –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∏ –º–æ–≥—É—Ç –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ —É–¥–∞–ª—è—Ç—å –∞—Ç—Ä–∏–±—É—Ç –∫–∞—Ä–∞–Ω—Ç–∏–Ω–∞ –¥–ª—è –æ–±—Ö–æ–¥–∞ Gatekeeper.

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤ —Ñ–∞–π–ª–∞
xattr -l /path/to/suspicious/file

# –ê—Ç—Ä–∏–±—É—Ç –∫–∞—Ä–∞–Ω—Ç–∏–Ω–∞ (–µ—Å—Ç—å —É —Ñ–∞–π–ª–æ–≤ –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞)
xattr -p com.apple.quarantine /path/to/file

# –ü–æ–∏—Å–∫ —Ñ–∞–π–ª–æ–≤ –° –∞—Ç—Ä–∏–±—É—Ç–æ–º –∫–∞—Ä–∞–Ω—Ç–∏–Ω–∞
find /Applications ~/Downloads -name "*.app" \
  -exec xattr -l {} \; 2>/dev/null | grep "quarantine"

# –ü–æ–∏—Å–∫ —Ñ–∞–π–ª–æ–≤ –ë–ï–ó –∞—Ç—Ä–∏–±—É—Ç–∞ –∫–∞—Ä–∞–Ω—Ç–∏–Ω–∞ (–æ–±—Ö–æ–¥ Gatekeeper)
find ~/Downloads -name "*.app" | while read f; do
  xattr "$f" 2>/dev/null | grep -q "quarantine" || echo "NO QUARANTINE: $f"
done
```

---

## 5. User Activity ‚Äî –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### 5.1 Shell History
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥

**–ß—Ç–æ —ç—Ç–æ:** –§–∞–π–ª—ã –∏—Å—Ç–æ—Ä–∏–∏ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏, –≤ –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤—Å–µ –∫–æ–º–∞–Ω–¥—ã, –≤–≤–µ–¥—ë–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –≤ Terminal. –í macOS —Å –≤–µ—Ä—Å–∏–∏ 10.15 –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π shell ‚Äî zsh, —Ñ–∞–π–ª –∏—Å—Ç–æ—Ä–∏–∏ ‚Äî `~/.zsh_history`. –ü—Ä–∏ –≤–∫–ª—é—á—ë–Ω–Ω–æ–º `EXTENDED_HISTORY` –∫–∞–∂–¥–∞—è –∫–æ–º–∞–Ω–¥–∞ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è —Å Unix timestamp. –í–∞–∂–Ω–æ: –∏—Å—Ç–æ—Ä–∏—è **–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –∏–∑ —Å–µ—Å—Å–∏–∏ shell**, –ø–æ—ç—Ç–æ–º—É –µ—Å–ª–∏ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ —É–±–∏–ª —Ç–µ—Ä–º–∏–Ω–∞–ª ‚Äî –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã –º–æ–≥—É—Ç –Ω–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å—Å—è.

**–ü—É—Ç—å:**
```
~/.zsh_history            # zsh (macOS 10.15+, –¥–µ—Ñ–æ–ª—Ç)
~/.bash_history           # bash (legacy)
~/.zsh_sessions/          # —Å–µ—Å—Å–∏–æ–Ω–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è zsh
~/.bash_sessions/
```

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö–∞–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã –≤—ã–ø–æ–ª–Ω—è–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–ª–∏ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫?
- –ï—Å—Ç—å –ª–∏ –ø—Ä–∏–∑–Ω–∞–∫–∏ lateral movement (ssh, scp, rsync –∫ –¥—Ä—É–≥–∏–º —Ö–æ—Å—Ç–∞–º)?
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –ª–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —ç–∫—Å—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ (curl, wget, nc, base64)?
- –ó–∞–ø—É—Å–∫–∞–ª–∏—Å—å –ª–∏ —Å–∫—Ä–∏–ø—Ç—ã —Å –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏ –∏–ª–∏ –∑–∞–≥—Ä—É–∑–∫–æ–π –∏–∑ —Å–µ—Ç–∏?
- –ë—ã–ª–∏ –ª–∏ –ø–æ–ø—ã—Ç–∫–∏ —Å–æ–∫—Ä—ã—Ç–∏—è —Å–ª–µ–¥–æ–≤ (history -c, rm ~/.zsh_history)?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏ —Å –≤—Ä–µ–º–µ–Ω–Ω—ãÃÅ–º–∏ –º–µ—Ç–∫–∞–º–∏
cat ~/.zsh_history

# –î–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ zsh EXTENDED_HISTORY (: timestamp:elapsed;command)
awk '/^: [0-9]/{
  ts = substr($2, 1, index($2,":")-1)
  cmd = $0; sub(/^: [0-9]+:[0-9]+;/,"",cmd)
  printf "%s\t%s\n", strftime("%Y-%m-%d %H:%M:%S", ts), cmd
}' ~/.zsh_history

# –ü–æ–∏—Å–∫ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–æ–º–∞–Ω–¥
grep -E "curl|wget|nc |python.*-c|ruby.*-e|perl.*-e|base64.*-d|\
  /tmp|/dev/tcp|ssh.*-R|ssh.*-L|scp|rsync" ~/.zsh_history
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Å–±–æ—Ä–∞:**
| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –ö–æ–º–∞–Ω–¥–∞ |
|------------|---------|
| UAC | –í–∫–ª—é—á–µ–Ω–æ –≤ `full` –ø—Ä–æ—Ñ–∏–ª—å |
| Aftermath | –í–∫–ª—é—á–µ–Ω–æ |
| –í—Ä—É—á–Ω—É—é | `cp ~/.zsh_history /output/; cp -r ~/.zsh_sessions/ /output/` |

---

### 5.2 KnowledgeC Database
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥

**–ß—Ç–æ —ç—Ç–æ:** SQLite-–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–¥—Å–∏—Å—Ç–µ–º—ã CoreDuet, –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—â–µ–π –ø–∞—Ç—Ç–µ—Ä–Ω –∂–∏–∑–Ω–∏ (pattern of life) –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –•—Ä–∞–Ω–∏—Ç –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é –∏—Å—Ç–æ—Ä–∏—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏: –∫–∞–∫–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å, –∫–∞–∫ –¥–æ–ª–≥–æ, –≤ –∫–∞–∫–æ–µ –≤—Ä–µ–º—è; —Å–æ—Å—Ç–æ—è–Ω–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —ç–∫—Ä–∞–Ω–∞; Bluetooth-–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è; –ø–æ—Å–µ—â—ë–Ω–Ω—ã–µ —Å–∞–π—Ç—ã –≤ –±—Ä–∞—É–∑–µ—Ä–∞—Ö; –º–µ–¥–∏–∞–≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ; —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è. –ê–Ω–∞–ª–æ–≥ Windows UserAssist, –Ω–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±–æ–≥–∞—á–µ –ø–æ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—é. –í—Ä–µ–º–µ–Ω–Ω—ãÃÅ–µ –º–µ—Ç–∫–∏ –≤ Apple Epoch (—Å–µ–∫—É–Ω–¥—ã —Å 01.01.2001).

**–ü—É—Ç—å:**
```
~/Library/Application Support/Knowledge/knowledgeC.db
```

> ‚ö†Ô∏è –° macOS 13 (Ventura) –¥–∞–Ω–Ω—ã–µ —á–∞—Å—Ç–∏—á–Ω–æ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω—ã –≤ **Biome** (protobuf-—Ñ–æ—Ä–º–∞—Ç).

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö–∞–∫–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –∏ –∫–∞–∫ –¥–æ–ª–≥–æ (–ø–æ–ª–Ω—ã–π timeline –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏)?
- –ö–æ–≥–¥–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –±—ã–ª–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ/—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ (–∞–ª–∏–±–∏ –∏–ª–∏ –æ–ø—Ä–æ–≤–µ—Ä–∂–µ–Ω–∏–µ)?
- –ö–∞–∫–∏–µ –±—Ä–∞—É–∑–µ—Ä–Ω—ã–µ —Å–∞–π—Ç—ã –ø–æ—Å–µ—â–∞–ª–∏—Å—å (–¥—É–±–ª–∏—Ä—É–µ—Ç Safari History, –Ω–æ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ)?
- –ö–æ–≥–¥–∞ –ø–æ–¥–∫–ª—é—á–∞–ª–∏—Å—å Bluetooth-—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞?
- –ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–∫—Ç–∏–≤–Ω–æ —Ä–∞–±–æ—Ç–∞–ª –∑–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ–º (—ç–∫—Ä–∞–Ω –≤–∫–ª—é—á—ë–Ω)?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# APOLLO (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è ‚Äî https://github.com/mac4n6/APOLLO)
python3 apollo.py extract -o /output/apollo/ \
  ~/Library/Application\ Support/Knowledge/knowledgeC.db

# SQLite –ø—Ä—è–º–æ–π –∑–∞–ø—Ä–æ—Å ‚Äî —Ç–æ–ø –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
sqlite3 ~/Library/Application\ Support/Knowledge/knowledgeC.db \
  "SELECT ZVALUESTRING as app,
   SUM(ZENDDATE - ZSTARTDATE) as total_seconds
   FROM ZOBJECT WHERE ZSTREAMNAME = '/app/inFocus'
   GROUP BY ZVALUESTRING ORDER BY total_seconds DESC LIMIT 20;"

# mac_apt –ø–ª–∞–≥–∏–Ω
python3 mac_apt.py -i /path/to/collection KNOWLEDGEC
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Å–±–æ—Ä–∞:**
| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –ö–æ–º–∞–Ω–¥–∞ |
|------------|---------|
| UAC | –§–∞–π–ª –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è –≤ `full` –ø—Ä–æ—Ñ–∏–ª–µ |
| Aftermath | –§–∞–π–ª –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è (–Ω–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞) |
| –í—Ä—É—á–Ω—É—é | `cp ~/Library/Application\ Support/Knowledge/knowledgeC.db /output/` |

---

### 5.3 Biome Data (macOS 13+)
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü°

**–ß—Ç–æ —ç—Ç–æ:** –ù–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–∞ –∂–∏–∑–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –∑–∞–º–µ–Ω—è—é—â–∞—è KnowledgeC —Å macOS 13. –î–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –±–∏–Ω–∞—Ä–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö —Å protobuf-–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ–º. –í–∫–ª—é—á–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, App Intents, Shortcuts, –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è—Ö —Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏. –ù–∏ UAC, –Ω–∏ Aftermath –Ω–µ —Å–æ–±–∏—Ä–∞—é—Ç Biome –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ ‚Äî —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä—É—á–Ω–æ–π —Å–±–æ—Ä.

**–ü—É—Ç—å:**
```
~/Library/Biome/            # –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
/private/var/db/biome/      # —Å–∏—Å—Ç–µ–º–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
```

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# –ü–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
find ~/Library/Biome/ /private/var/db/biome/ -type f | head -30

# biomedata –ø–∞—Ä—Å–µ—Ä (https://github.com/cmsj/biomedata)
python3 biomedata.py ~/Library/Biome/
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Å–±–æ—Ä–∞:**
| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –ö–æ–º–∞–Ω–¥–∞ |
|------------|---------|
| –í—Ä—É—á–Ω—É—é | `sudo rsync -av ~/Library/Biome/ /output/biome_user/` |

> ‚ö†Ô∏è –ù–∏ UAC, –Ω–∏ Aftermath –Ω–µ —Å–æ–±–∏—Ä–∞—é—Ç Biome –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

---

### 5.4 Recent Items –∏ MRU (Most Recently Used)
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü°

**–ß—Ç–æ —ç—Ç–æ:** –ù–µ—Å–∫–æ–ª—å–∫–æ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –Ω–µ–¥–∞–≤–Ω–æ –æ—Ç–∫—Ä—ã—Ç—ã—Ö —Ñ–∞–π–ª–∞—Ö, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö –∏ –ø–∞–ø–∫–∞—Ö. –°–∏—Å—Ç–µ–º–Ω—ã–µ MRU —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ `.sfl2` —Ñ–∞–π–ª–∞—Ö (–±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç). Microsoft Office –≤–µ–¥—ë—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–µ MRU-—Å–ø–∏—Å–∫–∏ —Å –≥–æ—Ä–∞–∑–¥–æ –±–æ–ª—å—à–µ–π –≥–ª—É–±–∏–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏, —á–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ macOS-–∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã.

**–ü—É—Ç—å:**
```
~/Library/Application Support/com.apple.sharedfilelist/
  com.apple.LSSharedFileList.RecentApplications.sfl2
  com.apple.LSSharedFileList.RecentDocuments.sfl2
  com.apple.LSSharedFileList.RecentServers.sfl2
~/Library/Preferences/com.apple.recentitems.plist
# Microsoft Office MRU (–±–æ–ª—å—à–µ –∏—Å—Ç–æ—Ä–∏–∏)
~/Library/Containers/com.microsoft.Word/Data/Library/Preferences/com.microsoft.Word.securebookmarks.plist
~/Library/Containers/com.microsoft.Excel/Data/Library/Preferences/com.microsoft.Excel.securebookmarks.plist
```

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö–∞–∫–∏–µ —Ñ–∞–π–ª—ã –∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–µ–¥–∞–≤–Ω–æ –æ—Ç–∫—Ä—ã–≤–∞–ª–∏—Å—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º?
- –ï—Å—Ç—å –ª–∏ —Å—Ä–µ–¥–∏ –Ω–µ–¥–∞–≤–Ω–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã (–∏–Ω—Å–∞–π–¥–µ—Ä—Å–∫–∞—è —É–≥—Ä–æ–∑–∞)?
- –ö –∫–∞–∫–∏–º —Å–µ—Ä–≤–µ—Ä–∞–º –ø–æ–¥–∫–ª—é—á–∞–ª—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —á–µ—Ä–µ–∑ Finder?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# sfl2 —Ñ–∞–π–ª—ã
# sfl2-parser (https://github.com/nicowillis/sfl2)
python3 sfl2_parser.py ~/Library/Application\ Support/com.apple.sharedfilelist/

# Finder Recently Used Folders
plutil -p ~/Library/Preferences/com.apple.finder.plist

# mac_apt –ø–ª–∞–≥–∏–Ω
python3 mac_apt.py -i /path/to/collection RECENTITEMS
```

---

### 5.5 Trash (–ö–æ—Ä–∑–∏–Ω–∞)
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü°

**–ß—Ç–æ —ç—Ç–æ:** –£–¥–∞–ª—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã, –ø–µ—Ä–µ–º–µ—â—ë–Ω–Ω—ã–µ –≤ –∫–æ—Ä–∑–∏–Ω—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º. –í macOS —Ñ–∞–π–ª—ã –≤ –∫–æ—Ä–∑–∏–Ω–µ —Ñ–∏–∑–∏—á–µ—Å–∫–∏ –æ—Å—Ç–∞—é—Ç—Å—è –Ω–∞ –¥–∏—Å–∫–µ –¥–æ –æ—á–∏—Å—Ç–∫–∏. –ü–æ–∑–≤–æ–ª—è–µ—Ç –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å —Ñ–∞–π–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—ã—Ç–∞–ª—Å—è —É–¥–∞–ª–∏—Ç—å: –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã, –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ —Ñ–∞–π–ª—ã, –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∞—Ç–∞–∫–∏.

**–ü—É—Ç—å:**
```
~/.Trash/
/Volumes/<name>/.Trashes/<UID>/
```

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
ls -lat ~/.Trash/
find ~/.Trash -type f -exec shasum -a 256 {} \;
```

---

### 5.6 –ë—Ä–∞—É–∑–µ—Ä–Ω—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã ‚Äî Safari
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü°

**–ß—Ç–æ —ç—Ç–æ:** –ò—Å—Ç–æ—Ä–∏—è –ø–æ—Å–µ—â–µ–Ω–∏–π, –∑–∞–≥—Ä—É–∑–∫–∏, Cookie –∏ –∫—ç—à –±—Ä–∞—É–∑–µ—Ä–∞ Safari. –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –±—Ä–∞—É–∑–µ—Ä macOS, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é. –ò—Å—Ç–æ—Ä–∏—è —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ SQLite, –∑–∞–≥—Ä—É–∑–∫–∏ ‚Äî –≤ plist. –í—Ä–µ–º–µ–Ω–Ω—ãÃÅ–µ –º–µ—Ç–∫–∏ Safari –≤ Apple Epoch (—Å–µ–∫—É–Ω–¥—ã —Å 01.01.2001).

**–ü—É—Ç—å:**
```
~/Library/Safari/History.db
~/Library/Safari/Downloads.plist
~/Library/Safari/Bookmarks.plist
~/Library/Caches/com.apple.Safari/
```

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# –ò—Å—Ç–æ—Ä–∏—è Safari (SQLite)
sqlite3 ~/Library/Safari/History.db \
  "SELECT datetime(hv.visit_time + 978307200, 'unixepoch') as time,
   hi.url, hv.title
   FROM history_visits hv
   JOIN history_items hi ON hv.history_item = hi.id
   ORDER BY hv.visit_time DESC LIMIT 100;"

# –ó–∞–≥—Ä—É–∑–∫–∏
plutil -p ~/Library/Safari/Downloads.plist

# mac_apt
python3 mac_apt.py -i /path/to/collection SAFARI
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Å–±–æ—Ä–∞:**
| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –ö–æ–º–∞–Ω–¥–∞ |
|------------|---------|
| Aftermath | –í–∫–ª—é—á–µ–Ω–æ (–±—Ä–∞—É–∑–µ—Ä–Ω—ã–π –º–æ–¥—É–ª—å) |
| UAC | –í–∫–ª—é—á–µ–Ω–æ –≤ `full` –ø—Ä–æ—Ñ–∏–ª–µ |
| mac_apt | –ü–ª–∞–≥–∏–Ω SAFARI |

---

### 5.7 –ë—Ä–∞—É–∑–µ—Ä–Ω—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã ‚Äî Chrome / Edge / Firefox
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü°

**–ß—Ç–æ —ç—Ç–æ:** –ò—Å—Ç–æ—Ä–∏—è, –∑–∞–≥—Ä—É–∑–∫–∏, Cookie, —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –ø–∞—Ä–æ–ª–∏ Chromium-–±—Ä–∞—É–∑–µ—Ä–æ–≤. Chrome —Ö—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ –≤ SQLite, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –≤—Ä–µ–º–µ–Ω–Ω—ãÃÅ—Ö –º–µ—Ç–æ–∫ (WebKit microseconds —Å 01.01.1601). Firefox –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç SQLite (places.sqlite).

**–ü—É—Ç—å:**
```
~/Library/Application Support/Google/Chrome/Default/History
~/Library/Application Support/Google/Chrome/Default/Login Data
~/Library/Application Support/Microsoft Edge/Default/History
~/Library/Application Support/BraveSoftware/Brave-Browser/Default/History
~/Library/Application Support/Firefox/Profiles/*.default*/places.sqlite
```

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# –ò—Å—Ç–æ—Ä–∏—è Chrome (—Ñ–æ—Ä–º–∞—Ç: microseconds —Å 01.01.1601)
sqlite3 ~/Library/Application\ Support/Google/Chrome/Default/History \
  "SELECT datetime(last_visit_time/1000000 - 11644473600, 'unixepoch') as time,
   url, title, visit_count FROM urls ORDER BY last_visit_time DESC LIMIT 100;"

# –ó–∞–≥—Ä—É–∑–∫–∏ Chrome
sqlite3 ~/Library/Application\ Support/Google/Chrome/Default/History \
  "SELECT datetime(start_time/1000000 - 11644473600, 'unixepoch') as time,
   target_path, tab_url FROM downloads ORDER BY start_time DESC;"

# Firefox
sqlite3 ~/Library/Application\ Support/Firefox/Profiles/*.default*/places.sqlite \
  "SELECT datetime(v.visit_date/1000000, 'unixepoch') as time,
   p.url, p.title FROM moz_historyvisits v
   JOIN moz_places p ON v.place_id = p.id
   ORDER BY v.visit_date DESC LIMIT 100;"

# mac_apt
python3 mac_apt.py -i /path/to/collection CHROME
```

> **–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è Chrome timestamp:** `timestamp / 1000000 - 11644473600 = Unix timestamp`

---

### 5.8 –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —É—á—ë—Ç–Ω—ã–µ –∑–∞–ø–∏—Å–∏ (AccountsDB)
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü°

**–ß—Ç–æ —ç—Ç–æ:** SQLite-–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö, —Å–æ–¥–µ—Ä–∂–∞—â–∞—è –≤—Å–µ –æ–±–ª–∞—á–Ω—ã–µ –∏ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ —É—á—ë—Ç–Ω—ã–µ –∑–∞–ø–∏—Å–∏, –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –≤ —Å–∏—Å—Ç–µ–º–µ: iCloud, Exchange, Google, LDAP –∏ –¥—Ä—É–≥–∏–µ. –ü–æ–∑–≤–æ–ª—è–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å, –∫ –∫–∞–∫–∏–º —Å–µ—Ä–≤–∏—Å–∞–º –∏–º–µ–ª –¥–æ—Å—Ç—É–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏ –∫–∞–∫–∏–µ —É—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω–∏–ª–∏—Å—å –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ.

**–ü—É—Ç—å:**
```
~/Library/Accounts/Accounts4.sqlite
```

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
sqlite3 ~/Library/Accounts/Accounts4.sqlite \
  "SELECT ZACCOUNTTYPEDESCRIPTION, ZUSERNAME, ZDATE
   FROM ZACCOUNT
   JOIN ZACCOUNTTYPE ON ZACCOUNT.ZACCOUNTTYPE = ZACCOUNTTYPE.Z_PK
   ORDER BY ZDATE DESC;"
```

---

## 6. System Logs ‚Äî —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ª–æ–≥–∏

### 6.1 Unified Logging System
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ ‚ö†Ô∏è

**–ß—Ç–æ —ç—Ç–æ:** –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è macOS, –≤–≤–µ–¥—ë–Ω–Ω–∞—è –≤ macOS 10.12 (Sierra). –ó–∞–º–µ–Ω–∏–ª–∞ —Ä–∞–∑—Ä–æ–∑–Ω–µ–Ω–Ω—ã–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –ª–æ–≥–∏ –µ–¥–∏–Ω—ã–º –±–∏–Ω–∞—Ä–Ω—ã–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º —Å –≤—ã—Å–æ–∫–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é. –ó–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –æ—Ç –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –∏ –ø–æ–¥—Å–∏—Å—Ç–µ–º –û–°: —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –¥–µ–º–æ–Ω–æ–≤, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, —è–¥—Ä–∞, —Å–µ—Ç–µ–≤–æ–≥–æ —Å—Ç–µ–∫–∞. –•—Ä–∞–Ω–∏—Ç—Å—è –≤ –±–∏–Ω–∞—Ä–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ `.tracev3` –≤ `/private/var/db/diagnostics/`. –î–ª—è —á—Ç–µ–Ω–∏—è —Ç—Ä–µ–±—É–µ—Ç—Å—è –∫–æ–º–∞–Ω–¥–∞ `log` –∏–ª–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Ç–∏–ø–∞ Mandiant UnifiedLogReader. **–°—Ä–æ–∫ —Ö—Ä–∞–Ω–µ–Ω–∏—è: 1‚Äì4 –Ω–µ–¥–µ–ª–∏** ‚Äî —á–µ–º –±—ã—Å—Ç—Ä–µ–µ —Å–æ–±—Ä–∞–Ω—ã, —Ç–µ–º –±–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö.

**–ü—É—Ç—å:**
```
/private/var/db/diagnostics/           # –æ—Å–Ω–æ–≤–Ω—ã–µ –ª–æ–≥–∏
/private/var/db/diagnostics/Persist/   # –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–µ (–æ—Å–Ω–æ–≤–Ω–æ–π –∞—Ä—Ö–∏–≤)
/private/var/db/uuidtext/             # —Ç–∞–±–ª–∏—Ü–∞ —Å–∏–º–≤–æ–ª–æ–≤ –¥–ª—è –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è
```

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ß—Ç–æ –¥–µ–ª–∞–ª–∞ —Å–∏—Å—Ç–µ–º–∞ –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏ (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è)?
- –ë—ã–ª–∏ –ª–∏ –æ—à–∏–±–∫–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, –ø–æ–ø—ã—Ç–∫–∏ sudo?
- –ö–∞–∫–æ–µ –ü–û —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª–æ—Å—å –∏ –∫–æ–≥–¥–∞?
- –ü–æ–¥–∫–ª—é—á–∞–ª–∏—Å—å –ª–∏ –≤–Ω–µ—à–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞?
- –ë—ã–ª–∏ –ª–∏ –ø–æ–ø—ã—Ç–∫–∏ –æ–±—Ö–æ–¥–∞ TCC –∏–ª–∏ SIP?
- –ö–æ–≥–¥–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–∏ SSH-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# –ü–æ–ª–Ω—ã–π —ç–∫—Å–ø–æ—Ä—Ç –∞—Ä—Ö–∏–≤–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è ‚Äî —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ!)
sudo log collect --output /output/system_logs.logarchive

# –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–¥–∏–∫–∞—Ç—ã –¥–ª—è IR:

# –ü—Ä–æ–≤–∞–ª—ã sudo
log show --last 7d \
  --predicate 'eventMessage contains "sudo" AND eventMessage contains "COMMAND"'

# SSH-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
log show --last 7d --predicate 'process == "sshd"'

# TCC-—Å–æ–±—ã—Ç–∏—è (–∑–∞–ø—Ä–æ—Å—ã —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π)
log show --last 7d --predicate 'subsystem == "com.apple.TCC"'

# XProtect (Apple AV events)
log show --last 30d --predicate 'process contains "XProtect"'

# Screensharing (RDP/VNC)
log show --last 7d --predicate 'process == "screensharingd"'

# –ü—Ä–æ–≤–∞–ª—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
log show --last 24h \
  --predicate 'eventMessage contains "authentication" AND eventMessage contains "fail"'

# SIP-—Å–æ–±—ã—Ç–∏—è
log show --last 7d \
  --predicate 'eventMessage contains[c] "System Integrity Protection"'

# LaunchDaemon/Agent —Å–æ–±—ã—Ç–∏—è
log show --last 7d \
  --predicate 'process == "launchd" AND eventMessage contains "submitted"'

# –≠–∫—Å–ø–æ—Ä—Ç –≤ —Ç–µ–∫—Å—Ç
log show --last 7d --info > /output/unified_log_7d.txt
```

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Å–±–æ—Ä–∞:**
| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –ö–æ–º–∞–Ω–¥–∞ |
|------------|---------|
| Aftermath | –ü—Ä–µ–¥–∏–∫–∞—Ç–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞ (–Ω–µ –ø–æ–ª–Ω—ã–π –∞—Ä—Ö–∏–≤) |
| UAC | –ü–æ–ª–Ω—ã–π `.logarchive` (`files/logs/macos_unified_logs.yaml`) |
| –í—Ä—É—á–Ω—É—é | `sudo log collect --output /output/system.logarchive` |

---

### 6.2 Install Log
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü°

**–ß—Ç–æ —ç—Ç–æ:** –ñ—É—Ä–Ω–∞–ª —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è. –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Ñ–∞–∫—Ç—ã –∏–Ω—Å—Ç–∞–ª–ª—è—Ü–∏–∏ PKG-–ø–∞–∫–µ—Ç–æ–≤, —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π, –∫–æ–¥-signing –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ. –ü–æ–∑–≤–æ–ª—è–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–æ—á–Ω–æ–µ –≤—Ä–µ–º—è –∏–Ω—Å—Ç–∞–ª–ª—è—Ü–∏–∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ü–û.

**–ü—É—Ç—å:**
```
/private/var/log/install.log
/private/var/log/install.log.*   # —Ä–æ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞—Ä—Ö–∏–≤—ã
```

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
cat /private/var/log/install.log
grep -i "install\|pkg\|error\|fail" /private/var/log/install.log | tail -100
```

---

### 6.3 Crash Reports
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü°

**–ß—Ç–æ —ç—Ç–æ:** –û—Ç—á—ë—Ç—ã –æ –ø–∞–¥–µ–Ω–∏—è—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã–µ ReportCrash. –°–æ–¥–µ—Ä–∂–∞—Ç: –∏–º—è –∏ –≤–µ—Ä—Å–∏—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –≤—Ä–µ–º—è –∫—Ä–∞—à–∞, —Ç–∏–ø –∏—Å–∫–ª—é—á–µ–Ω–∏—è (signal), —Å—Ç–µ–∫—Ç—Ä–µ–π—Å, —Ä–µ–≥–∏—Å—Ç—Ä—ã CPU, –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏. –ê–Ω–æ–º–∞–ª—å–Ω–æ –±–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ crash reports –æ—Ç –æ–¥–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏–ª–∏ –∫—Ä–∞—à–∏ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ ‚Äî –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã exploit-–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏–ª–∏ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ malware.

**–ü—É—Ç—å:**
```
~/Library/Logs/DiagnosticReports/
/Library/Logs/DiagnosticReports/
/private/var/log/DiagnosticMessages/
```

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ü–∞–¥–∞–ª–∏ –ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–ø—Ä–∏–∑–Ω–∞–∫ exploit-–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏, –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ shellcode)?
- –ö–∞–∫–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∫—Ä–∞—à–∏–ª–æ—Å—å, –Ω–∞ –∫–∞–∫–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, –≤ –∫–∞–∫–æ–µ –≤—Ä–µ–º—è?
- –ï—Å—Ç—å –ª–∏ crash reports –æ—Ç –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –∏–∑ /tmp –∏–ª–∏ /var?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
ls -lt ~/Library/Logs/DiagnosticReports/
cat ~/Library/Logs/DiagnosticReports/<process>_<timestamp>.crash

# –ü–æ–∏—Å–∫ crash reports –∑–∞ –ø–µ—Ä–∏–æ–¥
find ~/Library/Logs/DiagnosticReports/ -name "*.crash" -mtime -7
```

---

### 6.4 ASL (Apple System Log) ‚Äî legacy
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢

**–ß—Ç–æ —ç—Ç–æ:** –£—Å—Ç–∞—Ä–µ–≤—à–∞—è —Å–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–æ macOS 10.12. –ù–∞ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –Ω–æ –º–æ–∂–µ—Ç –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å. –ù–∞ macOS 10.15+ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –ª–æ–≥–æ–≤ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–æ –≤ Unified Log.

**–ü—É—Ç—å:**
```
/private/var/log/asl/
```

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
syslog -f /var/log/asl/*.asl
log2timeline.py --parsers asl_log  # —á–µ—Ä–µ–∑ Plaso
```

---

## 7. Authentication ‚Äî –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

### 7.1 TCC Database (Transparency, Consent, Control)
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ ‚ö†Ô∏è

**–ß—Ç–æ —ç—Ç–æ:** SQLite-–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º—ã —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π macOS. –§–∏–∫—Å–∏—Ä—É–µ—Ç –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –Ω–∞ –¥–æ—Å—Ç—É–ø –∫ –∑–∞—â–∏—â—ë–Ω–Ω—ã–º —Ä–µ—Å—É—Ä—Å–∞–º: –º–∏–∫—Ä–æ—Ñ–æ–Ω, –∫–∞–º–µ—Ä–∞, —ç–∫—Ä–∞–Ω, –∫–æ–Ω—Ç–∞–∫—Ç—ã, –ø–æ—á—Ç–∞, Full Disk Access, –ª–æ–∫–∞—Ü–∏—è. –ö–∞–∂–¥–∞—è –∑–∞–ø–∏—Å—å —Å–æ–¥–µ—Ä–∂–∏—Ç: –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (bundle ID –∏–ª–∏ –ø—É—Ç—å), –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã–π —Ä–µ—Å—É—Ä—Å (service), —Ä–µ—à–µ–Ω–∏–µ (allow/deny/limited), timestamp –∏–∑–º–µ–Ω–µ–Ω–∏—è. –°—É—â–µ—Å—Ç–≤—É—é—Ç –¥–≤–∞ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞: —Å–∏—Å—Ç–µ–º–Ω—ã–π (—Ç—Ä–µ–±—É–µ—Ç root) –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π.

**–ü—É—Ç—å:**
```
/Library/Application Support/com.apple.TCC/TCC.db       # —Å–∏—Å—Ç–µ–º–Ω—ã–π (root)
~/Library/Application Support/com.apple.TCC/TCC.db      # –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π
```

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö–∞–∫–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø–æ–ª—É—á–∏–ª–∏ –¥–æ—Å—Ç—É–ø –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É, –∫–∞–º–µ—Ä–µ, —ç–∫—Ä–∞–Ω—É, Full Disk Access?
- –ü–æ–ª—É—á–∞–ª–æ –ª–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ –ü–û –ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è?
- –ö–æ–≥–¥–∞ –±—ã–ª–∏ –≤—ã–¥–∞–Ω—ã —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è (timestamp = –≤–æ–∑–º–æ–∂–Ω–æ–µ –≤—Ä–µ–º—è –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏)?
- –ë—ã–ª–æ –ª–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ —á–µ—Ä–µ–∑ —Å–æ–≥–ª–∞—Å–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ –æ–±—Ö–æ–¥ TCC?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# –°–∏—Å—Ç–µ–º–Ω—ã–π TCC
sudo sqlite3 /Library/Application\ Support/com.apple.TCC/TCC.db \
  "SELECT client, service,
   datetime(last_modified, 'unixepoch') as modified,
   CASE auth_value
     WHEN 0 THEN 'Denied'
     WHEN 1 THEN 'Unknown'
     WHEN 2 THEN 'Allowed'
     WHEN 3 THEN 'Limited'
   END as status
   FROM access ORDER BY last_modified DESC;"

# –ü–æ–∏—Å–∫ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
sudo sqlite3 /Library/Application\ Support/com.apple.TCC/TCC.db \
  "SELECT client, service, datetime(last_modified,'unixepoch') FROM access
   WHERE service IN (
     'kTCCServiceScreenCapture',
     'kTCCServiceAccessibility',
     'kTCCServiceSystemPolicyAllFiles',
     'kTCCServiceMicrophone',
     'kTCCServiceCamera'
   ) ORDER BY last_modified DESC;"

# mac_apt –ø–ª–∞–≥–∏–Ω
python3 mac_apt.py -i /path/to/collection TCC
```

**–ö–ª—é—á–µ–≤—ã–µ —Å–µ—Ä–≤–∏—Å—ã TCC –¥–ª—è IR:**

| Service | –ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç |
|---------|-------------|
| `kTCCServiceScreenCapture` | –ó–∞—Ö–≤–∞—Ç —ç–∫—Ä–∞–Ω–∞ (RAT, keylogger) |
| `kTCCServiceAccessibility` | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ UI (RAT, macro) |
| `kTCCServiceSystemPolicyAllFiles` | Full Disk Access (–º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞) |
| `kTCCServiceMicrophone` | –ú–∏–∫—Ä–æ—Ñ–æ–Ω (stalkerware, espionage) |
| `kTCCServiceCamera` | –ö–∞–º–µ—Ä–∞ |
| `kTCCServiceAddressBook` | –ö–æ–Ω—Ç–∞–∫—Ç—ã (data theft) |
| `kTCCServiceCalendar` | –ö–∞–ª–µ–Ω–¥–∞—Ä—å |

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Å–±–æ—Ä–∞:**
| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –ö–æ–º–∞–Ω–¥–∞ |
|------------|---------|
| Aftermath | –í–∫–ª—é—á–µ–Ω–æ (–º–æ–¥—É–ª—å databases) |
| UAC | –§–∞–π–ª –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è –≤ `full` –ø—Ä–æ—Ñ–∏–ª–µ |

---

### 7.2 Keychain
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° ‚ö†Ô∏è üîê

**–ß—Ç–æ —ç—Ç–æ:** –ó–∞—â–∏—â—ë–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –ø–∞—Ä–æ–ª–µ–π, —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤, –∫–ª—é—á–µ–π —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∏ —Ç–æ–∫–µ–Ω–æ–≤ macOS. –•—Ä–∞–Ω–∏—Ç: Wi-Fi –ø–∞—Ä–æ–ª–∏, –ø–∞—Ä–æ–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –∏ —Å–∞–π—Ç–æ–≤, –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏ SSH/TLS, API-—Ç–æ–∫–µ–Ω—ã, VPN-—É—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ. –ö–ª—é—á–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è Keychain –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ –ø–∞—Ä–æ–ª—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –î–æ—Å—Ç—É–ø –∫ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É –≤–æ–∑–º–æ–∂–µ–Ω —Ç–æ–ª—å–∫–æ –Ω–∞ –∂–∏–≤–æ–π —Å–∏—Å—Ç–µ–º–µ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –ø–∞—Ä–æ–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ‚Äî —Å –æ–±—Ä–∞–∑–∞ –¥–∏—Å–∫–∞ –ø–æ–ª—É—á–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –±–µ–∑ –ø–∞—Ä–æ–ª—è –Ω–µ–ª—å–∑—è.

**–ü—É—Ç—å:**
```
~/Library/Keychains/login.keychain-db       # –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π
/Library/Keychains/System.keychain          # —Å–∏—Å—Ç–µ–º–Ω—ã–π
~/Library/Keychains/<UUID>/               # iCloud Keychain
```

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö–∞–∫–∏–µ —É—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω–∏–ª–∏—Å—å –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ (Wi-Fi, —Å–∞–π—Ç—ã, API-—Ç–æ–∫–µ–Ω—ã)?
- –ï—Å—Ç—å –ª–∏ —Ö—Ä–∞–Ω–∏–º—ã–µ SSH-–∫–ª—é—á–∏ –∏–ª–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã?
- –ë—ã–ª–∏ –ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –Ω–µ–ª–µ–≥–∏—Ç–∏–º–Ω—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã (MITM)?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# –°–ø–∏—Å–æ–∫ –∑–∞–ø–∏—Å–µ–π keychain (–±–µ–∑ –ø–∞—Ä–æ–ª–µ–π)
security list-keychains
security dump-keychain ~/Library/Keychains/login.keychain-db

# –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–∞—Ä–æ–ª—è (–ø–æ—Ç—Ä–µ–±—É–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
security find-internet-password -s "example.com" -a "user@example.com" -w

# –ù–µ–ª–µ–≥–∏—Ç–∏–º–Ω—ã–µ –∫–æ—Ä–Ω–µ–≤—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
security find-certificate -a /Library/Keychains/System.keychain | grep "labl"

# Plaso –ø–∞—Ä—Å–µ—Ä (–¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ñ–∞–π–ª–∞)
log2timeline.py --parsers mac_keychain --storage-file timeline.plaso ~/Library/Keychains/
```

> ‚ö†Ô∏è –î–æ—Å—Ç—É–ø –∫ –ø–∞—Ä–æ–ª—è–º —Ç—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –° –æ–±—Ä–∞–∑–∞ –¥–∏—Å–∫–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ –±–µ–∑ –ø–∞—Ä–æ–ª—è.

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Å–±–æ—Ä–∞:**
| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –ö–æ–º–∞–Ω–¥–∞ |
|------------|---------|
| Plaso | `mac_keychain` –ø–∞—Ä—Å–µ—Ä (–º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –±–µ–∑ –ø–∞—Ä–æ–ª–µ–π) |
| –í—Ä—É—á–Ω—É—é | `cp -r ~/Library/Keychains/ /output/keychains/` |

---

### 7.3 Sudo Logs / Auth Logs
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥

**–ß—Ç–æ —ç—Ç–æ:** –ñ—É—Ä–Ω–∞–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã `sudo` –∏ —Å–æ–±—ã—Ç–∏–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏. –í —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º macOS (10.12+) —ç—Ç–∏ —Å–æ–±—ã—Ç–∏—è –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ Unified Logs, –∞ –Ω–µ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã. –§–∏–∫—Å–∏—Ä—É–µ—Ç: —É—Å–ø–µ—à–Ω—ã–µ –∏ –Ω–µ—É–¥–∞—á–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ sudo, –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã —Å –ø–æ–≤—ã—à–µ–Ω–∏–µ–º –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –≤—Ä–µ–º–µ–Ω–Ω—ÉÃÅ—é –º–µ—Ç–∫—É.

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# –ß–µ—Ä–µ–∑ Unified Logs (macOS 10.12+)
log show --last 7d \
  --predicate 'eventMessage contains "sudo"' | \
  grep -E "COMMAND|incorrect password|authentication failure"

# –ù–µ—É–¥–∞—á–Ω—ã–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
log show --last 24h \
  --predicate 'eventMessage contains "authentication" AND eventMessage contains "fail"'

# –í—Å–µ sudo-—Å–µ—Å—Å–∏–∏ —Å –∫–æ–º–∞–Ω–¥–∞–º–∏
log show --last 30d \
  --predicate 'process == "sudo"' | grep "TTY="
```

---

### 7.4 SSH –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –∫–ª—é—á–∏
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥

**–ß—Ç–æ —ç—Ç–æ:** –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã SSH-–∫–ª–∏–µ–Ω—Ç–∞ –∏ —Å–µ—Ä–≤–µ—Ä–∞, –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø—É–±–ª–∏—á–Ω—ã–µ –∫–ª—é—á–∏ –∏ –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. `authorized_keys` ‚Äî —Å–ø–∏—Å–æ–∫ –ø—É–±–ª–∏—á–Ω—ã—Ö –∫–ª—é—á–µ–π, –∏–º–µ—é—â–∏—Ö –ø—Ä–∞–≤–æ –≤—Ö–æ–¥–∏—Ç—å –Ω–∞ —ç—Ç—É –º–∞—à–∏–Ω—É –ø–æ SSH –±–µ–∑ –ø–∞—Ä–æ–ª—è. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ backdoor-–∫–ª—é—á–∞ –≤ `authorized_keys` ‚Äî –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –º–µ—Ö–∞–Ω–∏–∑–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞ –ø–æ—Å–ª–µ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏. –§–∞–π–ª `known_hosts` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫ –∫–∞–∫–∏–º —Ö–æ—Å—Ç–∞–º —Å–∏—Å—Ç–µ–º–∞ –ø–æ–¥–∫–ª—é—á–∞–ª–∞—Å—å –ø–æ SSH.

**–ü—É—Ç—å:**
```
~/.ssh/authorized_keys           # –∫–ª—é—á–∏ –¥–ª—è –≤—Ö–æ–¥—è—â–µ–≥–æ SSH (backdoor!)
~/.ssh/known_hosts               # –∏–∑–≤–µ—Å—Ç–Ω—ã–µ —Ö–æ—Å—Ç—ã (–∏—Å—Ç–æ—Ä–∏—è SSH-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π)
~/.ssh/config                    # –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è SSH-–∫–ª–∏–µ–Ω—Ç–∞
~/.ssh/id_*                      # –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏
/etc/ssh/sshd_config             # –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è SSH-—Å–µ—Ä–≤–µ—Ä–∞
```

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –î–æ–±–∞–≤–ª–µ–Ω—ã –ª–∏ –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ SSH-–∫–ª—é—á–∏ (backdoor access)?
- –ö –∫–∞–∫–∏–º —Ö–æ—Å—Ç–∞–º –ø–æ–¥–∫–ª—é—á–∞–ª–∞—Å—å —Å–∏—Å—Ç–µ–º–∞ –ø–æ SSH (lateral movement)?
- –í–∫–ª—é—á—ë–Ω –ª–∏ SSH-—Å–µ—Ä–≤–µ—Ä? (Remote Login)
- –ï—Å—Ç—å –ª–∏ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ sshd (—Ä–∞–∑—Ä–µ—à—ë–Ω root-–≤—Ö–æ–¥)?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# –°—Ç–∞—Ç—É—Å SSH-—Å–µ—Ä–≤–µ—Ä–∞
sudo systemsetup -getremotelogin

# –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–ª—é—á–∏
cat ~/.ssh/authorized_keys
# ALERT: –ª—é–±–æ–π –∫–ª—é—á –∑–¥–µ—Å—å –∫—Ä–æ–º–µ –æ–∂–∏–¥–∞–µ–º–æ–≥–æ = –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π backdoor

# –ò—Å—Ç–æ—Ä–∏—è SSH-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
cat ~/.ssh/known_hosts

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è sshd
grep -v "^#\|^$" /etc/ssh/sshd_config

# SSH —á–µ—Ä–µ–∑ Unified Logs
log show --last 7d --predicate 'process == "sshd"'
```

---

### 7.5 –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–∏—Å—Ç–µ–º—ã
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü°

**–ß—Ç–æ —ç—Ç–æ:** –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ª–æ–∫–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –≥—Ä—É–ø–ø macOS. –•—Ä–∞–Ω–∏—Ç—Å—è –≤ DirectoryService. –ü–æ–∑–≤–æ–ª—è–µ—Ç –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å —Å–∫—Ä—ã—Ç—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (UID < 500, —Å–∫—Ä—ã—Ç—ã–µ –æ—Ç loginwindow) –∏–ª–∏ –Ω–µ–∑–∞–∫–æ–Ω–Ω–æ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã, —á—Ç–æ —è–≤–ª—è–µ—Ç—Å—è –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–º –ø—Ä–∏–∑–Ω–∞–∫–æ–º APT-–ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏—è.

**–ü—É—Ç—å:**
```
/private/var/db/dslocal/nodes/Default/users/
/etc/passwd ‚Üí /private/etc/passwd
```

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å UID
dscl . -list /Users UniqueID | sort -k2 -n

# –¢–æ–ª—å–∫–æ —Ä–µ–∞–ª—å–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (UID >= 500)
dscl . -list /Users UniqueID | awk '$2 >= 500'

# –ì—Ä—É–ø–ø–∞ admin (–∫—Ç–æ –∏–º–µ–µ—Ç sudo?)
dscl . -read /Groups/admin GroupMembership

# –°–∫—Ä—ã—Ç—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (–ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ backdoor-–∞–∫–∫–∞—É–Ω—Ç—ã)
dscl . -list /Users IsHidden | grep -v "^_\|Nobody"

# –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å shell-–¥–æ—Å—Ç—É–ø–æ–º
dscl . -list /Users UserShell | grep -v "nologin\|false"
```

---

### 7.6 –ò—Å—Ç–æ—Ä–∏—è –≤—Ö–æ–¥–æ–≤
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü°

**–ß—Ç–æ —ç—Ç–æ:** –ó–∞–ø–∏—Å–∏ –æ –≤—Ö–æ–¥–∞—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Å–∏—Å—Ç–µ–º—É (login sessions). –ü–æ–∑–≤–æ–ª—è–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å, –∫—Ç–æ –∏ –∫–æ–≥–¥–∞ –≤—Ö–æ–¥–∏–ª –≤ —Å–∏—Å—Ç–µ–º—É, –±—ã–ª–∏ –ª–∏ –≤—Ö–æ–¥—ã –≤ –Ω–µ—Ä–∞–±–æ—á–µ–µ –≤—Ä–µ–º—è –∏–ª–∏ —Å –Ω–µ—Ç–∏–ø–∏—á–Ω—ã—Ö IP (–¥–ª—è remote login).

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# –ü–æ—Å–ª–µ–¥–Ω–∏–µ –≤—Ö–æ–¥—ã
last | head -30

# –í—Ö–æ–¥—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
last username

# –ß–µ—Ä–µ–∑ Unified Logs
log show --last 30d \
  --predicate 'process == "loginwindow" OR subsystem == "com.apple.loginwindow"'
```

---

## 8. Applications ‚Äî –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### 8.1 –ò—Å—Ç–æ—Ä–∏—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ü–û
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü°

**–ß—Ç–æ —ç—Ç–æ:** Plist-—Ñ–∞–π–ª —Å —Ö—Ä–æ–Ω–æ–ª–æ–≥–∏–µ–π –≤—Å–µ—Ö —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö PKG-–ø–∞–∫–µ—Ç–æ–≤ –∏ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π. –ö–∞–∂–¥–∞—è –∑–∞–ø–∏—Å—å —Å–æ–¥–µ—Ä–∂–∏—Ç: –∏–º—è –ø–∞–∫–µ—Ç–∞, –≤–µ—Ä—Å–∏—é, –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞, –¥–∞—Ç—É —É—Å—Ç–∞–Ω–æ–≤–∫–∏. –Ø–≤–ª—è–µ—Ç—Å—è –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–º –Ω–∞–¥—ë–∂–Ω—ã–º –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º —Ç–æ—á–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –∏–Ω—Å—Ç–∞–ª–ª—è—Ü–∏–∏ PKG-–ø–∞–∫–µ—Ç–æ–≤.

**–ü—É—Ç—å:**
```
/Library/Receipts/InstallHistory.plist
/private/var/db/receipts/
```

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö–æ–≥–¥–∞ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª–æ—Å—å –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ?
- –ï—Å—Ç—å –ª–∏ PKG-–∏–Ω—Å—Ç–∞–ª–ª—è—Ü–∏–∏ –≤ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–µ –≤—Ä–µ–º—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–æ—á—å—é)?
- –ö–µ–º –ø–æ–¥–ø–∏—Å–∞–Ω —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –ø–∞–∫–µ—Ç?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
plutil -p /Library/Receipts/InstallHistory.plist

# –ü–æ—Å–ª–µ–¥–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
plutil -p /Library/Receipts/InstallHistory.plist | \
  grep -E "displayName|displayVersion|date|packageIdentifiers" | tail -40

# –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ PKG (–∏–∑ receipts)
pkgutil --pkgs
pkgutil --pkg-info com.suspicious.package
```

---

### 8.2 Code Signing –∏ Gatekeeper Assessments
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü°

**–ß—Ç–æ —ç—Ç–æ:** Gatekeeper ‚Äî –º–µ—Ö–∞–Ω–∏–∑–º macOS, –ø—Ä–æ–≤–µ—Ä—è—é—â–∏–π —Ü–∏—Ñ—Ä–æ–≤—É—é –ø–æ–¥–ø–∏—Å—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º. –ó–∞–ø–∏—Å–∏ –æ–± –æ—Ü–µ–Ω–∫–∞—Ö (assessments) —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ SQLite. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è –±–µ–∑ –ø–æ–¥–ø–∏—Å–∏ –∏–ª–∏ —Å –æ—Ç–æ–∑–≤–∞–Ω–Ω—ã–º —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–º –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è Gatekeeper. –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∏ –æ–±—Ö–æ–¥—è—Ç —ç—Ç–æ –ª–∏–±–æ —á–µ—Ä–µ–∑ —Å–æ—Ü–∏–∞–ª—å–Ω—É—é –∏–Ω–∂–µ–Ω–µ—Ä–∏—é, –ª–∏–±–æ —á–µ—Ä–µ–∑ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ Gatekeeper, –ª–∏–±–æ —Å –ø–æ–º–æ—â—å—é –∫—Ä–∞–¥–µ–Ω—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤.

**–ü—É—Ç—å:**
```
/private/var/db/SystemPolicyConfiguration/ExecPolicy
```

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# –°—Ç–∞—Ç—É—Å Gatekeeper
spctl --status

# –ò—Å–∫–ª—é—á–µ–Ω–∏—è Gatekeeper
spctl --list

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
codesign -dvvv /Applications/SuspiciousApp.app
spctl -a -vvv /Applications/SuspiciousApp.app

# –ü—Ä–æ–≤–µ—Ä–∫–∞ notarization
spctl --assess --verbose=4 --type exec /Applications/SuspiciousApp.app
```

---

### 8.3 CUPS (–ñ—É—Ä–Ω–∞–ª –ø–µ—á–∞—Ç–∏)
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢

**–ß—Ç–æ —ç—Ç–æ:** CUPS (Common Unix Printing System) ‚Äî —Å–∏—Å—Ç–µ–º–∞ –ø–µ—á–∞—Ç–∏ macOS. –í–µ–¥—ë—Ç –∂—É—Ä–Ω–∞–ª –≤—Å–µ—Ö –∑–∞–¥–∞–Ω–∏–π –Ω–∞ –ø–µ—á–∞—Ç—å: –∏–º—è —Ñ–∞–π–ª–∞, –ø—Ä–∏–Ω—Ç–µ—Ä, –≤—Ä–µ–º—è, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å. –í —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è—Ö –∏–Ω—Å–∞–π–¥–µ—Ä—Å–∫–∏—Ö —É–≥—Ä–æ–∑ –∏–ª–∏ —É—Ç–µ—á–µ–∫ –¥–∞–Ω–Ω—ã—Ö –∂—É—Ä–Ω–∞–ª—ã CUPS –º–æ–≥—É—Ç –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —Ñ–∞–∫—Ç —Ä–∞—Å–ø–µ—á–∞—Ç–∫–∏ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤.

**–ü—É—Ç—å:**
```
/private/var/log/cups/access_log
/private/var/log/cups/error_log
/private/var/log/cups/page_log         # –¥–µ—Ç–∞–ª—å–Ω—ã–π –∂—É—Ä–Ω–∞–ª —Å—Ç—Ä–∞–Ω–∏—Ü
```

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö–∞–∫–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –ø–µ—á–∞—Ç–∞–ª–∏—Å—å –∏ –∫–æ–≥–¥–∞?
- –ù–∞ –∫–∞–∫–æ–π –ø—Ä–∏–Ω—Ç–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–ª–∏—Å—å –∑–∞–¥–∞–Ω–∏—è?
- –ï—Å—Ç—å –ª–∏ —Ñ–∞–∫—Ç—ã —Ä–∞—Å–ø–µ—á–∞—Ç–∫–∏ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ (–∏–Ω—Å–∞–π–¥–µ—Ä—Å–∫–∞—è —É–≥—Ä–æ–∑–∞)?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
cat /private/var/log/cups/page_log
cat /private/var/log/cups/access_log | grep -i "print"

# –ß–µ—Ä–µ–∑ Plaso
log2timeline.py --parsers cups_ipp --storage-file timeline.plaso /
```

---

### 8.4 Application Preferences (plist)
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢

**–ß—Ç–æ —ç—Ç–æ:** Plist-—Ñ–∞–π–ª—ã –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –≤ `~/Library/Preferences/`. –°–æ–¥–µ—Ä–∂–∞—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, –≤ —Ç–æ–º —á–∏—Å–ª–µ –ø—É—Ç–∏ –∫ –ø–æ—Å–ª–µ–¥–Ω–∏–º —Ñ–∞–π–ª–∞–º, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∏, —É—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å–æ–≤. –ù–∞–ø—Ä–∏–º–µ—Ä, `com.apple.finder.plist` —Ö—Ä–∞–Ω–∏—Ç –∏—Å—Ç–æ—Ä–∏—é –ø–æ—Å–µ—â—ë–Ω–Ω—ã—Ö –ø–∞–ø–æ–∫ –≤ Finder.

**–ü—É—Ç—å:**
```
~/Library/Preferences/*.plist
/Library/Preferences/*.plist
```

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# Finder ‚Äî –ø–æ—Å–ª–µ–¥–Ω–∏–µ –ø–∞–ø–∫–∏
plutil -p ~/Library/Preferences/com.apple.finder.plist

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
plutil -p ~/Library/Preferences/com.example.app.plist

# –ü–æ–∏—Å–∫ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º
grep -r "password\|token\|secret\|api_key" \
  ~/Library/Preferences/ 2>/dev/null
```

---

## 9. Cloud & Sync

### 9.1 Time Machine
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü°

**–ß—Ç–æ —ç—Ç–æ:** –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è macOS. –°–æ–∑–¥–∞—ë—Ç –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –∫–æ–ø–∏–∏ —Å–∏—Å—Ç–µ–º—ã —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ãÃÅ—Ö –º–µ—Ç–æ–∫. –î–ª—è IR: –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã **–¥–æ** –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏, —Å—Ä–∞–≤–Ω–∏—Ç—å —Ñ–∞–π–ª—ã, –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —É–¥–∞–ª—ë–Ω–Ω—ã–µ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–æ–º –¥–∞–Ω–Ω—ã–µ. –õ–æ–∫–∞–ª—å–Ω—ã–µ —Å–Ω–∞–ø—à–æ—Ç—ã APFS (Time Machine Snapshots) —Ö—Ä–∞–Ω—è—Ç—Å—è –ø—Ä—è–º–æ –Ω–∞ –¥–∏—Å–∫–µ ‚Äî –¥–æ—Å—Ç—É–ø–Ω—ã –±–µ–∑ –≤–Ω–µ—à–Ω–µ–≥–æ –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—è.

**–ü—É—Ç—å:**
```
/Volumes/Time Machine Backups/Backups.backupdb/
–õ–æ–∫–∞–ª—å–Ω—ã–µ —Å–Ω–∞–ø—à–æ—Ç—ã: APFS snapshots –Ω–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–º —Ç–æ–º–µ
```

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ï—Å—Ç—å –ª–∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –≤–µ—Ä—Å–∏–∏ —Ñ–∞–π–ª–æ–≤ –¥–æ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏?
- –ú–æ–∂–Ω–æ –ª–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ–∞–π–ª—ã, —É–¥–∞–ª—ë–Ω–Ω—ã–µ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–æ–º?
- –ö–∞–∫ –≤—ã–≥–ª—è–¥–µ–ª–∞ —Å–∏—Å—Ç–µ–º–∞ –¥–æ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ LaunchAgents/cron?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# –°–ø–∏—Å–æ–∫ –ª–æ–∫–∞–ª—å–Ω—ã—Ö APFS —Å–Ω–∞–ø—à–æ—Ç–æ–≤
tmutil listlocalsnapshots /

# –ò—Å—Ç–æ—Ä–∏—è —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π
tmutil listbackups

# –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ –≤ backup —Å —Ç–µ–∫—É—â–∏–º
tmutil compare / /Volumes/Backups.backupdb/<hostname>/<date>/
```

---

### 9.2 iCloud Drive
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü°

**–ß—Ç–æ —ç—Ç–æ:** –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–±–ª–∞—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ Apple. –§–∞–π–ª—ã –≤ iCloud Drive –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–∫–∞—á–∞–Ω—ã –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ (optimized storage) ‚Äî –Ω–∞ –¥–∏—Å–∫–µ —Ö—Ä–∞–Ω—è—Ç—Å—è —Ç–æ–ª—å–∫–æ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∏ —Ñ–∞–π–ª–æ–≤—ã–µ –∑–∞–≥–ª—É—à–∫–∏. –ü—Ä–∏ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏ —ç–∫—Å—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –≤–∞–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –∫–∞–∫–∏–µ —Ñ–∞–π–ª—ã –º–æ–≥–ª–∏ –±—ã—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω—ã –≤ –æ–±–ª–∞–∫–æ.

**–ü—É—Ç—å:**
```
~/Library/Mobile Documents/
~/Library/CloudStorage/iCloud Drive/
```

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö–∞–∫–∏–µ —Ñ–∞–π–ª—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–ª–∏—Å—å –≤ iCloud (–≤–æ–∑–º–æ–∂–Ω–∞—è –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —ç–∫—Å—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è)?
- –ö–∞–∫–∏–µ —Ñ–∞–π–ª—ã –±—ã–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ iCloud –≤ –ø–µ—Ä–∏–æ–¥ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
ls -la ~/Library/Mobile\ Documents/
# –§–∞–π–ª—ã —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º .icloud ‚Äî –Ω–µ —Å–∫–∞—á–∞–Ω—ã, —Ç–æ–ª—å–∫–æ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
find ~/Library/Mobile\ Documents/ -name "*.icloud" | head -20
```

---

### 9.3 Dropbox / Google Drive / OneDrive
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢

**–ß—Ç–æ —ç—Ç–æ:** –°—Ç–æ—Ä–æ–Ω–Ω–∏–µ –æ–±–ª–∞—á–Ω—ã–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞, —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Ñ–∞–π–ª–æ–≤. –ü—Ä–∏ –∏–Ω—Å–∞–π–¥–µ—Ä—Å–∫–∏—Ö —É–≥—Ä–æ–∑–∞—Ö –∏–ª–∏ APT-—ç–∫—Å—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ—Ä–µ–¥–∫–æ –≤—ã–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ Dropbox –∏–ª–∏ Google Drive –∫–∞–∫ –º–µ–Ω–µ–µ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã–µ –∫–∞–Ω–∞–ª—ã. –õ–æ–≥–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤ —Ö—Ä–∞–Ω—è—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –æ–ø–µ—Ä–∞—Ü–∏—è—Ö —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏.

**–ü—É—Ç—å:**
```
~/Library/Application Support/Dropbox/
~/Dropbox/.dropbox.cache/
~/Library/Application Support/Google/DriveFS/
~/Library/Logs/Google/Drive/
```

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# Dropbox –ª–æ–≥–∏
find ~/Library/Application\ Support/Dropbox/ -name "*.log" | \
  xargs grep -i "upload\|sync" 2>/dev/null

# Google Drive –ª–æ–≥–∏
ls ~/Library/Logs/Google/Drive/
```

---

## 10. Security State ‚Äî —Å–æ—Å—Ç–æ—è–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### 10.1 System Integrity Protection (SIP)
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥

**–ß—Ç–æ —ç—Ç–æ:** –ú–µ—Ö–∞–Ω–∏–∑–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ macOS, –∑–∞—â–∏—â–∞—é—â–∏–π —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Ñ–∞–π–ª—ã –∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –æ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–∞–∂–µ root-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º. –ó–∞—â–∏—â–∞–µ—Ç: `/System`, `/usr`, `/bin`, `/sbin`, —Å–∏—Å—Ç–µ–º–Ω—ã–µ LaunchDaemons. **–û—Ç–∫–ª—é—á—ë–Ω–Ω—ã–π SIP ‚Äî –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä: –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Å—Ç–∏ –ª–µ–≥–∏—Ç–∏–º–Ω—É—é –æ–ø–µ—Ä–∞—Ü–∏—é –Ω–∞ production-—Å–∏—Å—Ç–µ–º–µ —Å –æ—Ç–∫–ª—é—á—ë–Ω–Ω—ã–º SIP –±–µ–∑ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ Recovery Mode.**

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –û—Ç–∫–ª—é—á—ë–Ω –ª–∏ SIP (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –ø—Ä–∏–∑–Ω–∞–∫ –≥–ª—É–±–æ–∫–æ–π –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏ –∏–ª–∏ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å–∏—Å—Ç–µ–º—ã)?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
csrutil status
# Expected: "System Integrity Protection status: enabled."
# CRITICAL ALERT: –ª—é–±–æ–µ –¥—Ä—É–≥–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ç—Ä–µ–±—É–µ—Ç –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è

# –î–µ—Ç–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å (macOS 11+)
csrutil status --verbose
```

---

### 10.2 Gatekeeper –∏ XProtect
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥

**–ß—Ç–æ —ç—Ç–æ:** **Gatekeeper** ‚Äî –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–¥–ø–∏—Å–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º. **XProtect** ‚Äî –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –∞–Ω—Ç–∏–≤–∏—Ä—É—Å Apple –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–∏–≥–Ω–∞—Ç—É—Ä, –æ–±–Ω–æ–≤–ª—è–µ–º—ã–π —á–µ—Ä–µ–∑ Apple Updates. XProtect –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ñ–∞–π–ª—ã –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ. –í–µ—Ä—Å–∏—è XProtect —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –∑–∞—â–∏—Ç—ã.

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# Gatekeeper —Å—Ç–∞—Ç—É—Å
spctl --status
# Expected: "assessments enabled"

# XProtect –≤–µ—Ä—Å–∏—è –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
defaults read /Library/Apple/System/Library/CoreServices/XProtect.bundle/\
Contents/Resources/XProtect.meta.plist

# –õ–æ–≥ XProtect —á–µ—Ä–µ–∑ Unified Logs
log show --last 30d \
  --predicate 'process contains "XProtect" OR process contains "MRT"'
```

---

### 10.3 FileVault —Å—Ç–∞—Ç—É—Å
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü°

**–ß—Ç–æ —ç—Ç–æ:** –ü–æ–ª–Ω–æ–¥–∏—Å–∫–æ–≤–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ APFS –Ω–∞ –±–∞–∑–µ AES-XTS. –ü—Ä–∏ –≤–∫–ª—é—á—ë–Ω–Ω–æ–º FileVault –±–µ–∑ –≤–≤–æ–¥–∞ –ø–∞—Ä–æ–ª—è/–∫–ª—é—á–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –∞–Ω–∞–ª–∏–∑ –æ–±—Ä–∞–∑–∞ –¥–∏—Å–∫–∞ –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω. –í–ª–∏—è–µ—Ç –Ω–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏—é —Å–±–æ—Ä–∞: —Å –∂–∏–≤–æ–π —Å–∏—Å—Ç–µ–º—ã (–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–π) –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –¥–æ—Å—Ç—É–ø–Ω—ã, —Å –≤—ã–∫–ª—é—á–µ–Ω–Ω–æ–π ‚Äî —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –∫–ª—é—á–∞.

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
fdesetup status
diskutil apfs listVolumeGroups

# –ö–ª—é—á–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è (–µ—Å—Ç—å –ª–∏ –∏–Ω—Å—Ç–∏—Ç—É—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∫–ª—é—á?)
fdesetup list
```

---

### 10.4 –°–æ—Å—Ç–æ—è–Ω–∏–µ Secure Boot / T2 / Apple Silicon
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü°

**–ß—Ç–æ —ç—Ç–æ:** –ù–∞ Mac —Å —á–∏–ø–æ–º T2 (Intel, 2018+) –∏–ª–∏ Apple Silicon (M1/M2/M3/M4) —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã–π Secure Boot. –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –∑–∞–≥—Ä—É–∑–∫—É —Ç–æ–ª—å–∫–æ –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ–≥–æ –ü–û Apple. –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–π Security Policy (–ø–æ–Ω–∏–∂–µ–Ω–∏–µ –¥–æ Reduced/Permissive) ‚Äî –ø—Ä–∏–∑–Ω–∞–∫ –≤–æ–∑–º–æ–∂–Ω–æ–π –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∑–∞–≥—Ä—É–∑—á–∏–∫–∞.

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# –ù–∞ Apple Silicon / T2
bputil -d

# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —á–∏–ø–µ
system_profiler SPHardwareDataType | grep "Chip\|Model"
```

---

## 11. Memory & Volatile Data

### 11.1 –î–∞–º–ø –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏ ‚è±Ô∏è
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° ‚ö†Ô∏è

**–ß—Ç–æ —ç—Ç–æ:** –°–Ω–∞–ø—à–æ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏ —Å–∏—Å—Ç–µ–º—ã. –°–æ–¥–µ—Ä–∂–∏—Ç: –∑–∞–ø—É—â–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –∏ –∏—Ö –¥–∞–Ω–Ω—ã–µ –≤ –ø–∞–º—è—Ç–∏, –∫–ª—é—á–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è, —Å–µ—Ç–µ–≤—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã, —Å—Ç—Ä–æ–∫–∏ –≤ –ø–∞–º—è—Ç–∏, injected shellcode, art–µ—Ñ–∞–∫—Ç—ã fileless malware, –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –≤ –ø–∞–º—è—Ç–∏. –ù–∞ macOS —Å –≤–∫–ª—é—á—ë–Ω–Ω—ã–º SIP –ø–æ–ª—É—á–∏—Ç—å –ø–æ–ª–Ω—ã–π –¥–∞–º–ø RAM –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —Å–ª–æ–∂–Ω–µ–µ, —á–µ–º –Ω–∞ Linux –∏–ª–∏ Windows.

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ï—Å—Ç—å –ª–∏ –≤ –ø–∞–º—è—Ç–∏ fileless malware (–±–µ–∑ —Ñ–∞–π–ª–∞ –Ω–∞ –¥–∏—Å–∫–µ)?
- –ö–∞–∫–∏–µ –∫–ª—é—á–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∏–ª–∏ credential –º–∞—Ç–µ—Ä–∏–∞–ª—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏?
- –ï—Å—Ç—å –ª–∏ injected shellcode –≤ –ø—Ä–æ—Ü–µ—Å—Å–∞—Ö?
- –ö–∞–∫–∏–µ —Å–µ—Ç–µ–≤—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–ª–∏ –≤ –º–æ–º–µ–Ω—Ç —Å–Ω–∞–ø—à–æ—Ç–∞?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# osxpmem (—Ç—Ä–µ–±—É–µ—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–Ω–æ–≥–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è, SIP –º–æ–∂–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å)
sudo osxpmem memory.aff4

# Volatility3 –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–º–ø–∞
python3 vol.py -f memory.raw mac.pslist
python3 vol.py -f memory.raw mac.netstat
python3 vol.py -f memory.raw mac.lsof
python3 vol.py -f memory.raw mac.bash   # bash history –∏–∑ –ø–∞–º—è—Ç–∏
python3 vol.py -f memory.raw mac.malfind  # –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–≥–∏–æ–Ω—ã –ø–∞–º—è—Ç–∏
```

> ‚ö†Ô∏è SIP –±–ª–æ–∫–∏—Ä—É–µ—Ç –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –º–µ—Ç–æ–¥–æ–≤ –ø–æ–ª—É—á–µ–Ω–∏—è RAM-–¥–∞–º–ø–∞. –¢—Ä–µ–±—É–µ—Ç –ª–∏–±–æ –æ—Ç–∫–ª—é—á—ë–Ω–Ω—ã–π SIP, –ª–∏–±–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π kext. –ö–æ–º–º–µ—Ä—á–µ—Å–∫–∞—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: MacQuisition (BlackBag/Cellebrite).

---

### 11.2 –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è ‚è±Ô∏è
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü°

**–ß—Ç–æ —ç—Ç–æ:** –ù–∞–±–æ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, –æ–ø—Ä–µ–¥–µ–ª—è—é—â–∏—Ö —Å—Ä–µ–¥—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤. –ú–æ–≥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø—É—Ç–∏ –∫ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º, API-–∫–ª—é—á–∏, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–∫—Å–∏. –í–∞–∂–Ω—ã –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ —Ç–æ–≥–æ, –≤ –∫–∞–∫–æ–π —Å—Ä–µ–¥–µ —Ä–∞–±–æ—Ç–∞–ª –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å.

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
printenv
env
# –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
ps ewwp <PID>
```

---

### 11.3 –û—Ç–∫—Ä—ã—Ç—ã–µ —Ñ–∞–π–ª–æ–≤—ã–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã ‚è±Ô∏è
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥

**–ß—Ç–æ —ç—Ç–æ:** –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –æ—Ç–∫—Ä—ã—Ç—ã—Ö —Ñ–∞–π–ª–æ–≤, —Å–æ–∫–µ—Ç–æ–≤, pipe'–æ–≤ –∏ –¥—Ä—É–≥–∏—Ö –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞. `lsof` (List Open Files) ‚Äî –æ–¥–∏–Ω –∏–∑ –Ω–∞–∏–±–æ–ª–µ–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –Ω–∞ –∂–∏–≤–æ–π —Å–∏—Å—Ç–µ–º–µ.

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# –í—Å–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ —Ñ–∞–π–ª—ã –∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
sudo lsof -n > lsof_full.txt

# –¢–æ–ª—å–∫–æ —Å–µ—Ç–µ–≤—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
sudo lsof -i -n -P

# –§–∞–π–ª—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
sudo lsof -p <PID>

# –ö—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ñ–∞–π–ª
lsof /path/to/file
```

---

## 12. External Devices

### 12.1 USB –∏ –≤–Ω–µ—à–Ω–∏–µ —Ç–æ–º–∞
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü°

**–ß—Ç–æ —ç—Ç–æ:** –ò—Å—Ç–æ—Ä–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤–Ω–µ—à–Ω–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤: USB-–Ω–∞–∫–æ–ø–∏—Ç–µ–ª–∏, –≤–Ω–µ—à–Ω–∏–µ –¥–∏—Å–∫–∏, —Å–º–∞—Ä—Ç—Ñ–æ–Ω—ã. –í macOS –Ω–µ—Ç —Ä–µ–µ—Å—Ç—Ä–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –∫–∞–∫ –≤ Windows, –Ω–æ —Å–æ–±—ã—Ç–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è/–æ—Ç–∫–ª—é—á–µ–Ω–∏—è —Ñ–∏–∫—Å–∏—Ä—É—é—Ç—Å—è –≤ Unified Logs –∏ FSEvents. –ö–∞–∂–¥—ã–π –ø–æ–¥–∫–ª—é—á—ë–Ω–Ω—ã–π —Ç–æ–º —Å–æ–∑–¥–∞—ë—Ç —Å–≤–æ–π `.fseventsd` ‚Äî –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö–∞–∫–∏–µ USB-—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –ø–æ–¥–∫–ª—é—á–∞–ª–∏—Å—å –∫ —Å–∏—Å—Ç–µ–º–µ –∏ –∫–æ–≥–¥–∞?
- –ï—Å—Ç—å –ª–∏ –ø—Ä–∏–∑–Ω–∞–∫–∏ —ç–∫—Å—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ USB (—Å–æ–±—ã—Ç–∏—è –≤ FSEvents)?
- –ö–∞–∫–∏–µ —Ç–æ–º–∞ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–ª–∏—Å—å –∏ –¥–µ–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–ª–∏—Å—å?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# –ò—Å—Ç–æ—Ä–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π —á–µ—Ä–µ–∑ Unified Logs
log show --last 30d \
  --predicate 'subsystem == "com.apple.DiskArbitration"' | \
  grep -i "appear\|disappear\|mount\|unmount"

# –¢–µ–∫—É—â–∏–µ —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–æ–º–∞
diskutil list
mount

# USB-—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —á–µ—Ä–µ–∑ system_profiler
system_profiler SPUSBDataType

# FSEvents –Ω–∞ –≤–Ω–µ—à–Ω–∏—Ö —Ç–æ–º–∞—Ö
ls /Volumes/
sudo ls /Volumes/<VolumeName>/.fseventsd/ 2>/dev/null
```

---

### 12.2 Bluetooth
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢

**–ß—Ç–æ —ç—Ç–æ:** –ò—Å—Ç–æ—Ä–∏—è Bluetooth-—Å–æ–ø—Ä—è–∂–µ–Ω–∏–π –∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π. –ú–æ–∂–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å, –∫–∞–∫–∏–µ –≤–Ω–µ—à–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (–Ω–∞—É—à–Ω–∏–∫–∏, –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã, —Å–º–∞—Ä—Ç—Ñ–æ–Ω—ã) –±—ã–ª–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –∫ Mac. –í KnowledgeC.db —Ñ–∏–∫—Å–∏—Ä—É—é—Ç—Å—è Bluetooth-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –≤—Ä–µ–º–µ–Ω–Ω—ãÃÅ–º–∏ –º–µ—Ç–∫–∞–º–∏.

**–ü—É—Ç—å:**
```
/Library/Preferences/com.apple.Bluetooth.plist
```

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
plutil -p /Library/Preferences/com.apple.Bluetooth.plist

# –ß–µ—Ä–µ–∑ Unified Logs
log show --last 7d \
  --predicate 'subsystem contains "bluetooth"' | \
  grep -i "connect\|pair\|device"
```

---

## 13. Email & Communication

### 13.1 Apple Mail
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü°

**–ß—Ç–æ —ç—Ç–æ:** –ü–æ—á—Ç–æ–≤—ã–π –∫–ª–∏–µ–Ω—Ç macOS. –•—Ä–∞–Ω–∏—Ç –ø–∏—Å—å–º–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ `.emlx` (–æ–¥–∏–Ω —Ñ–∞–π–ª = –æ–¥–Ω–æ –ø–∏—Å—å–º–æ), –≤–ª–æ–∂–µ–Ω–∏—è ‚Äî –æ—Ç–¥–µ–ª—å–Ω–æ, –∏–Ω–¥–µ–∫—Å ‚Äî –≤ SQLite. –ö—Ä–∏—Ç–∏—á–µ–Ω –¥–ª—è —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π —Å–ø–∏—Ä-—Ñ–∏—à–∏–Ω–≥–∞, –∏–Ω—Å–∞–π–¥–µ—Ä—Å–∫–∏—Ö —É–≥—Ä–æ–∑, —É—Ç–µ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É—é –ø–æ—á—Ç—É.

**–ü—É—Ç—å:**
```
~/Library/Mail/V10/           # macOS Sonoma (V10)
~/Library/Mail/V9/            # macOS Ventura (V9)
~/Library/Containers/com.apple.mail/Data/Library/Mail/
```

**–ù–∞ –∫–∞–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–∞–µ—Ç:**
- –ö–∞–∫–∏–µ –ø–∏—Å—å–º–∞ –ø–æ–ª—É—á–∞–ª/–æ—Ç–ø—Ä–∞–≤–ª—è–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å?
- –ë—ã–ª–∏ –ª–∏ –ø–æ–ª—É—á–µ–Ω—ã —Ñ–∏—à–∏–Ω–≥–æ–≤—ã–µ –ø–∏—Å—å–º–∞ —Å –≤–ª–æ–∂–µ–Ω–∏—è–º–∏?
- –ü–µ—Ä–µ—Å—ã–ª–∞–ª–∏—Å—å –ª–∏ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞ –≤–Ω–µ—à–Ω–∏–µ –∞–¥—Ä–µ—Å–∞?

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# –ü–æ–∏—Å–∫ –ø–∏—Å–µ–º —Å –≤–ª–æ–∂–µ–Ω–∏—è–º–∏
find ~/Library/Mail/ -name "*.emlx" | xargs grep -l "attachment" 2>/dev/null

# mac_apt –ø–ª–∞–≥–∏–Ω
python3 mac_apt.py -i /path/to/collection IMAIL
```

---

### 13.2 Messages (iMessage / SMS)
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü°

**–ß—Ç–æ —ç—Ç–æ:** –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ Messages —Ö—Ä–∞–Ω–∏—Ç –∏—Å—Ç–æ—Ä–∏—é iMessage –∏ SMS-—Å–æ–æ–±—â–µ–Ω–∏–π –≤ SQLite. –ú–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å: –ø–µ—Ä–µ–ø–∏—Å–∫—É –æ–± –∏–Ω—Ü–∏–¥–µ–Ω—Ç–µ, –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ñ–∏—à–∏–Ω–≥–æ–≤—ã–µ —Å—Å—ã–ª–∫–∏, –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—é –∏–Ω—Å–∞–π–¥–µ—Ä—Å–∫–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

**–ü—É—Ç—å:**
```
~/Library/Messages/chat.db
~/Library/Messages/Attachments/
```

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# –í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è
sqlite3 ~/Library/Messages/chat.db \
  "SELECT datetime(date/1000000000 + 978307200, 'unixepoch') as time,
   is_from_me, text
   FROM message ORDER BY date DESC LIMIT 100;"

# mac_apt –ø–ª–∞–≥–∏–Ω
python3 mac_apt.py -i /path/to/collection IMESSAGE
```

---

### 13.3 Slack (–∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä)
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü°

**–ß—Ç–æ —ç—Ç–æ:** –ö–ª–∏–µ–Ω—Ç Slack –¥–ª—è macOS —Ö—Ä–∞–Ω–∏—Ç –ª–æ–∫–∞–ª—å–Ω—ã–π –∫—ç—à —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –¥–∞–Ω–Ω—ã–µ –æ —Ä–∞–±–æ—á–∏—Ö –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞—Ö –≤ LevelDB –∏ SQLite. –ú–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é –ø–µ—Ä–µ–ø–∏—Å–∫–∏ –¥–∞–∂–µ –ø—Ä–∏ –æ—Ç–∑—ã–≤–µ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞. Aftermath —Å–æ–±–∏—Ä–∞–µ—Ç Slack-–¥–∞–Ω–Ω—ã–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.

**–ü—É—Ç—å:**
```
~/Library/Application Support/Slack/
~/Library/Containers/com.tinyspeck.slackmacgap/Data/
```

**–ü–∞—Ä—Å–∏–Ω–≥:**
```bash
# –°–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ Slack
ls ~/Library/Application\ Support/Slack/

# Aftermath –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–±–∏—Ä–∞–µ—Ç
sudo aftermath -o /output   # –≤–∫–ª—é—á–∞–µ—Ç Slack-–º–æ–¥—É–ª—å
```

---

## –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### Appendix A: –ü–æ—Ä—è–¥–æ–∫ —Å–±–æ—Ä–∞ (Order of Volatility)

–°–æ–±–∏—Ä–∞–π –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –≤ —Å–ª–µ–¥—É—é—â–µ–º –ø–æ—Ä—è–¥–∫–µ ‚Äî –æ—Ç –Ω–∞–∏–±–æ–ª–µ–µ –≤–æ–ª–∞—Ç–∏–ª—å–Ω—ã—Ö –∫ –Ω–∞–∏–º–µ–Ω–µ–µ:

| –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –ê—Ä—Ç–µ—Ñ–∞–∫—Ç | –ü—Ä–∏—á–∏–Ω–∞ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ |
|-----------|----------|-----------------------|
| 1 | –ñ–∏–≤—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã, —Å–µ—Ç–µ–≤—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è | –ò—Å—á–µ–∑–∞—é—Ç –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ |
| 2 | DNS-–∫—ç—à, ARP-—Ç–∞–±–ª–∏—Ü–∞ | –°–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ |
| 3 | RAM –¥–∞–º–ø | –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ç–µ—Ä—è–µ—Ç—Å—è –ø—Ä–∏ –≤—ã–∫–ª—é—á–µ–Ω–∏–∏ |
| 4 | Endpoint Security live events (eslogger) | –¢–æ–ª—å–∫–æ live, –Ω–µ–ª—å–∑—è –ø–æ–ª—É—á–∏—Ç—å —Ä–µ—Ç—Ä–æ—Å–ø–µ–∫—Ç–∏–≤–Ω–æ |
| 5 | Unified Logs | TTL –æ–≥—Ä–∞–Ω–∏—á–µ–Ω (1‚Äì4 –Ω–µ–¥–µ–ª–∏), —Å—Ç–∞—Ä—ã–µ –∑–∞–ø–∏—Å–∏ –≤—ã—Ç–µ—Å–Ω—è—é—Ç—Å—è |
| 6 | FSEvents | –†–æ—Ç–∏—Ä—É—é—Ç—Å—è –ø—Ä–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–∏ –¥–∏—Å–∫–∞ |
| 7 | KnowledgeC / Biome | –•—Ä–∞–Ω—è—Ç ~30 –¥–Ω–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ |
| 8 | Shell history | –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –∏–∑ shell |
| 9 | –ë—Ä–∞—É–∑–µ—Ä–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è | –ú–æ–∂–µ—Ç –±—ã—Ç—å –æ—á–∏—â–µ–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º |
| 10 | LaunchDaemons/Agents | –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã, –Ω–æ –º–µ–Ω—è—é—Ç—Å—è |
| 11 | Bodyfile / MACB Timestamps | –ò–∑–º–µ–Ω—è—é—Ç—Å—è –ø—Ä–∏ –¥–æ—Å—Ç—É–ø–µ –∫ —Ñ–∞–π–ª–∞–º |
| 12 | Quarantine DB | –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–∞, –Ω–µ –æ—á–∏—â–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ |
| 13 | TCC DB | –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–∞ |
| 14 | Crash reports | –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã –¥–æ —Ä–æ—Ç–∞—Ü–∏–∏ |
| 15 | Install history, Keychain metadata | –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ –º–µ–Ω—è—é—Ç—Å—è |

---

### Appendix B: –ë—ã—Å—Ç—Ä—ã–π IR-—Å–∫—Ä–∏–ø—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ —Å–±–æ—Ä–∞

```bash
#!/bin/bash
# –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π IR-—Å–∫—Ä–∏–ø—Ç –¥–ª—è macOS
# –ó–∞–ø—É—Å–∫–∞—Ç—å —Å –ø—Ä–∞–≤–∞–º–∏ root —Å USB-–Ω–∞–∫–æ–ø–∏—Ç–µ–ª—è

OUTPUT="/Volumes/IR_USB/$(hostname)_$(date +%Y%m%d_%H%M%S)"
mkdir -p "$OUTPUT"

echo "[*] 1. Volatile data - processes..."
ps aux > "$OUTPUT/processes.txt"
sudo lsof -i -n -P > "$OUTPUT/network_connections.txt"
netstat -an > "$OUTPUT/netstat.txt"
arp -a -n > "$OUTPUT/arp.txt"
sudo lsof -n > "$OUTPUT/lsof_full.txt"

echo "[*] 2. Security state..."
csrutil status > "$OUTPUT/sip_status.txt"
spctl --status > "$OUTPUT/gatekeeper_status.txt"
fdesetup status > "$OUTPUT/filevault_status.txt"
systemextensionsctl list > "$OUTPUT/system_extensions.txt"
kextstat | grep -v com.apple > "$OUTPUT/third_party_kexts.txt"

echo "[*] 3. Persistence..."
sudo launchctl list > "$OUTPUT/launchctl_list.txt"
ls -la /Library/LaunchDaemons/ > "$OUTPUT/LaunchDaemons_list.txt"
ls -la /Library/LaunchAgents/ > "$OUTPUT/LaunchAgents_system.txt"
ls -la ~/Library/LaunchAgents/ > "$OUTPUT/LaunchAgents_user.txt"
sudo cp -r /Library/LaunchDaemons/ "$OUTPUT/LaunchDaemons_files/"
sudo cp -r ~/Library/LaunchAgents/ "$OUTPUT/LaunchAgents_user_files/"
crontab -l > "$OUTPUT/crontab.txt" 2>/dev/null
sfltool dumpbtm > "$OUTPUT/loginitems_btm.txt" 2>/dev/null

echo "[*] 4. User activity..."
cp ~/.zsh_history "$OUTPUT/zsh_history.txt" 2>/dev/null
cp ~/.bash_history "$OUTPUT/bash_history.txt" 2>/dev/null
cp -r ~/.zsh_sessions/ "$OUTPUT/zsh_sessions/" 2>/dev/null

echo "[*] 5. Authentication..."
dscl . -list /Users UniqueID > "$OUTPUT/users.txt"
dscl . -read /Groups/admin GroupMembership >> "$OUTPUT/users.txt"
cat ~/.ssh/authorized_keys > "$OUTPUT/authorized_keys.txt" 2>/dev/null
cat ~/.ssh/known_hosts > "$OUTPUT/known_hosts.txt" 2>/dev/null
sudo systemsetup -getremotelogin >> "$OUTPUT/sip_status.txt"

echo "[*] 6. Network configuration..."
ifconfig -a > "$OUTPUT/ifconfig.txt"
cat /etc/hosts > "$OUTPUT/hosts.txt"
scutil --dns > "$OUTPUT/dns.txt"
networksetup -listallhardwareports > "$OUTPUT/network_ports.txt"

echo "[*] 7. System info..."
system_profiler SPSoftwareDataType SPHardwareDataType > "$OUTPUT/system_info.txt"
system_profiler SPUSBDataType > "$OUTPUT/usb_devices.txt"
diskutil list > "$OUTPUT/diskutil.txt"
tmutil listlocalsnapshots / > "$OUTPUT/apfs_snapshots.txt"

echo "[*] 8. Unified Logs (last 7 days)..."
sudo log collect --last 7d --output "$OUTPUT/system_logs.logarchive"

echo "[*] 9. TCC Database..."
sudo cp /Library/Application\ Support/com.apple.TCC/TCC.db \
  "$OUTPUT/TCC_system.db" 2>/dev/null
cp ~/Library/Application\ Support/com.apple.TCC/TCC.db \
  "$OUTPUT/TCC_user.db" 2>/dev/null

echo "[*] 10. Hashes of suspicious locations..."
find /tmp /var/tmp -type f -exec shasum -a 256 {} \; > "$OUTPUT/tmp_hashes.txt"
find ~/Library/LaunchAgents /Library/LaunchDaemons -name "*.plist" \
  -exec shasum -a 256 {} \; >> "$OUTPUT/tmp_hashes.txt"

echo "[+] Collection complete. Output: $OUTPUT"
echo "[+] Size: $(du -sh $OUTPUT | awk '{print $1}')"
```

---

### Appendix C: –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Å–±–æ—Ä–∞ –∏ –∞–Ω–∞–ª–∏–∑–∞

| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –¢–∏–ø | –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ | –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ |
|------------|-----|-----------|-------------|
| **UAC** | –°–±–æ—Ä—â–∏–∫ | –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Å–±–æ—Ä—â–∏–∫, –ª—é–±–æ–π Unix | –ë–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π, YAML-–ø—Ä–æ—Ñ–∏–ª–∏, S3/Azure upload |
| **Aftermath** | –°–±–æ—Ä—â–∏–∫ + –∞–Ω–∞–ª–∏–∑ | –¢–æ–ª—å–∫–æ macOS 12+ | ES Framework, storyline, MDM-–¥–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ Jamf |
| **mac_apt** | –ü–∞—Ä—Å–µ—Ä | –ê–Ω–∞–ª–∏–∑ UAC/–æ–±—Ä–∞–∑–æ–≤ | Safari, Chrome, KnowledgeC, TCC, Quarantine, iMessage |
| **APOLLO** | –ü–∞—Ä—Å–µ—Ä | KnowledgeC.db ‚Üí timeline | Pattern of life, —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω Sarah Edwards |
| **Plaso** | –°—É–ø–µ—Ätimeline | –°—É–ø–µ—Ätimeline –∏–∑ –≤—Å–µ—Ö –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ | –ü—Ä–µ—Å–µ—Ç `--parsers macosx`, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Timesketch |
| **FSEventsParser** | –ü–∞—Ä—Å–µ—Ä | `.fseventsd` ‚Üí CSV/JSON/SQLite | –ë—ã—Å—Ç—Ä—ã–π, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É–¥–∞–ª—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã |
| **Velociraptor** | –ê–≥–µ–Ω—Ç + —Å–±–æ—Ä—â–∏–∫ | –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—ã–π —Å–±–æ—Ä –Ω–∞ —Ñ–ª–æ—Ç–µ | VQL-–∑–∞–ø—Ä–æ—Å—ã, web UI, Aftermath –∫–∞–∫ –º–æ–¥—É–ª—å |
| **The Sleuth Kit** | –ê–Ω–∞–ª–∏–∑ –§–° | Bodyfile, file system timeline | `fls`, `mactime` ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç –æ—Ç—Ä–∞—Å–ª–∏ |
| **Volatility 3** | –ê–Ω–∞–ª–∏–∑ –ø–∞–º—è—Ç–∏ | RAM-–¥–∞–º–ø macOS | –ü–ª–∞–≥–∏–Ω—ã mac.pslist, mac.netstat, mac.malfind |
| **Timeline Explorer** | –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è | –ê–Ω–∞–ª–∏–∑ CSV –æ—Ç Plaso | –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π, Eric Zimmerman, —Ü–≤–µ—Ç–æ–≤–∞—è –∫–æ–¥–∏—Ä–æ–≤–∫–∞ |
| **Timesketch** | –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è | –ö–æ–º–∞–Ω–¥–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ç–∞–π–º–ª–∞–π–Ω–∞ | Web UI, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Plaso, Google/DFIR |

---

### Appendix D: –°—Å—ã–ª–∫–∏ –∏ –ø–µ—Ä–≤–æ–∏—Å—Ç–æ—á–Ω–∏–∫–∏

- [mac4n6.com ‚Äî Sarah Edwards (APOLLO, KnowledgeC, Unified Logs)](https://www.mac4n6.com)
- [SANS FOR518: Mac and iOS Forensic Analysis](https://www.sans.org/cyber-security-courses/mac-and-ios-forensic-analysis-and-incident-response/)
- [Jamf Aftermath GitHub](https://github.com/jamf/aftermath)
- [UAC GitHub ‚Äî tclahr](https://github.com/tclahr/uac)
- [mac_apt GitHub ‚Äî ydkhatri](https://github.com/ydkhatri/mac_apt)
- [Plaso (log2timeline) Documentation](https://plaso.readthedocs.io)
- [FSEventsParser GitHub ‚Äî dlcowen](https://github.com/dlcowen/FSEventsParser)
- [ArtifactCollectionMatrix ‚Äî Swisscom](https://github.com/swisscom/ArtifactCollectionMatrix)
- [ForensicArtifacts macOS definitions](https://github.com/ForensicArtifacts/artifacts)
- [mac4n6 Artifacts Spreadsheet ‚Äî Pasquale Stirparo / SANS](https://www.sans.org/tools/mac4n6-artifacts)
- [Howard Oakley ‚Äî Eclectic Light (APFS, Biome)](https://eclecticlight.co)

---

*–í–µ—Ä—Å–∏—è 2.0 | –û–±–Ω–æ–≤–ª–µ–Ω–æ: 2026-02 | –î–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–æ–º–∞–Ω–¥–æ–π IR*
